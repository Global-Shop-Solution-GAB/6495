Program.Sub.ScreenSU.Start
Gui.F_Recipe_Sel..Create(BaseForm)
Gui.F_Recipe_Sel..Caption("Recipe Selection")
Gui.F_Recipe_Sel..Size(8880,1710)
Gui.F_Recipe_Sel..MinX(0)
Gui.F_Recipe_Sel..MinY(0)
Gui.F_Recipe_Sel..Position(0,0)
Gui.F_Recipe_Sel..AlwaysOnTop(True)
Gui.F_Recipe_Sel..FontSize(16)
Gui.F_Recipe_Sel..BackColor(-2147483633)
Gui.F_Recipe_Sel..MaxButton(False)
Gui.F_Recipe_Sel..MousePointer(0)
Gui.F_Recipe_Sel..Sizeable(False)
Gui.F_Recipe_Sel..Event(UnLoad,F_Recipe_Sel_UnLoad)
Gui.F_Recipe_Sel..FontName("Tahoma")
Gui.F_Recipe_Sel..ControlBox(True)
Gui.F_Recipe_Sel..MinButton(True)
Gui.F_Recipe_Sel..Moveable(True)
Gui.F_Recipe_Sel..ShowInTaskBar(True)
Gui.F_Recipe_Sel..TitleBar(True)
Gui.F_Recipe_Sel.frameWorkCenters.Create(Frame)
Gui.F_Recipe_Sel.frameWorkCenters.Size(2130,870)
Gui.F_Recipe_Sel.frameWorkCenters.Position(120,45)
Gui.F_Recipe_Sel.frameWorkCenters.Enabled(True)
Gui.F_Recipe_Sel.frameWorkCenters.Visible(True)
Gui.F_Recipe_Sel.frameWorkCenters.Zorder(0)
Gui.F_Recipe_Sel.frameWorkCenters.Caption("")
Gui.F_Recipe_Sel.frameWorkCenters.FontName("Tahoma")
Gui.F_Recipe_Sel.frameWorkCenters.FontSize(8.25)
Gui.F_Recipe_Sel.optMPU9.Create(Option)
Gui.F_Recipe_Sel.optMPU9.Size(1575,510)
Gui.F_Recipe_Sel.optMPU9.Position(120,195)
Gui.F_Recipe_Sel.optMPU9.Parent("frameWorkCenters")
Gui.F_Recipe_Sel.optMPU9.Caption("MPU 9")
Gui.F_Recipe_Sel.optMPU9.FontSize(16)
Gui.F_Recipe_Sel.optMPU9.FontStyle(True,False,False,False,False)
Gui.F_Recipe_Sel.optMPU9.Event(Click,optWorkCenters_Click)
Gui.F_Recipe_Sel.optMPU9.Enabled(True)
Gui.F_Recipe_Sel.optMPU9.Visible(True)
Gui.F_Recipe_Sel.optMPU9.Zorder(0)
Gui.F_Recipe_Sel.optMPU9.FontName("Tahoma")
Gui.F_Recipe_Sel.txtKey.Create(TextBox,"",True,6165,480,0,2415,630,True,0,"Arial",16,-2147483643,1)
Gui.F_Recipe_Sel.txtKey.Event(Change,txtKey_Change)
Gui.F_Recipe_Sel.lblKey.Create(Label,"Scan Work Order Number or Part Number",True,6990,480,0,2355,165,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Recipe_Sel.lblKey.BorderStyle(0)
Gui.F_Recipe..Create(BaseForm)
Gui.F_Recipe..Caption("Recipe")
Gui.F_Recipe..Size(11580,3975)
Gui.F_Recipe..MinX(0)
Gui.F_Recipe..MinY(0)
Gui.F_Recipe..Position(0,0)
Gui.F_Recipe..BackColor(-2147483633)
Gui.F_Recipe..MousePointer(0)
Gui.F_Recipe..Event(UnLoad,F_Recipe_UnLoad)
Gui.F_Recipe..AlwaysOnTop(False)
Gui.F_Recipe..FontName("Tahoma")
Gui.F_Recipe..FontSize(8.25)
Gui.F_Recipe..ControlBox(True)
Gui.F_Recipe..MaxButton(True)
Gui.F_Recipe..MinButton(True)
Gui.F_Recipe..Moveable(True)
Gui.F_Recipe..Sizeable(True)
Gui.F_Recipe..ShowInTaskBar(True)
Gui.F_Recipe..TitleBar(True)
Gui.F_Recipe.gsgcRecipe.Create(GsGridControl)
Gui.F_Recipe.gsgcRecipe.Size(11445,2655)
Gui.F_Recipe.gsgcRecipe.Position(0,0)
Gui.F_Recipe.gsgcRecipe.Anchor(15)
Gui.F_Recipe.gsgcRecipe.Enabled(True)
Gui.F_Recipe.gsgcRecipe.Visible(True)
Gui.F_Recipe.gsgcRecipe.Zorder(0)
Gui.F_Recipe.cmdAdd.Create(Button)
Gui.F_Recipe.cmdAdd.Size(2700,570)
Gui.F_Recipe.cmdAdd.Position(135,2775)
Gui.F_Recipe.cmdAdd.Anchor(6)
Gui.F_Recipe.cmdAdd.Caption("Select Recipe")
Gui.F_Recipe.cmdAdd.FontSize(16)
Gui.F_Recipe.cmdAdd.Event(Click,cmdAdd_Click)
Gui.F_Recipe.cmdAdd.Enabled(True)
Gui.F_Recipe.cmdAdd.Visible(True)
Gui.F_Recipe.cmdAdd.Zorder(0)
Gui.F_Recipe.cmdAdd.FontName("Tahoma")
Gui.F_Recipe.cmdChg.Create(Button)
Gui.F_Recipe.cmdChg.Size(2700,570)
Gui.F_Recipe.cmdChg.Position(2970,2790)
Gui.F_Recipe.cmdChg.Anchor(6)
Gui.F_Recipe.cmdChg.Caption("Request Change")
Gui.F_Recipe.cmdChg.FontSize(16)
Gui.F_Recipe.cmdChg.Event(Click,cmdChg_Click)
Gui.F_Recipe.cmdChg.Enabled(True)
Gui.F_Recipe.cmdChg.Visible(True)
Gui.F_Recipe.cmdChg.Zorder(0)
Gui.F_Recipe.cmdChg.FontName("Tahoma")
Gui.F_Recipe_Maint..Create(BaseForm)
Gui.F_Recipe_Maint..Caption("Part Blanks Maintenance")
Gui.F_Recipe_Maint..Size(5625,7305)
Gui.F_Recipe_Maint..MinX(0)
Gui.F_Recipe_Maint..MinY(0)
Gui.F_Recipe_Maint..Position(0,0)
Gui.F_Recipe_Maint..BackColor(-2147483633)
Gui.F_Recipe_Maint..MousePointer(0)
Gui.F_Recipe_Maint..Event(UnLoad,F_Recipe_Maint_UnLoad)
Gui.F_Recipe_Maint..AlwaysOnTop(False)
Gui.F_Recipe_Maint..FontName("Tahoma")
Gui.F_Recipe_Maint..FontSize(8.25)
Gui.F_Recipe_Maint..ControlBox(True)
Gui.F_Recipe_Maint..MaxButton(True)
Gui.F_Recipe_Maint..MinButton(True)
Gui.F_Recipe_Maint..Moveable(True)
Gui.F_Recipe_Maint..Sizeable(True)
Gui.F_Recipe_Maint..ShowInTaskBar(True)
Gui.F_Recipe_Maint..TitleBar(True)
Gui.F_Recipe_Maint.ddlGrade.Create(DropDownList)
Gui.F_Recipe_Maint.ddlGrade.Size(1320,330)
Gui.F_Recipe_Maint.ddlGrade.Position(195,360)
Gui.F_Recipe_Maint.ddlGrade.Enabled(True)
Gui.F_Recipe_Maint.ddlGrade.Visible(True)
Gui.F_Recipe_Maint.ddlGrade.Zorder(0)
Gui.F_Recipe_Maint.ddlGrade.FontName("Tahoma")
Gui.F_Recipe_Maint.ddlGrade.FontSize(8.25)
Gui.F_Recipe_Maint.lblGrade.Create(Label,"Grade",True,870,255,0,225,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Recipe_Maint.lblGrade.BorderStyle(0)
Gui.F_Recipe_Maint.ddlSize.Create(DropDownList)
Gui.F_Recipe_Maint.ddlSize.Size(1455,330)
Gui.F_Recipe_Maint.ddlSize.Position(1650,360)
Gui.F_Recipe_Maint.ddlSize.Enabled(True)
Gui.F_Recipe_Maint.ddlSize.Visible(True)
Gui.F_Recipe_Maint.ddlSize.Zorder(0)
Gui.F_Recipe_Maint.ddlSize.FontName("Tahoma")
Gui.F_Recipe_Maint.ddlSize.FontSize(8.25)
Gui.F_Recipe_Maint.lblSize.Create(Label,"Size",True,555,255,0,1680,150,True,0,"Arial",8,-2147483633,0,0)
Gui.F_Recipe_Maint.lblSize.BorderStyle(0)
Gui.F_Recipe_Maint.gsgcBlanks.Create(GsGridControl)
Gui.F_Recipe_Maint.gsgcBlanks.Size(5625,4605)
Gui.F_Recipe_Maint.gsgcBlanks.Position(0,1545)
Gui.F_Recipe_Maint.gsgcBlanks.Anchor(15)
Gui.F_Recipe_Maint.gsgcBlanks.Enabled(True)
Gui.F_Recipe_Maint.gsgcBlanks.Visible(True)
Gui.F_Recipe_Maint.gsgcBlanks.Zorder(0)
Gui.F_Recipe_Maint.cmdSave.Create(Button)
Gui.F_Recipe_Maint.cmdSave.Size(1050,405)
Gui.F_Recipe_Maint.cmdSave.Position(105,6300)
Gui.F_Recipe_Maint.cmdSave.Caption("Save")
Gui.F_Recipe_Maint.cmdSave.Event(Click,cmdSave_Click)
Gui.F_Recipe_Maint.cmdSave.Anchor(6)
Gui.F_Recipe_Maint.cmdSave.Enabled(True)
Gui.F_Recipe_Maint.cmdSave.Visible(True)
Gui.F_Recipe_Maint.cmdSave.Zorder(0)
Gui.F_Recipe_Maint.cmdSave.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdSave.FontSize(8.25)
Gui.F_Recipe_Maint.cmdUpdate.Create(Button)
Gui.F_Recipe_Maint.cmdUpdate.Size(1050,570)
Gui.F_Recipe_Maint.cmdUpdate.Position(180,840)
Gui.F_Recipe_Maint.cmdUpdate.Caption("Update Selected")
Gui.F_Recipe_Maint.cmdUpdate.Event(Click,cmdUpdate_Click)
Gui.F_Recipe_Maint.cmdUpdate.Enabled(True)
Gui.F_Recipe_Maint.cmdUpdate.Visible(True)
Gui.F_Recipe_Maint.cmdUpdate.Zorder(0)
Gui.F_Recipe_Maint.cmdUpdate.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdUpdate.FontSize(8.25)
Gui.F_Recipe_Maint.cmdExport.Create(Button)
Gui.F_Recipe_Maint.cmdExport.Size(1050,405)
Gui.F_Recipe_Maint.cmdExport.Position(1365,6300)
Gui.F_Recipe_Maint.cmdExport.Anchor(6)
Gui.F_Recipe_Maint.cmdExport.Caption("Export")
Gui.F_Recipe_Maint.cmdExport.Event(Click,cmdExport_Click)
Gui.F_Recipe_Maint.cmdExport.Enabled(True)
Gui.F_Recipe_Maint.cmdExport.Visible(True)
Gui.F_Recipe_Maint.cmdExport.Zorder(0)
Gui.F_Recipe_Maint.cmdExport.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdExport.FontSize(8.25)
Gui.F_Recipe_Maint.cmdImport.Create(Button)
Gui.F_Recipe_Maint.cmdImport.Size(1050,405)
Gui.F_Recipe_Maint.cmdImport.Position(2640,6300)
Gui.F_Recipe_Maint.cmdImport.Anchor(6)
Gui.F_Recipe_Maint.cmdImport.Caption("Import")
Gui.F_Recipe_Maint.cmdImport.Event(Click,cmdImport_Click)
Gui.F_Recipe_Maint.cmdImport.Enabled(True)
Gui.F_Recipe_Maint.cmdImport.Visible(True)
Gui.F_Recipe_Maint.cmdImport.Zorder(0)
Gui.F_Recipe_Maint.cmdImport.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdImport.FontSize(8.25)
Gui.F_Recipe_Maint.optSummer.Create(Option)
Gui.F_Recipe_Maint.optSummer.Size(1110,255)
Gui.F_Recipe_Maint.optSummer.Position(3495,240)
Gui.F_Recipe_Maint.optSummer.Caption("Summer")
Gui.F_Recipe_Maint.optSummer.Event(Click,optSeason_Click)
Gui.F_Recipe_Maint.optSummer.Visible(False)
Gui.F_Recipe_Maint.optSummer.Enabled(True)
Gui.F_Recipe_Maint.optSummer.Zorder(0)
Gui.F_Recipe_Maint.optSummer.FontName("Tahoma")
Gui.F_Recipe_Maint.optSummer.FontSize(8.25)
Gui.F_Recipe_Maint.optWinter.Create(Option)
Gui.F_Recipe_Maint.optWinter.Size(900,255)
Gui.F_Recipe_Maint.optWinter.Position(3495,615)
Gui.F_Recipe_Maint.optWinter.Caption("Winter")
Gui.F_Recipe_Maint.optWinter.Event(Click,optSeason_Click)
Gui.F_Recipe_Maint.optWinter.Visible(False)
Gui.F_Recipe_Maint.optWinter.Enabled(True)
Gui.F_Recipe_Maint.optWinter.Zorder(0)
Gui.F_Recipe_Maint.optWinter.FontName("Tahoma")
Gui.F_Recipe_Maint.optWinter.FontSize(8.25)
Gui.F_Recipe_Maint.cmdClear.Create(Button)
Gui.F_Recipe_Maint.cmdClear.Size(1050,570)
Gui.F_Recipe_Maint.cmdClear.Position(1425,840)
Gui.F_Recipe_Maint.cmdClear.Caption("Clear Selected")
Gui.F_Recipe_Maint.cmdClear.Event(Click,cmdClear_Click)
Gui.F_Recipe_Maint.cmdClear.Enabled(True)
Gui.F_Recipe_Maint.cmdClear.Visible(True)
Gui.F_Recipe_Maint.cmdClear.Zorder(0)
Gui.F_Recipe_Maint.cmdClear.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdClear.FontSize(8.25)
Gui.F_Recipe_Maint.cmdEditEmail.Create(Button)
Gui.F_Recipe_Maint.cmdEditEmail.Size(1050,570)
Gui.F_Recipe_Maint.cmdEditEmail.Position(4260,840)
Gui.F_Recipe_Maint.cmdEditEmail.Anchor(9)
Gui.F_Recipe_Maint.cmdEditEmail.Caption("Edit Notif. Email")
Gui.F_Recipe_Maint.cmdEditEmail.Event(Click,cmdEditEmail_Click)
Gui.F_Recipe_Maint.cmdEditEmail.Enabled(True)
Gui.F_Recipe_Maint.cmdEditEmail.Visible(True)
Gui.F_Recipe_Maint.cmdEditEmail.Zorder(0)
Gui.F_Recipe_Maint.cmdEditEmail.FontName("Tahoma")
Gui.F_Recipe_Maint.cmdEditEmail.FontSize(8.25)
Gui.F_AddRecipe..Create(BaseForm)
Gui.F_AddRecipe..Caption("Select Recipe")
Gui.F_AddRecipe..Size(11580,8430)
Gui.F_AddRecipe..MinX(0)
Gui.F_AddRecipe..MinY(0)
Gui.F_AddRecipe..Position(0,0)
Gui.F_AddRecipe..BackColor(-2147483633)
Gui.F_AddRecipe..ControlBox(False)
Gui.F_AddRecipe..MousePointer(0)
Gui.F_AddRecipe..AlwaysOnTop(False)
Gui.F_AddRecipe..FontName("Tahoma")
Gui.F_AddRecipe..FontSize(8.25)
Gui.F_AddRecipe..MaxButton(True)
Gui.F_AddRecipe..MinButton(True)
Gui.F_AddRecipe..Moveable(True)
Gui.F_AddRecipe..Sizeable(True)
Gui.F_AddRecipe..ShowInTaskBar(True)
Gui.F_AddRecipe..TitleBar(True)
Gui.F_AddRecipe.gsgcAddRecipe.Create(GsGridControl)
Gui.F_AddRecipe.gsgcAddRecipe.Size(11445,7110)
Gui.F_AddRecipe.gsgcAddRecipe.Position(0,0)
Gui.F_AddRecipe.gsgcAddRecipe.Anchor(15)
Gui.F_AddRecipe.gsgcAddRecipe.Enabled(True)
Gui.F_AddRecipe.gsgcAddRecipe.Visible(True)
Gui.F_AddRecipe.gsgcAddRecipe.Zorder(0)
Gui.F_AddRecipe.cmdSelect.Create(Button)
Gui.F_AddRecipe.cmdSelect.Size(2700,570)
Gui.F_AddRecipe.cmdSelect.Position(135,7260)
Gui.F_AddRecipe.cmdSelect.Anchor(6)
Gui.F_AddRecipe.cmdSelect.Caption("Select")
Gui.F_AddRecipe.cmdSelect.FontSize(16)
Gui.F_AddRecipe.cmdSelect.Event(Click,cmdSelect_Click)
Gui.F_AddRecipe.cmdSelect.Enabled(True)
Gui.F_AddRecipe.cmdSelect.Visible(True)
Gui.F_AddRecipe.cmdSelect.Zorder(0)
Gui.F_AddRecipe.cmdSelect.FontName("Tahoma")
Gui.F_AddRecipe.cmdCancel.Create(Button)
Gui.F_AddRecipe.cmdCancel.Size(2700,570)
Gui.F_AddRecipe.cmdCancel.Position(2970,7260)
Gui.F_AddRecipe.cmdCancel.Anchor(6)
Gui.F_AddRecipe.cmdCancel.Caption("Cancel")
Gui.F_AddRecipe.cmdCancel.FontSize(16)
Gui.F_AddRecipe.cmdCancel.Event(Click,cmdCancel_Click)
Gui.F_AddRecipe.cmdCancel.Enabled(True)
Gui.F_AddRecipe.cmdCancel.Visible(True)
Gui.F_AddRecipe.cmdCancel.Zorder(0)
Gui.F_AddRecipe.cmdCancel.FontName("Tahoma")
Gui.F_Season..Create(BaseForm)
Gui.F_Season..Caption("Change Season")
Gui.F_Season..Size(3240,2070)
Gui.F_Season..MinX(0)
Gui.F_Season..MinY(0)
Gui.F_Season..Position(0,0)
Gui.F_Season..BackColor(-2147483633)
Gui.F_Season..MaxButton(False)
Gui.F_Season..MousePointer(0)
Gui.F_Season..Sizeable(False)
Gui.F_Season..Event(UnLoad,F_Season_UnLoad)
Gui.F_Season..MinButton(False)
Gui.F_Season..AlwaysOnTop(False)
Gui.F_Season..FontName("Tahoma")
Gui.F_Season..FontSize(8.25)
Gui.F_Season..ControlBox(True)
Gui.F_Season..Moveable(True)
Gui.F_Season..ShowInTaskBar(True)
Gui.F_Season..TitleBar(True)
Gui.F_Season.optSummer.Create(Option)
Gui.F_Season.optSummer.Size(1575,255)
Gui.F_Season.optSummer.Position(525,210)
Gui.F_Season.optSummer.Caption("Summer")
Gui.F_Season.optSummer.Event(Click,optSeason_Click)
Gui.F_Season.optSummer.Enabled(True)
Gui.F_Season.optSummer.Visible(True)
Gui.F_Season.optSummer.Zorder(0)
Gui.F_Season.optSummer.FontName("Tahoma")
Gui.F_Season.optSummer.FontSize(8.25)
Gui.F_Season.optWinter.Create(Option)
Gui.F_Season.optWinter.Size(1575,255)
Gui.F_Season.optWinter.Position(525,600)
Gui.F_Season.optWinter.Caption("Winter")
Gui.F_Season.optWinter.Event(Click,optSeason_Click)
Gui.F_Season.optWinter.Enabled(True)
Gui.F_Season.optWinter.Visible(True)
Gui.F_Season.optWinter.Zorder(0)
Gui.F_Season.optWinter.FontName("Tahoma")
Gui.F_Season.optWinter.FontSize(8.25)
Gui.F_Season.cmdSeasonSave.Create(Button)
Gui.F_Season.cmdSeasonSave.Size(1050,405)
Gui.F_Season.cmdSeasonSave.Position(120,1125)
Gui.F_Season.cmdSeasonSave.Caption("Save")
Gui.F_Season.cmdSeasonSave.Event(Click,cmdSeasonSave_Click)
Gui.F_Season.cmdSeasonSave.Enabled(True)
Gui.F_Season.cmdSeasonSave.Visible(True)
Gui.F_Season.cmdSeasonSave.Zorder(0)
Gui.F_Season.cmdSeasonSave.FontName("Tahoma")
Gui.F_Season.cmdSeasonSave.FontSize(8.25)
Gui.F_Season.cmdSeasonCancel.Create(Button)
Gui.F_Season.cmdSeasonCancel.Size(1050,405)
Gui.F_Season.cmdSeasonCancel.Position(1305,1125)
Gui.F_Season.cmdSeasonCancel.Caption("Cancel")
Gui.F_Season.cmdSeasonCancel.Event(Click,F_Season_UnLoad)
Gui.F_Season.cmdSeasonCancel.Enabled(True)
Gui.F_Season.cmdSeasonCancel.Visible(True)
Gui.F_Season.cmdSeasonCancel.Zorder(0)
Gui.F_Season.cmdSeasonCancel.FontName("Tahoma")
Gui.F_Season.cmdSeasonCancel.FontSize(8.25)
Gui.F_Recipe_Chg..Create(BaseForm)
Gui.F_Recipe_Chg..Caption("Recipe Change Request")
Gui.F_Recipe_Chg..Size(12480,13275)
Gui.F_Recipe_Chg..MinX(12480)
Gui.F_Recipe_Chg..MinY(10000)
Gui.F_Recipe_Chg..Position(0,0)
Gui.F_Recipe_Chg..BackColor(-2147483633)
Gui.F_Recipe_Chg..MousePointer(0)
Gui.F_Recipe_Chg..Event(UnLoad,F_Recipe_Chg_UnLoad)
Gui.F_Recipe_Chg..AlwaysOnTop(False)
Gui.F_Recipe_Chg..FontName("Tahoma")
Gui.F_Recipe_Chg..FontSize(8.25)
Gui.F_Recipe_Chg..ControlBox(True)
Gui.F_Recipe_Chg..MaxButton(True)
Gui.F_Recipe_Chg..MinButton(True)
Gui.F_Recipe_Chg..Moveable(True)
Gui.F_Recipe_Chg..Sizeable(True)
Gui.F_Recipe_Chg..ShowInTaskBar(True)
Gui.F_Recipe_Chg..TitleBar(True)
Gui.F_Recipe_Chg.gsgcCurr.Create(GsGridControl)
Gui.F_Recipe_Chg.gsgcCurr.Size(12345,2175)
Gui.F_Recipe_Chg.gsgcCurr.Position(0,465)
Gui.F_Recipe_Chg.gsgcCurr.Anchor(13)
Gui.F_Recipe_Chg.gsgcCurr.Enabled(True)
Gui.F_Recipe_Chg.gsgcCurr.Visible(True)
Gui.F_Recipe_Chg.gsgcCurr.Zorder(0)
Gui.F_Recipe_Chg.lblCurr.Create(Label,"Current Recipe",True,4410,435,0,120,75,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Recipe_Chg.lblCurr.BorderStyle(0)
Gui.F_Recipe_Chg.lblNew.Create(Label,"Proposed Recipe",True,3045,435,0,120,2715,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Recipe_Chg.lblNew.BorderStyle(0)
Gui.F_Recipe_Chg.gsgcNew.Create(GsGridControl)
Gui.F_Recipe_Chg.gsgcNew.Size(12345,2175)
Gui.F_Recipe_Chg.gsgcNew.Position(0,3105)
Gui.F_Recipe_Chg.gsgcNew.Anchor(13)
Gui.F_Recipe_Chg.gsgcNew.Event(CellValueChanged,gsgcNew_CellValueChanged)
Gui.F_Recipe_Chg.gsgcNew.Enabled(True)
Gui.F_Recipe_Chg.gsgcNew.Visible(True)
Gui.F_Recipe_Chg.gsgcNew.Zorder(0)
Gui.F_Recipe_Chg.lblReasons.Create(Label,"Reasons for Requested Change",True,4500,360,0,120,5355,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Recipe_Chg.lblReasons.BorderStyle(0)
Gui.F_Recipe_Chg.chkReason1.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason1.Size(4020,300)
Gui.F_Recipe_Chg.chkReason1.Position(165,5745)
Gui.F_Recipe_Chg.chkReason1.Caption("Reason 1")
Gui.F_Recipe_Chg.chkReason1.FontSize(12)
Gui.F_Recipe_Chg.chkReason1.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason1.Enabled(True)
Gui.F_Recipe_Chg.chkReason1.Visible(True)
Gui.F_Recipe_Chg.chkReason1.Zorder(0)
Gui.F_Recipe_Chg.chkReason1.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason2.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason2.Size(4020,300)
Gui.F_Recipe_Chg.chkReason2.Position(165,6120)
Gui.F_Recipe_Chg.chkReason2.Caption("Reason 2")
Gui.F_Recipe_Chg.chkReason2.FontSize(12)
Gui.F_Recipe_Chg.chkReason2.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason2.Enabled(True)
Gui.F_Recipe_Chg.chkReason2.Visible(True)
Gui.F_Recipe_Chg.chkReason2.Zorder(0)
Gui.F_Recipe_Chg.chkReason2.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason3.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason3.Size(4020,300)
Gui.F_Recipe_Chg.chkReason3.Position(165,6495)
Gui.F_Recipe_Chg.chkReason3.Caption("Reason 3")
Gui.F_Recipe_Chg.chkReason3.FontSize(12)
Gui.F_Recipe_Chg.chkReason3.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason3.Enabled(True)
Gui.F_Recipe_Chg.chkReason3.Visible(True)
Gui.F_Recipe_Chg.chkReason3.Zorder(0)
Gui.F_Recipe_Chg.chkReason3.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason4.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason4.Size(4020,300)
Gui.F_Recipe_Chg.chkReason4.Position(165,6870)
Gui.F_Recipe_Chg.chkReason4.Caption("Reason 4")
Gui.F_Recipe_Chg.chkReason4.FontSize(12)
Gui.F_Recipe_Chg.chkReason4.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason4.Enabled(True)
Gui.F_Recipe_Chg.chkReason4.Visible(True)
Gui.F_Recipe_Chg.chkReason4.Zorder(0)
Gui.F_Recipe_Chg.chkReason4.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason5.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason5.Size(4020,300)
Gui.F_Recipe_Chg.chkReason5.Position(165,7245)
Gui.F_Recipe_Chg.chkReason5.Caption("Reason 5")
Gui.F_Recipe_Chg.chkReason5.FontSize(12)
Gui.F_Recipe_Chg.chkReason5.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason5.Enabled(True)
Gui.F_Recipe_Chg.chkReason5.Visible(True)
Gui.F_Recipe_Chg.chkReason5.Zorder(0)
Gui.F_Recipe_Chg.chkReason5.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason6.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason6.Size(4020,300)
Gui.F_Recipe_Chg.chkReason6.Position(165,7620)
Gui.F_Recipe_Chg.chkReason6.Caption("Reason 6")
Gui.F_Recipe_Chg.chkReason6.FontSize(12)
Gui.F_Recipe_Chg.chkReason6.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason6.Enabled(True)
Gui.F_Recipe_Chg.chkReason6.Visible(True)
Gui.F_Recipe_Chg.chkReason6.Zorder(0)
Gui.F_Recipe_Chg.chkReason6.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason7.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason7.Size(4020,300)
Gui.F_Recipe_Chg.chkReason7.Position(165,7995)
Gui.F_Recipe_Chg.chkReason7.Caption("Reason 7")
Gui.F_Recipe_Chg.chkReason7.FontSize(12)
Gui.F_Recipe_Chg.chkReason7.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason7.Enabled(True)
Gui.F_Recipe_Chg.chkReason7.Visible(True)
Gui.F_Recipe_Chg.chkReason7.Zorder(0)
Gui.F_Recipe_Chg.chkReason7.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason8.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason8.Size(4020,300)
Gui.F_Recipe_Chg.chkReason8.Position(165,8370)
Gui.F_Recipe_Chg.chkReason8.Caption("Reason 8")
Gui.F_Recipe_Chg.chkReason8.FontSize(12)
Gui.F_Recipe_Chg.chkReason8.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason8.Enabled(True)
Gui.F_Recipe_Chg.chkReason8.Visible(True)
Gui.F_Recipe_Chg.chkReason8.Zorder(0)
Gui.F_Recipe_Chg.chkReason8.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason9.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason9.Size(4020,300)
Gui.F_Recipe_Chg.chkReason9.Position(165,8745)
Gui.F_Recipe_Chg.chkReason9.Caption("Reason 9")
Gui.F_Recipe_Chg.chkReason9.FontSize(12)
Gui.F_Recipe_Chg.chkReason9.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason9.Enabled(True)
Gui.F_Recipe_Chg.chkReason9.Visible(True)
Gui.F_Recipe_Chg.chkReason9.Zorder(0)
Gui.F_Recipe_Chg.chkReason9.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason10.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason10.Size(4020,300)
Gui.F_Recipe_Chg.chkReason10.Position(165,9120)
Gui.F_Recipe_Chg.chkReason10.Caption("Reason 10")
Gui.F_Recipe_Chg.chkReason10.FontSize(12)
Gui.F_Recipe_Chg.chkReason10.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason10.Enabled(True)
Gui.F_Recipe_Chg.chkReason10.Visible(True)
Gui.F_Recipe_Chg.chkReason10.Zorder(0)
Gui.F_Recipe_Chg.chkReason10.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason11.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason11.Size(4020,345)
Gui.F_Recipe_Chg.chkReason11.Position(4200,5745)
Gui.F_Recipe_Chg.chkReason11.Caption("Reason 11")
Gui.F_Recipe_Chg.chkReason11.FontSize(12)
Gui.F_Recipe_Chg.chkReason11.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason11.Enabled(True)
Gui.F_Recipe_Chg.chkReason11.Visible(True)
Gui.F_Recipe_Chg.chkReason11.Zorder(0)
Gui.F_Recipe_Chg.chkReason11.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason12.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason12.Size(4020,300)
Gui.F_Recipe_Chg.chkReason12.Position(4200,6120)
Gui.F_Recipe_Chg.chkReason12.Caption("Reason 12")
Gui.F_Recipe_Chg.chkReason12.FontSize(12)
Gui.F_Recipe_Chg.chkReason12.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason12.Enabled(True)
Gui.F_Recipe_Chg.chkReason12.Visible(True)
Gui.F_Recipe_Chg.chkReason12.Zorder(0)
Gui.F_Recipe_Chg.chkReason12.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason13.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason13.Size(4020,300)
Gui.F_Recipe_Chg.chkReason13.Position(4200,6495)
Gui.F_Recipe_Chg.chkReason13.Caption("Reason 13")
Gui.F_Recipe_Chg.chkReason13.FontSize(12)
Gui.F_Recipe_Chg.chkReason13.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason13.Enabled(True)
Gui.F_Recipe_Chg.chkReason13.Visible(True)
Gui.F_Recipe_Chg.chkReason13.Zorder(0)
Gui.F_Recipe_Chg.chkReason13.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason14.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason14.Size(4020,300)
Gui.F_Recipe_Chg.chkReason14.Position(4200,6870)
Gui.F_Recipe_Chg.chkReason14.Caption("Reason 14")
Gui.F_Recipe_Chg.chkReason14.FontSize(12)
Gui.F_Recipe_Chg.chkReason14.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason14.Enabled(True)
Gui.F_Recipe_Chg.chkReason14.Visible(True)
Gui.F_Recipe_Chg.chkReason14.Zorder(0)
Gui.F_Recipe_Chg.chkReason14.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason15.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason15.Size(4020,300)
Gui.F_Recipe_Chg.chkReason15.Position(4200,7245)
Gui.F_Recipe_Chg.chkReason15.Caption("Reason 15")
Gui.F_Recipe_Chg.chkReason15.FontSize(12)
Gui.F_Recipe_Chg.chkReason15.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason15.Enabled(True)
Gui.F_Recipe_Chg.chkReason15.Visible(True)
Gui.F_Recipe_Chg.chkReason15.Zorder(0)
Gui.F_Recipe_Chg.chkReason15.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason16.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason16.Size(4020,300)
Gui.F_Recipe_Chg.chkReason16.Position(4200,7620)
Gui.F_Recipe_Chg.chkReason16.Caption("Reason 16")
Gui.F_Recipe_Chg.chkReason16.FontSize(12)
Gui.F_Recipe_Chg.chkReason16.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason16.Enabled(True)
Gui.F_Recipe_Chg.chkReason16.Visible(True)
Gui.F_Recipe_Chg.chkReason16.Zorder(0)
Gui.F_Recipe_Chg.chkReason16.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason17.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason17.Size(4020,300)
Gui.F_Recipe_Chg.chkReason17.Position(4200,7995)
Gui.F_Recipe_Chg.chkReason17.Caption("Reason 17")
Gui.F_Recipe_Chg.chkReason17.FontSize(12)
Gui.F_Recipe_Chg.chkReason17.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason17.Enabled(True)
Gui.F_Recipe_Chg.chkReason17.Visible(True)
Gui.F_Recipe_Chg.chkReason17.Zorder(0)
Gui.F_Recipe_Chg.chkReason17.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason18.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason18.Size(4020,300)
Gui.F_Recipe_Chg.chkReason18.Position(4200,8370)
Gui.F_Recipe_Chg.chkReason18.Caption("Reason 18")
Gui.F_Recipe_Chg.chkReason18.FontSize(12)
Gui.F_Recipe_Chg.chkReason18.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason18.Enabled(True)
Gui.F_Recipe_Chg.chkReason18.Visible(True)
Gui.F_Recipe_Chg.chkReason18.Zorder(0)
Gui.F_Recipe_Chg.chkReason18.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason19.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason19.Size(4020,300)
Gui.F_Recipe_Chg.chkReason19.Position(4200,8760)
Gui.F_Recipe_Chg.chkReason19.Caption("Reason 19")
Gui.F_Recipe_Chg.chkReason19.FontSize(12)
Gui.F_Recipe_Chg.chkReason19.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason19.Enabled(True)
Gui.F_Recipe_Chg.chkReason19.Visible(True)
Gui.F_Recipe_Chg.chkReason19.Zorder(0)
Gui.F_Recipe_Chg.chkReason19.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason20.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason20.Size(4020,300)
Gui.F_Recipe_Chg.chkReason20.Position(4200,9120)
Gui.F_Recipe_Chg.chkReason20.Caption("Reason 20")
Gui.F_Recipe_Chg.chkReason20.FontSize(12)
Gui.F_Recipe_Chg.chkReason20.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason20.Enabled(True)
Gui.F_Recipe_Chg.chkReason20.Visible(True)
Gui.F_Recipe_Chg.chkReason20.Zorder(0)
Gui.F_Recipe_Chg.chkReason20.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason21.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason21.Size(4020,345)
Gui.F_Recipe_Chg.chkReason21.Position(8235,5745)
Gui.F_Recipe_Chg.chkReason21.Caption("Reason 21")
Gui.F_Recipe_Chg.chkReason21.FontSize(12)
Gui.F_Recipe_Chg.chkReason21.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason21.Enabled(True)
Gui.F_Recipe_Chg.chkReason21.Visible(True)
Gui.F_Recipe_Chg.chkReason21.Zorder(0)
Gui.F_Recipe_Chg.chkReason21.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason22.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason22.Size(4020,300)
Gui.F_Recipe_Chg.chkReason22.Position(8235,6120)
Gui.F_Recipe_Chg.chkReason22.Caption("Reason 22")
Gui.F_Recipe_Chg.chkReason22.FontSize(12)
Gui.F_Recipe_Chg.chkReason22.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason22.Enabled(True)
Gui.F_Recipe_Chg.chkReason22.Visible(True)
Gui.F_Recipe_Chg.chkReason22.Zorder(0)
Gui.F_Recipe_Chg.chkReason22.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason23.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason23.Size(4020,300)
Gui.F_Recipe_Chg.chkReason23.Position(8235,6495)
Gui.F_Recipe_Chg.chkReason23.Caption("Reason 23")
Gui.F_Recipe_Chg.chkReason23.FontSize(12)
Gui.F_Recipe_Chg.chkReason23.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason23.Enabled(True)
Gui.F_Recipe_Chg.chkReason23.Visible(True)
Gui.F_Recipe_Chg.chkReason23.Zorder(0)
Gui.F_Recipe_Chg.chkReason23.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason24.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason24.Size(4020,300)
Gui.F_Recipe_Chg.chkReason24.Position(8235,6870)
Gui.F_Recipe_Chg.chkReason24.Caption("Reason 24")
Gui.F_Recipe_Chg.chkReason24.FontSize(12)
Gui.F_Recipe_Chg.chkReason24.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason24.Enabled(True)
Gui.F_Recipe_Chg.chkReason24.Visible(True)
Gui.F_Recipe_Chg.chkReason24.Zorder(0)
Gui.F_Recipe_Chg.chkReason24.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason25.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason25.Size(4020,300)
Gui.F_Recipe_Chg.chkReason25.Position(8235,7245)
Gui.F_Recipe_Chg.chkReason25.Caption("Reason 25")
Gui.F_Recipe_Chg.chkReason25.FontSize(12)
Gui.F_Recipe_Chg.chkReason25.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason25.Enabled(True)
Gui.F_Recipe_Chg.chkReason25.Visible(True)
Gui.F_Recipe_Chg.chkReason25.Zorder(0)
Gui.F_Recipe_Chg.chkReason25.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason26.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason26.Size(4020,300)
Gui.F_Recipe_Chg.chkReason26.Position(8235,7620)
Gui.F_Recipe_Chg.chkReason26.Caption("Reason 26")
Gui.F_Recipe_Chg.chkReason26.FontSize(12)
Gui.F_Recipe_Chg.chkReason26.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason26.Enabled(True)
Gui.F_Recipe_Chg.chkReason26.Visible(True)
Gui.F_Recipe_Chg.chkReason26.Zorder(0)
Gui.F_Recipe_Chg.chkReason26.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason27.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason27.Size(4020,300)
Gui.F_Recipe_Chg.chkReason27.Position(8235,7995)
Gui.F_Recipe_Chg.chkReason27.Caption("Reason 27")
Gui.F_Recipe_Chg.chkReason27.FontSize(12)
Gui.F_Recipe_Chg.chkReason27.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason27.Enabled(True)
Gui.F_Recipe_Chg.chkReason27.Visible(True)
Gui.F_Recipe_Chg.chkReason27.Zorder(0)
Gui.F_Recipe_Chg.chkReason27.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason28.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason28.Size(4020,300)
Gui.F_Recipe_Chg.chkReason28.Position(8235,8370)
Gui.F_Recipe_Chg.chkReason28.Caption("Reason 28")
Gui.F_Recipe_Chg.chkReason28.FontSize(12)
Gui.F_Recipe_Chg.chkReason28.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason28.Enabled(True)
Gui.F_Recipe_Chg.chkReason28.Visible(True)
Gui.F_Recipe_Chg.chkReason28.Zorder(0)
Gui.F_Recipe_Chg.chkReason28.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason29.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason29.Size(4020,300)
Gui.F_Recipe_Chg.chkReason29.Position(8235,8745)
Gui.F_Recipe_Chg.chkReason29.Caption("Reason 29")
Gui.F_Recipe_Chg.chkReason29.FontSize(12)
Gui.F_Recipe_Chg.chkReason29.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason29.Enabled(True)
Gui.F_Recipe_Chg.chkReason29.Visible(True)
Gui.F_Recipe_Chg.chkReason29.Zorder(0)
Gui.F_Recipe_Chg.chkReason29.FontName("Tahoma")
Gui.F_Recipe_Chg.chkReason30.Create(CheckBox)
Gui.F_Recipe_Chg.chkReason30.Size(4020,300)
Gui.F_Recipe_Chg.chkReason30.Position(8235,9120)
Gui.F_Recipe_Chg.chkReason30.Caption("Reason 30")
Gui.F_Recipe_Chg.chkReason30.FontSize(12)
Gui.F_Recipe_Chg.chkReason30.ControlGroup(1)
Gui.F_Recipe_Chg.chkReason30.Enabled(True)
Gui.F_Recipe_Chg.chkReason30.Visible(True)
Gui.F_Recipe_Chg.chkReason30.Zorder(0)
Gui.F_Recipe_Chg.chkReason30.FontName("Tahoma")
Gui.F_Recipe_Chg.chkOther.Create(CheckBox)
Gui.F_Recipe_Chg.chkOther.Size(4020,300)
Gui.F_Recipe_Chg.chkOther.Position(165,9495)
Gui.F_Recipe_Chg.chkOther.Caption("Other")
Gui.F_Recipe_Chg.chkOther.FontSize(12)
Gui.F_Recipe_Chg.chkOther.ControlGroup(1)
Gui.F_Recipe_Chg.chkOther.Enabled(True)
Gui.F_Recipe_Chg.chkOther.Visible(True)
Gui.F_Recipe_Chg.chkOther.Zorder(0)
Gui.F_Recipe_Chg.chkOther.FontName("Tahoma")
Gui.F_Recipe_Chg.txtComments.Create(TextboxM)
Gui.F_Recipe_Chg.txtComments.Size(12345,1695)
Gui.F_Recipe_Chg.txtComments.Position(0,10320)
Gui.F_Recipe_Chg.txtComments.Anchor(15)
Gui.F_Recipe_Chg.txtComments.FontSize(16)
Gui.F_Recipe_Chg.txtComments.ControlGroup(1)
Gui.F_Recipe_Chg.txtComments.Enabled(True)
Gui.F_Recipe_Chg.txtComments.Visible(True)
Gui.F_Recipe_Chg.txtComments.Zorder(0)
Gui.F_Recipe_Chg.txtComments.FontName("Tahoma")
Gui.F_Recipe_Chg.lblComments.Create(Label,"Comments",True,1935,435,0,120,9930,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Recipe_Chg.lblComments.BorderStyle(0)
Gui.F_Recipe_Chg.cmdCommit.Create(Button)
Gui.F_Recipe_Chg.cmdCommit.Size(2700,570)
Gui.F_Recipe_Chg.cmdCommit.Position(120,12120)
Gui.F_Recipe_Chg.cmdCommit.Caption("Request")
Gui.F_Recipe_Chg.cmdCommit.FontSize(16)
Gui.F_Recipe_Chg.cmdCommit.Event(Click,cmdCommit_Click)
Gui.F_Recipe_Chg.cmdCommit.Anchor(6)
Gui.F_Recipe_Chg.cmdCommit.Enabled(True)
Gui.F_Recipe_Chg.cmdCommit.Visible(True)
Gui.F_Recipe_Chg.cmdCommit.Zorder(0)
Gui.F_Recipe_Chg.cmdCommit.FontName("Tahoma")
Gui.F_Recipe_Chg.txtJob.Create(TextBox,"",True,1500,390,0,6105,5340,True,0,"Tahoma",12,,1)
Gui.F_Recipe_Chg.txtJob.MaxLength(6)
Gui.F_Recipe_Chg.txtSuf.Create(TextBox,"",True,900,390,0,8580,5340,True,0,"Tahoma",12,,1)
Gui.F_Recipe_Chg.txtSuf.MaxLength(3)
Gui.F_Recipe_Chg.lblJob.Create(Label,"Job",True,480,375,0,5505,5355,True,0,"Tahoma",16,,0,0)
Gui.F_Recipe_Chg.lblJob.BorderStyle(0)
Gui.F_Recipe_Chg.lblSuf.Create(Label,"Suffix",True,795,375,0,7695,5355,True,0,"Tahoma",16,,0,0)
Gui.F_Recipe_Chg.lblSuf.BorderStyle(0)
Gui.F_Security..Create(BaseForm)
Gui.F_Security..Caption("Log In")
Gui.F_Security..Size(5505,3120)
Gui.F_Security..MinX(0)
Gui.F_Security..MinY(0)
Gui.F_Security..Position(0,0)
Gui.F_Security..BackColor(-2147483633)
Gui.F_Security..ControlBox(False)
Gui.F_Security..MousePointer(0)
Gui.F_Security..Sizeable(False)
Gui.F_Security..AlwaysOnTop(False)
Gui.F_Security..FontName("Tahoma")
Gui.F_Security..FontSize(8.25)
Gui.F_Security..MaxButton(True)
Gui.F_Security..MinButton(True)
Gui.F_Security..Moveable(True)
Gui.F_Security..ShowInTaskBar(True)
Gui.F_Security..TitleBar(True)
Gui.F_Security.txtUser.Create(TextBox,"",True,3135,450,0,2055,135,True,0,"Arial",16,-2147483643,1)
Gui.F_Security.txtUser.FontStyle(True,False,False,False,False)
Gui.F_Security.txtUser.MaxLength(8)
Gui.F_Security.txtUser.Event(KeyPressEnter,cmdLogIn_Click)
Gui.F_Security.txtUser.Mask(">")
Gui.F_Security.lblUser.Create(Label,"Username:",True,1755,420,0,150,210,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Security.lblUser.BorderStyle(0)
Gui.F_Security.lblPW.Create(Label,"Password:",True,1755,420,0,150,750,True,0,"Arial",16,-2147483633,0,0)
Gui.F_Security.lblPW.BorderStyle(0)
Gui.F_Security.txtPW.Create(TextBox,"",True,3135,450,0,2055,690,True,0,"Arial",16,-2147483643,1)
Gui.F_Security.txtPW.PasswordChar("*")
Gui.F_Security.txtPW.Event(KeyPressEnter,cmdLogIn_Click)
Gui.F_Security.cmdLogIn.Create(Button)
Gui.F_Security.cmdLogIn.Size(2700,570)
Gui.F_Security.cmdLogIn.Position(270,1275)
Gui.F_Security.cmdLogIn.Caption("Log In")
Gui.F_Security.cmdLogIn.FontSize(16)
Gui.F_Security.cmdLogIn.Event(Click,cmdLogIn_Click)
Gui.F_Security.cmdLogIn.Enabled(True)
Gui.F_Security.cmdLogIn.Visible(True)
Gui.F_Security.cmdLogIn.Zorder(0)
Gui.F_Security.cmdLogIn.FontName("Tahoma")
Gui.F_Security.cmdLogInCancel.Create(Button)
Gui.F_Security.cmdLogInCancel.Size(2700,570)
Gui.F_Security.cmdLogInCancel.Position(270,1965)
Gui.F_Security.cmdLogInCancel.Caption("Cancel")
Gui.F_Security.cmdLogInCancel.FontSize(16)
Gui.F_Security.cmdLogInCancel.Event(Click,cmdLogInCancel_Click)
Gui.F_Security.cmdLogInCancel.Enabled(True)
Gui.F_Security.cmdLogInCancel.Visible(True)
Gui.F_Security.cmdLogInCancel.Zorder(0)
Gui.F_Security.cmdLogInCancel.FontName("Tahoma")
Gui.F_Warning..Create(BaseForm)
Gui.F_Warning..Caption("WARNING")
Gui.F_Warning..Size(6870,3600)
Gui.F_Warning..MinX(0)
Gui.F_Warning..MinY(0)
Gui.F_Warning..Position(0,0)
Gui.F_Warning..BackColor(-2147483633)
Gui.F_Warning..MousePointer(0)
Gui.F_Warning..AlwaysOnTop(False)
Gui.F_Warning..FontName("Tahoma")
Gui.F_Warning..FontSize(8.25)
Gui.F_Warning..ControlBox(True)
Gui.F_Warning..MaxButton(True)
Gui.F_Warning..MinButton(True)
Gui.F_Warning..Moveable(True)
Gui.F_Warning..Sizeable(True)
Gui.F_Warning..ShowInTaskBar(True)
Gui.F_Warning..TitleBar(True)
Gui.F_Warning.txtWarning.Create(TextboxM)
Gui.F_Warning.txtWarning.Enabled(False)
Gui.F_Warning.txtWarning.Size(6585,2325)
Gui.F_Warning.txtWarning.Position(60,60)
Gui.F_Warning.txtWarning.Anchor(15)
Gui.F_Warning.txtWarning.Visible(True)
Gui.F_Warning.txtWarning.Zorder(0)
Gui.F_Warning.txtWarning.FontName("Tahoma")
Gui.F_Warning.txtWarning.FontSize(8.25)
Gui.F_Warning.cmdWarning1.Create(Button)
Gui.F_Warning.cmdWarning1.Size(2700,570)
Gui.F_Warning.cmdWarning1.Position(120,2505)
Gui.F_Warning.cmdWarning1.Caption("Button 1")
Gui.F_Warning.cmdWarning1.FontSize(16)
Gui.F_Warning.cmdWarning1.Enabled(True)
Gui.F_Warning.cmdWarning1.Visible(True)
Gui.F_Warning.cmdWarning1.Zorder(0)
Gui.F_Warning.cmdWarning1.FontName("Tahoma")
Gui.F_Warning.cmdWarning2.Create(Button)
Gui.F_Warning.cmdWarning2.Size(2700,570)
Gui.F_Warning.cmdWarning2.Position(3075,2505)
Gui.F_Warning.cmdWarning2.Anchor(6)
Gui.F_Warning.cmdWarning2.Caption("Button 2")
Gui.F_Warning.cmdWarning2.FontSize(16)
Gui.F_Warning.cmdWarning2.Enabled(True)
Gui.F_Warning.cmdWarning2.Visible(True)
Gui.F_Warning.cmdWarning2.Zorder(0)
Gui.F_Warning.cmdWarning2.FontName("Tahoma")
Gui.F_Approval..Create(BaseForm)
Gui.F_Approval..Caption("Recipe Change Requests")
Gui.F_Approval..Size(10500,11325)
Gui.F_Approval..MinX(0)
Gui.F_Approval..MinY(0)
Gui.F_Approval..Position(0,0)
Gui.F_Approval..BackColor(-2147483633)
Gui.F_Approval..MousePointer(0)
Gui.F_Approval..Event(UnLoad,F_Approval_UnLoad)
Gui.F_Approval..AlwaysOnTop(False)
Gui.F_Approval..FontName("Tahoma")
Gui.F_Approval..FontSize(8.25)
Gui.F_Approval..ControlBox(True)
Gui.F_Approval..MaxButton(True)
Gui.F_Approval..MinButton(True)
Gui.F_Approval..Moveable(True)
Gui.F_Approval..Sizeable(True)
Gui.F_Approval..ShowInTaskBar(True)
Gui.F_Approval..TitleBar(True)
Gui.F_Approval.gsgcRequests.Create(GsGridControl)
Gui.F_Approval.gsgcRequests.Size(10500,2685)
Gui.F_Approval.gsgcRequests.Position(0,0)
Gui.F_Approval.gsgcRequests.Anchor(15)
Gui.F_Approval.gsgcRequests.Event(RowCellClick,gsgcRequests_RowCellClick)
Gui.F_Approval.gsgcRequests.Enabled(True)
Gui.F_Approval.gsgcRequests.Visible(True)
Gui.F_Approval.gsgcRequests.Zorder(0)
Gui.F_Approval.lblReasons.Create(Label,"Reasons for Requested Change",True,2325,210,0,120,3150,True,0,"Arial",8.25,-2147483633,0,0)
Gui.F_Approval.lblReasons.BorderStyle(0)
Gui.F_Approval.lblReasons.Anchor(6)
Gui.F_Approval.chkReason1.Create(CheckBox)
Gui.F_Approval.chkReason1.Size(3255,300)
Gui.F_Approval.chkReason1.Position(165,3405)
Gui.F_Approval.chkReason1.Caption("Reason 1")
Gui.F_Approval.chkReason1.FontSize(8.25)
Gui.F_Approval.chkReason1.ControlGroup(1)
Gui.F_Approval.chkReason1.Enabled(True)
Gui.F_Approval.chkReason1.Visible(True)
Gui.F_Approval.chkReason1.Zorder(0)
Gui.F_Approval.chkReason1.FontName("Tahoma")
Gui.F_Approval.chkReason1.Anchor(6)
Gui.F_Approval.chkReason1.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason2.Create(CheckBox)
Gui.F_Approval.chkReason2.Size(3255,300)
Gui.F_Approval.chkReason2.Position(165,3720)
Gui.F_Approval.chkReason2.Caption("Reason 2")
Gui.F_Approval.chkReason2.FontSize(8.25)
Gui.F_Approval.chkReason2.ControlGroup(1)
Gui.F_Approval.chkReason2.Enabled(True)
Gui.F_Approval.chkReason2.Visible(True)
Gui.F_Approval.chkReason2.Zorder(0)
Gui.F_Approval.chkReason2.FontName("Tahoma")
Gui.F_Approval.chkReason2.Anchor(6)
Gui.F_Approval.chkReason2.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason3.Create(CheckBox)
Gui.F_Approval.chkReason3.Size(3255,300)
Gui.F_Approval.chkReason3.Position(165,4035)
Gui.F_Approval.chkReason3.Caption("Reason 3")
Gui.F_Approval.chkReason3.FontSize(8.25)
Gui.F_Approval.chkReason3.ControlGroup(1)
Gui.F_Approval.chkReason3.Enabled(True)
Gui.F_Approval.chkReason3.Visible(True)
Gui.F_Approval.chkReason3.Zorder(0)
Gui.F_Approval.chkReason3.FontName("Tahoma")
Gui.F_Approval.chkReason3.Anchor(6)
Gui.F_Approval.chkReason3.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason4.Create(CheckBox)
Gui.F_Approval.chkReason4.Size(3255,300)
Gui.F_Approval.chkReason4.Position(165,4350)
Gui.F_Approval.chkReason4.Caption("Reason 4")
Gui.F_Approval.chkReason4.FontSize(8.25)
Gui.F_Approval.chkReason4.ControlGroup(1)
Gui.F_Approval.chkReason4.Enabled(True)
Gui.F_Approval.chkReason4.Visible(True)
Gui.F_Approval.chkReason4.Zorder(0)
Gui.F_Approval.chkReason4.FontName("Tahoma")
Gui.F_Approval.chkReason4.Anchor(6)
Gui.F_Approval.chkReason4.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason5.Create(CheckBox)
Gui.F_Approval.chkReason5.Size(3255,300)
Gui.F_Approval.chkReason5.Position(165,4665)
Gui.F_Approval.chkReason5.Caption("Reason 5")
Gui.F_Approval.chkReason5.FontSize(8.25)
Gui.F_Approval.chkReason5.ControlGroup(1)
Gui.F_Approval.chkReason5.Enabled(True)
Gui.F_Approval.chkReason5.Visible(True)
Gui.F_Approval.chkReason5.Zorder(0)
Gui.F_Approval.chkReason5.FontName("Tahoma")
Gui.F_Approval.chkReason5.Anchor(6)
Gui.F_Approval.chkReason5.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason6.Create(CheckBox)
Gui.F_Approval.chkReason6.Size(3255,300)
Gui.F_Approval.chkReason6.Position(165,4980)
Gui.F_Approval.chkReason6.Caption("Reason 6")
Gui.F_Approval.chkReason6.FontSize(8.25)
Gui.F_Approval.chkReason6.ControlGroup(1)
Gui.F_Approval.chkReason6.Enabled(True)
Gui.F_Approval.chkReason6.Visible(True)
Gui.F_Approval.chkReason6.Zorder(0)
Gui.F_Approval.chkReason6.FontName("Tahoma")
Gui.F_Approval.chkReason6.Anchor(6)
Gui.F_Approval.chkReason6.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason7.Create(CheckBox)
Gui.F_Approval.chkReason7.Size(3255,300)
Gui.F_Approval.chkReason7.Position(165,5295)
Gui.F_Approval.chkReason7.Caption("Reason 7")
Gui.F_Approval.chkReason7.FontSize(8.25)
Gui.F_Approval.chkReason7.ControlGroup(1)
Gui.F_Approval.chkReason7.Enabled(True)
Gui.F_Approval.chkReason7.Visible(True)
Gui.F_Approval.chkReason7.Zorder(0)
Gui.F_Approval.chkReason7.FontName("Tahoma")
Gui.F_Approval.chkReason7.Anchor(6)
Gui.F_Approval.chkReason7.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason8.Create(CheckBox)
Gui.F_Approval.chkReason8.Size(3255,300)
Gui.F_Approval.chkReason8.Position(165,5610)
Gui.F_Approval.chkReason8.Caption("Reason 8")
Gui.F_Approval.chkReason8.FontSize(8.25)
Gui.F_Approval.chkReason8.ControlGroup(1)
Gui.F_Approval.chkReason8.Enabled(True)
Gui.F_Approval.chkReason8.Visible(True)
Gui.F_Approval.chkReason8.Zorder(0)
Gui.F_Approval.chkReason8.FontName("Tahoma")
Gui.F_Approval.chkReason8.Anchor(6)
Gui.F_Approval.chkReason8.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason9.Create(CheckBox)
Gui.F_Approval.chkReason9.Size(3255,300)
Gui.F_Approval.chkReason9.Position(165,5925)
Gui.F_Approval.chkReason9.Caption("Reason 9")
Gui.F_Approval.chkReason9.FontSize(8.25)
Gui.F_Approval.chkReason9.ControlGroup(1)
Gui.F_Approval.chkReason9.Enabled(True)
Gui.F_Approval.chkReason9.Visible(True)
Gui.F_Approval.chkReason9.Zorder(0)
Gui.F_Approval.chkReason9.FontName("Tahoma")
Gui.F_Approval.chkReason9.Anchor(6)
Gui.F_Approval.chkReason9.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason10.Create(CheckBox)
Gui.F_Approval.chkReason10.Size(3255,300)
Gui.F_Approval.chkReason10.Position(165,6240)
Gui.F_Approval.chkReason10.Caption("Reason 10")
Gui.F_Approval.chkReason10.FontSize(8.25)
Gui.F_Approval.chkReason10.ControlGroup(1)
Gui.F_Approval.chkReason10.Enabled(True)
Gui.F_Approval.chkReason10.Visible(True)
Gui.F_Approval.chkReason10.Zorder(0)
Gui.F_Approval.chkReason10.FontName("Tahoma")
Gui.F_Approval.chkReason10.Anchor(6)
Gui.F_Approval.chkReason10.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason11.Create(CheckBox)
Gui.F_Approval.chkReason11.Size(3255,300)
Gui.F_Approval.chkReason11.Position(3465,3405)
Gui.F_Approval.chkReason11.Caption("Reason 11")
Gui.F_Approval.chkReason11.FontSize(8.25)
Gui.F_Approval.chkReason11.ControlGroup(1)
Gui.F_Approval.chkReason11.Enabled(True)
Gui.F_Approval.chkReason11.Visible(True)
Gui.F_Approval.chkReason11.Zorder(0)
Gui.F_Approval.chkReason11.FontName("Tahoma")
Gui.F_Approval.chkReason11.Anchor(6)
Gui.F_Approval.chkReason11.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason12.Create(CheckBox)
Gui.F_Approval.chkReason12.Size(3255,300)
Gui.F_Approval.chkReason12.Position(3465,3720)
Gui.F_Approval.chkReason12.Caption("Reason 12")
Gui.F_Approval.chkReason12.FontSize(8.25)
Gui.F_Approval.chkReason12.ControlGroup(1)
Gui.F_Approval.chkReason12.Enabled(True)
Gui.F_Approval.chkReason12.Visible(True)
Gui.F_Approval.chkReason12.Zorder(0)
Gui.F_Approval.chkReason12.FontName("Tahoma")
Gui.F_Approval.chkReason12.Anchor(6)
Gui.F_Approval.chkReason12.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason13.Create(CheckBox)
Gui.F_Approval.chkReason13.Size(3255,300)
Gui.F_Approval.chkReason13.Position(3465,4035)
Gui.F_Approval.chkReason13.Caption("Reason 13")
Gui.F_Approval.chkReason13.FontSize(8.25)
Gui.F_Approval.chkReason13.ControlGroup(1)
Gui.F_Approval.chkReason13.Enabled(True)
Gui.F_Approval.chkReason13.Visible(True)
Gui.F_Approval.chkReason13.Zorder(0)
Gui.F_Approval.chkReason13.FontName("Tahoma")
Gui.F_Approval.chkReason13.Anchor(6)
Gui.F_Approval.chkReason13.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason14.Create(CheckBox)
Gui.F_Approval.chkReason14.Size(3255,300)
Gui.F_Approval.chkReason14.Position(3465,4350)
Gui.F_Approval.chkReason14.Caption("Reason 14")
Gui.F_Approval.chkReason14.FontSize(8.25)
Gui.F_Approval.chkReason14.ControlGroup(1)
Gui.F_Approval.chkReason14.Enabled(True)
Gui.F_Approval.chkReason14.Visible(True)
Gui.F_Approval.chkReason14.Zorder(0)
Gui.F_Approval.chkReason14.FontName("Tahoma")
Gui.F_Approval.chkReason14.Anchor(6)
Gui.F_Approval.chkReason14.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason15.Create(CheckBox)
Gui.F_Approval.chkReason15.Size(3255,300)
Gui.F_Approval.chkReason15.Position(3465,4665)
Gui.F_Approval.chkReason15.Caption("Reason 15")
Gui.F_Approval.chkReason15.FontSize(8.25)
Gui.F_Approval.chkReason15.ControlGroup(1)
Gui.F_Approval.chkReason15.Enabled(True)
Gui.F_Approval.chkReason15.Visible(True)
Gui.F_Approval.chkReason15.Zorder(0)
Gui.F_Approval.chkReason15.FontName("Tahoma")
Gui.F_Approval.chkReason15.Anchor(6)
Gui.F_Approval.chkReason15.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason16.Create(CheckBox)
Gui.F_Approval.chkReason16.Size(3255,300)
Gui.F_Approval.chkReason16.Position(3465,4980)
Gui.F_Approval.chkReason16.Caption("Reason 16")
Gui.F_Approval.chkReason16.FontSize(8.25)
Gui.F_Approval.chkReason16.ControlGroup(1)
Gui.F_Approval.chkReason16.Enabled(True)
Gui.F_Approval.chkReason16.Visible(True)
Gui.F_Approval.chkReason16.Zorder(0)
Gui.F_Approval.chkReason16.FontName("Tahoma")
Gui.F_Approval.chkReason16.Anchor(6)
Gui.F_Approval.chkReason16.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason17.Create(CheckBox)
Gui.F_Approval.chkReason17.Size(3255,300)
Gui.F_Approval.chkReason17.Position(3465,5295)
Gui.F_Approval.chkReason17.Caption("Reason 17")
Gui.F_Approval.chkReason17.FontSize(8.25)
Gui.F_Approval.chkReason17.ControlGroup(1)
Gui.F_Approval.chkReason17.Enabled(True)
Gui.F_Approval.chkReason17.Visible(True)
Gui.F_Approval.chkReason17.Zorder(0)
Gui.F_Approval.chkReason17.FontName("Tahoma")
Gui.F_Approval.chkReason17.Anchor(6)
Gui.F_Approval.chkReason17.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason18.Create(CheckBox)
Gui.F_Approval.chkReason18.Size(3255,300)
Gui.F_Approval.chkReason18.Position(3465,5610)
Gui.F_Approval.chkReason18.Caption("Reason 18")
Gui.F_Approval.chkReason18.FontSize(8.25)
Gui.F_Approval.chkReason18.ControlGroup(1)
Gui.F_Approval.chkReason18.Enabled(True)
Gui.F_Approval.chkReason18.Visible(True)
Gui.F_Approval.chkReason18.Zorder(0)
Gui.F_Approval.chkReason18.FontName("Tahoma")
Gui.F_Approval.chkReason18.Anchor(6)
Gui.F_Approval.chkReason18.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason19.Create(CheckBox)
Gui.F_Approval.chkReason19.Size(3255,300)
Gui.F_Approval.chkReason19.Position(3465,5925)
Gui.F_Approval.chkReason19.Caption("Reason 19")
Gui.F_Approval.chkReason19.FontSize(8.25)
Gui.F_Approval.chkReason19.ControlGroup(1)
Gui.F_Approval.chkReason19.Enabled(True)
Gui.F_Approval.chkReason19.Visible(True)
Gui.F_Approval.chkReason19.Zorder(0)
Gui.F_Approval.chkReason19.FontName("Tahoma")
Gui.F_Approval.chkReason19.Anchor(6)
Gui.F_Approval.chkReason19.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason20.Create(CheckBox)
Gui.F_Approval.chkReason20.Size(3255,300)
Gui.F_Approval.chkReason20.Position(3465,6240)
Gui.F_Approval.chkReason20.Caption("Reason 20")
Gui.F_Approval.chkReason20.FontSize(8.25)
Gui.F_Approval.chkReason20.ControlGroup(1)
Gui.F_Approval.chkReason20.Enabled(True)
Gui.F_Approval.chkReason20.Visible(True)
Gui.F_Approval.chkReason20.Zorder(0)
Gui.F_Approval.chkReason20.FontName("Tahoma")
Gui.F_Approval.chkReason20.Anchor(6)
Gui.F_Approval.chkReason20.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason21.Create(CheckBox)
Gui.F_Approval.chkReason21.Size(3255,300)
Gui.F_Approval.chkReason21.Position(6765,3405)
Gui.F_Approval.chkReason21.Caption("Reason 21")
Gui.F_Approval.chkReason21.FontSize(8.25)
Gui.F_Approval.chkReason21.ControlGroup(1)
Gui.F_Approval.chkReason21.Enabled(True)
Gui.F_Approval.chkReason21.Visible(True)
Gui.F_Approval.chkReason21.Zorder(0)
Gui.F_Approval.chkReason21.FontName("Tahoma")
Gui.F_Approval.chkReason21.Anchor(6)
Gui.F_Approval.chkReason21.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason22.Create(CheckBox)
Gui.F_Approval.chkReason22.Size(3255,300)
Gui.F_Approval.chkReason22.Position(6765,3720)
Gui.F_Approval.chkReason22.Caption("Reason 22")
Gui.F_Approval.chkReason22.FontSize(8.25)
Gui.F_Approval.chkReason22.ControlGroup(1)
Gui.F_Approval.chkReason22.Enabled(True)
Gui.F_Approval.chkReason22.Visible(True)
Gui.F_Approval.chkReason22.Zorder(0)
Gui.F_Approval.chkReason22.FontName("Tahoma")
Gui.F_Approval.chkReason22.Anchor(6)
Gui.F_Approval.chkReason22.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason23.Create(CheckBox)
Gui.F_Approval.chkReason23.Size(3255,300)
Gui.F_Approval.chkReason23.Position(6765,4035)
Gui.F_Approval.chkReason23.Caption("Reason 23")
Gui.F_Approval.chkReason23.FontSize(8.25)
Gui.F_Approval.chkReason23.ControlGroup(1)
Gui.F_Approval.chkReason23.Enabled(True)
Gui.F_Approval.chkReason23.Visible(True)
Gui.F_Approval.chkReason23.Zorder(0)
Gui.F_Approval.chkReason23.FontName("Tahoma")
Gui.F_Approval.chkReason23.Anchor(6)
Gui.F_Approval.chkReason23.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason24.Create(CheckBox)
Gui.F_Approval.chkReason24.Size(3255,300)
Gui.F_Approval.chkReason24.Position(6765,4350)
Gui.F_Approval.chkReason24.Caption("Reason 24")
Gui.F_Approval.chkReason24.FontSize(8.25)
Gui.F_Approval.chkReason24.ControlGroup(1)
Gui.F_Approval.chkReason24.Enabled(True)
Gui.F_Approval.chkReason24.Visible(True)
Gui.F_Approval.chkReason24.Zorder(0)
Gui.F_Approval.chkReason24.FontName("Tahoma")
Gui.F_Approval.chkReason24.Anchor(6)
Gui.F_Approval.chkReason24.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason25.Create(CheckBox)
Gui.F_Approval.chkReason25.Size(3255,300)
Gui.F_Approval.chkReason25.Position(6765,4665)
Gui.F_Approval.chkReason25.Caption("Reason 25")
Gui.F_Approval.chkReason25.FontSize(8.25)
Gui.F_Approval.chkReason25.ControlGroup(1)
Gui.F_Approval.chkReason25.Enabled(True)
Gui.F_Approval.chkReason25.Visible(True)
Gui.F_Approval.chkReason25.Zorder(0)
Gui.F_Approval.chkReason25.FontName("Tahoma")
Gui.F_Approval.chkReason25.Anchor(6)
Gui.F_Approval.chkReason25.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason26.Create(CheckBox)
Gui.F_Approval.chkReason26.Size(3255,300)
Gui.F_Approval.chkReason26.Position(6765,4980)
Gui.F_Approval.chkReason26.Caption("Reason 26")
Gui.F_Approval.chkReason26.FontSize(8.25)
Gui.F_Approval.chkReason26.ControlGroup(1)
Gui.F_Approval.chkReason26.Enabled(True)
Gui.F_Approval.chkReason26.Visible(True)
Gui.F_Approval.chkReason26.Zorder(0)
Gui.F_Approval.chkReason26.FontName("Tahoma")
Gui.F_Approval.chkReason26.Anchor(6)
Gui.F_Approval.chkReason26.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason27.Create(CheckBox)
Gui.F_Approval.chkReason27.Size(3255,300)
Gui.F_Approval.chkReason27.Position(6765,5295)
Gui.F_Approval.chkReason27.Caption("Reason 27")
Gui.F_Approval.chkReason27.FontSize(8.25)
Gui.F_Approval.chkReason27.ControlGroup(1)
Gui.F_Approval.chkReason27.Enabled(True)
Gui.F_Approval.chkReason27.Visible(True)
Gui.F_Approval.chkReason27.Zorder(0)
Gui.F_Approval.chkReason27.FontName("Tahoma")
Gui.F_Approval.chkReason27.Anchor(6)
Gui.F_Approval.chkReason27.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason28.Create(CheckBox)
Gui.F_Approval.chkReason28.Size(3255,300)
Gui.F_Approval.chkReason28.Position(6765,5610)
Gui.F_Approval.chkReason28.Caption("Reason 28")
Gui.F_Approval.chkReason28.FontSize(8.25)
Gui.F_Approval.chkReason28.ControlGroup(1)
Gui.F_Approval.chkReason28.Enabled(True)
Gui.F_Approval.chkReason28.Visible(True)
Gui.F_Approval.chkReason28.Zorder(0)
Gui.F_Approval.chkReason28.FontName("Tahoma")
Gui.F_Approval.chkReason28.Anchor(6)
Gui.F_Approval.chkReason28.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason29.Create(CheckBox)
Gui.F_Approval.chkReason29.Size(3255,300)
Gui.F_Approval.chkReason29.Position(6765,5925)
Gui.F_Approval.chkReason29.Caption("Reason 29")
Gui.F_Approval.chkReason29.FontSize(8.25)
Gui.F_Approval.chkReason29.ControlGroup(1)
Gui.F_Approval.chkReason29.Enabled(True)
Gui.F_Approval.chkReason29.Visible(True)
Gui.F_Approval.chkReason29.Zorder(0)
Gui.F_Approval.chkReason29.FontName("Tahoma")
Gui.F_Approval.chkReason29.Anchor(6)
Gui.F_Approval.chkReason29.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkReason30.Create(CheckBox)
Gui.F_Approval.chkReason30.Size(3255,300)
Gui.F_Approval.chkReason30.Position(6765,6240)
Gui.F_Approval.chkReason30.Caption("Reason 30")
Gui.F_Approval.chkReason30.FontSize(8.25)
Gui.F_Approval.chkReason30.ControlGroup(1)
Gui.F_Approval.chkReason30.Enabled(True)
Gui.F_Approval.chkReason30.Visible(True)
Gui.F_Approval.chkReason30.Zorder(0)
Gui.F_Approval.chkReason30.FontName("Tahoma")
Gui.F_Approval.chkReason30.Anchor(6)
Gui.F_Approval.chkReason30.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.chkOther.Create(CheckBox)
Gui.F_Approval.chkOther.Size(3255,300)
Gui.F_Approval.chkOther.Position(165,6555)
Gui.F_Approval.chkOther.Caption("Other")
Gui.F_Approval.chkOther.FontSize(8.25)
Gui.F_Approval.chkOther.ControlGroup(1)
Gui.F_Approval.chkOther.Enabled(True)
Gui.F_Approval.chkOther.Visible(True)
Gui.F_Approval.chkOther.Zorder(0)
Gui.F_Approval.chkOther.FontName("Tahoma")
Gui.F_Approval.chkOther.Anchor(6)
Gui.F_Approval.chkOther.Event(Click,chkApprovalReason_Click)
Gui.F_Approval.txtComments.Create(TextboxM)
Gui.F_Approval.txtComments.Size(10500,3060)
Gui.F_Approval.txtComments.Position(0,7215)
Gui.F_Approval.txtComments.Anchor(14)
Gui.F_Approval.txtComments.FontSize(8.25)
Gui.F_Approval.txtComments.ControlGroup(1)
Gui.F_Approval.txtComments.Enabled(True)
Gui.F_Approval.txtComments.Visible(True)
Gui.F_Approval.txtComments.Zorder(0)
Gui.F_Approval.txtComments.FontName("Tahoma")
Gui.F_Approval.txtComments.Event(LostFocus,txtComments_LostFocus)
Gui.F_Approval.lblComments.Create(Label,"Comments",True,750,210,0,120,6945,True,0,"Arial",8.25,-2147483633,0,0)
Gui.F_Approval.lblComments.BorderStyle(0)
Gui.F_Approval.lblComments.Anchor(6)
Gui.F_Approval.cmdChgProcess.Create(Button)
Gui.F_Approval.cmdChgProcess.Size(1050,405)
Gui.F_Approval.cmdChgProcess.Position(120,10380)
Gui.F_Approval.cmdChgProcess.Anchor(6)
Gui.F_Approval.cmdChgProcess.Caption("Process")
Gui.F_Approval.cmdChgProcess.Event(Click,cmdChgProcess_Click)
Gui.F_Approval.cmdChgProcess.Enabled(True)
Gui.F_Approval.cmdChgProcess.Visible(True)
Gui.F_Approval.cmdChgProcess.Zorder(0)
Gui.F_Approval.cmdChgProcess.FontName("Tahoma")
Gui.F_Approval.cmdChgProcess.FontSize(8.25)
Gui.F_Approval.txtChgID.Create(TextBox,"",True,1200,300,0,1500,2775,True,1,"Tahoma",8.25,,1)
Gui.F_Approval.txtChgID.Locked(True)
Gui.F_Approval.txtChgID.Anchor(6)
Gui.F_Approval.lblChgID.Create(Label,"Selected Request",True,1260,195,0,120,2820,True,0,"Tahoma",8.25,,0,0)
Gui.F_Approval.lblChgID.BorderStyle(0)
Gui.F_Approval.lblChgID.Anchor(6)
Gui.F_Approval.cmdLockReq.Create(Button)
Gui.F_Approval.cmdLockReq.Enabled(True)
Gui.F_Approval.cmdLockReq.Visible(True)
Gui.F_Approval.cmdLockReq.Zorder(0)
Gui.F_Approval.cmdLockReq.Size(300,300)
Gui.F_Approval.cmdLockReq.Position(2790,2775)
Gui.F_Approval.cmdLockReq.Caption("")
Gui.F_Approval.cmdLockReq.FontName("Tahoma")
Gui.F_Approval.cmdLockReq.FontSize(8.25)
Gui.F_Approval.cmdLockReq.SvgPicture("icon_key_black")
Gui.F_Approval.cmdLockReq.Event(Click,cmdLockReq_Click)
Gui.F_Approval.cmdLockReq.Anchor(6)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Program.External.Include.Library("GCG_6495_ErrorHandling.lib")

V.Global.sBarcodeReplace.Declare
V.Global.sBarcodeReplace.Set("$%")
V.Global.sPart.Declare
V.Global.sLoc.Declare
V.Global.sRecipeType.Declare
V.Global.bLoadData.Declare
V.Global.bLoadData.Set(False)
V.Global.bShowAddRecipe.Declare
V.Global.bShowAddRecipe.Set(False)
V.Global.bShowSecurity.Declare
V.Global.bShowSecurity.Set(False)
V.Global.bShowChgRecipe.Declare
V.Global.bShowChgRecipe.Set(False)
V.Global.bEndChg.Declare
V.Global.bLockReq.Declare
V.Global.bLockReq.Set(False)
V.Global.sJob.Declare
V.Global.sSuffix.Declare

F.Data.DataTable.Create("dtRecipe",True)
F.Data.DataTable.AddColumn("dtRecipe","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtRecipe","Grade","String")
F.Data.DataTable.AddColumn("dtRecipe","Size","String")
F.Data.DataTable.AddColumn("dtRecipe","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipe","ActivatorType","String")
F.Data.DataTable.AddColumn("dtRecipe","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipe","PourTemp","Float")
F.Data.DataTable.AddColumn("dtRecipe","PourWeight","Float")
F.Data.DataTable.AddColumn("dtRecipe","DyeType","String")
F.Data.DataTable.AddColumn("dtRecipe","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipe","AdditionalType","String")
F.Data.DataTable.AddColumn("dtRecipe","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipe","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtRecipe","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipe","BalanceCaproPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("dtRecipe","Totals","Float","isnull([ActivatorPerToAdd], 0) + isnull([CatalystPerToAdd], 0) + isnull([DyePerToAdd], 0) + isnull([AdditionalPerToAdd], 0) + isnull([AdditionalAdditivesPerToAdd], 0) + isnull([BalanceCaproPerToAdd], 0)")

F.Data.DataTable.Create("dtRecipeChg",True)
F.Data.DataTable.AddColumn("dtRecipeChg","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtRecipeChg","Grade","String")
F.Data.DataTable.AddColumn("dtRecipeChg","Size","String")
F.Data.DataTable.AddColumn("dtRecipeChg","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","ActivatorType","String")
F.Data.DataTable.AddColumn("dtRecipeChg","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","PourTemp","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","PourWeight","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","DyeType","String")
F.Data.DataTable.AddColumn("dtRecipeChg","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","AdditionalType","String")
F.Data.DataTable.AddColumn("dtRecipeChg","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtRecipeChg","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChg","BalanceCaproPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("dtRecipeChg","Totals","Float","isnull([ActivatorPerToAdd], 0) + isnull([CatalystPerToAdd], 0) + isnull([DyePerToAdd], 0) + isnull([AdditionalPerToAdd], 0) + isnull([AdditionalAdditivesPerToAdd], 0) + isnull([BalanceCaproPerToAdd], 0)")

F.Data.DataTable.Create("dtAddRecipe",True)
F.Data.DataTable.AddColumn("dtAddRecipe","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtAddRecipe","RecipeType","String")
F.Data.DataTable.AddColumn("dtAddRecipe","Grade","String")
F.Data.DataTable.AddColumn("dtAddRecipe","Size","String")
F.Data.DataTable.AddColumn("dtAddRecipe","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","ActivatorType","String")
F.Data.DataTable.AddColumn("dtAddRecipe","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","PourTemp","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","PourWeight","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","DyeType","String")
F.Data.DataTable.AddColumn("dtAddRecipe","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","AdditionalType","String")
F.Data.DataTable.AddColumn("dtAddRecipe","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtAddRecipe","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddColumn("dtAddRecipe","BalanceCaproPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("dtAddRecipe","Totals","Float","isnull([ActivatorPerToAdd], 0) + isnull([CatalystPerToAdd], 0) + isnull([DyePerToAdd], 0) + isnull([AdditionalPerToAdd], 0) + isnull([AdditionalAdditivesPerToAdd], 0) + isnull([BalanceCaproPerToAdd], 0)")

F.Data.DataTable.Create("dtRecipeChgReqs",True)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RequestID","Integer")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","LastDate","DateTime")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RecipeTable","String")
F.Data.DataTable.AddExpressionColumn("dtRecipeChgReqs","V_RecipeTable","String","iif([RecipeTable] = 'GCG_6495_MPU9_ALLYEAR', 'MPU9 - All Year', iif([RecipeTable] = 'GCG_6495_MPU9_SUMMER', 'MPU9 - Summer', iif([RecipeTable] = 'GCG_MPU9_WINTER', 'MPU9 - Winter', iif([RecipeTable] = 'GCG_MPU9_LA_SUMMER', 'MPU9 - Liquid Activator Summer', iif([RecipeTable] = 'GCG_MPU9_LA_WINTER', 'MPU9 - Liquid Activator Winter', 'Unknown - ' + [RecipeTable])))))")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Grade","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Size","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveActivatorPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectActivatorPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldActivatorType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ActivatorType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveActivatorType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectActivatorType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldCatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveCatalystPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectCatalystPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldPourTemp","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","PourTemp","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApprovePourTemp","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectPourTemp","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldPourWeight","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","PourWeight","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApprovePourWeight","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectPourWeight","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldDyeType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","DyeType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveDyeType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectDyeType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldDyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveDyePerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectDyePerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldAdditionalType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","AdditionalType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveAdditionalType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectAdditionalType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldAdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveAdditionalPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectAdditionalPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldAdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveAdditionalAdditivesType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectAdditionalAdditivesType","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldAdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ApproveAdditionalAdditivesPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RejectAdditionalAdditivesPerToAdd","Boolean",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","OldBalanceCaproPerToAdd","Float")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","BalanceCaproPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("dtRecipeChgReqs","Totals","Float","isnull([ActivatorPerToAdd], 0) + isnull([CatalystPerToAdd], 0) + isnull([DyePerToAdd], 0) + isnull([AdditionalPerToAdd], 0) + isnull([AdditionalAdditivesPerToAdd], 0) + isnull([BalanceCaproPerToAdd], 0)")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ShowReason","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason1","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason2","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason3","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason4","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason5","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason6","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason7","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason8","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason9","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason10","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason11","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason12","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason13","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason14","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason15","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason16","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason17","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason18","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason19","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason20","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason21","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason22","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason23","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason24","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason25","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason26","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason27","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason28","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason29","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Reason30","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Other","Boolean")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Comments","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RequestedBy","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","RequestedTimeStamp","DateTime")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Status","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ProcessedBy","String")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","ProcessedTimeStamp","DateTime")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Locked","Boolean",False)
F.Data.DataTable.AddExpressionColumn("dtRecipeChgReqs","ApproveOrRejectCheck","Boolean","[ApproveActivatorPerToAdd] or [RejectActivatorPerToAdd] or [ApproveActivatorType] or [RejectActivatorType] or [ApproveCatalystPerToAdd] or [RejectCatalystPerToAdd] or [ApprovePourTemp] or [RejectPourTemp] or [ApprovePourWeight] or [RejectPourWeight] or [ApproveDyeType] or [RejectDyeType] or [ApproveDyePerToAdd] or [RejectDyePerToAdd] or [ApproveAdditionalType] or [RejectAdditionalType] or [ApproveAdditionalPerToAdd] or [RejectAdditionalPerToAdd] or [ApproveAdditionalAdditivesType] or [RejectAdditionalAdditivesType] or [ApproveAdditionalAdditivesPerToAdd] or [RejectAdditionalAdditivesPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Job","String",False)
F.Data.DataTable.AddColumn("dtRecipeChgReqs","Suffix","String",False)
F.Data.DataView.Create("dtRecipeChgReqs","dvCurrReq")
F.Data.DataView.Create("dtRecipeChgReqs","dvCheck")
F.Data.DataView.Create("dtRecipeChgReqs","dvLocked")
Program.Sub.Preflight.End

Program.Sub.Main.Start
V.Local.sFile.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.Caller.Switches,=,"M")
	'Maintenance screen
	F.Intrinsic.Control.CallSub(GetSeason)
	F.Intrinsic.Control.SelectCase(V.Args.SeasonID)
		F.Intrinsic.Control.Case(1)
			Gui.F_Recipe_Maint.optSummer.Value(1)
		F.Intrinsic.Control.Case(3)
			Gui.F_Recipe_Maint.optWinter.Value(1)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.CallSub(LoadPartBlanks)
	
	F.Intrinsic.Control.CallSub(LoadBlanksView)
	
	F.Intrinsic.Control.CallSub(MaintenanceLoadGradeAndSize)
	
	Gui.F_Recipe_Maint..Show
F.Intrinsic.Control.ElseIf(V.Caller.Switches,=,"S")
	'Season selection screen
	F.Intrinsic.Control.CallSub(GetSeason)
	F.Intrinsic.Control.SelectCase(V.Args.SeasonID)
		F.Intrinsic.Control.Case(1)
			Gui.F_Season.optSummer.Value(1)
		F.Intrinsic.Control.Case(3)
			Gui.F_Season.optWinter.Value(1)
	F.Intrinsic.Control.EndSelect
	
	Gui.F_Season..Show
F.Intrinsic.Control.ElseIf(V.Caller.Switches,=,"A")
	'Recipe Change approval screen
	F.Intrinsic.Control.CallSub(LoadRecipeChgList)
	
	F.Intrinsic.Control.CallSub(LoadRecipeScreen)
	
	F.Intrinsic.Control.CallSub(LoadReasonApproveList)
	
	Gui.F_Approval..Show
	
	F.Intrinsic.Control.CallSub(LoadRecipeColorCoding)
F.Intrinsic.Control.ElseIf(V.Caller.Switches,=,"U")
	'Upload Recipes
	F.Intrinsic.UI.ShowOpenFileDialog("","CSV|*.csv",V.Local.sFile)
	
	F.Intrinsic.Control.If(V.Local.sFile.IsNotCancel)
		'Start Upload
		F.Intrinsic.Control.CallSub(UploadRecipes,"File",V.Local.sFile)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		'Main Recipe viewer screen
		Gui.F_Recipe_Sel.optMPU9.Value(1)
		
		F.Intrinsic.Control.CallSub(LoadRecipeScreen)
		
		Gui.F_Recipe_Sel..Show
		
		Gui.F_Recipe_Sel.txtKey.SetFocus
	F.Intrinsic.Control.Else
		'Daily emailing program
		'Process:
		'Check email table for queued emails
		'coalate by user (aka recipient)
		'combine records into one email
		'send it out
		'delete sent records
		F.Intrinsic.Control.CallSub(SendEmailQueue)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.F_Recipe_Sel_UnLoad.Start
F.Intrinsic.Control.If(V.Global.bLoadData)
	'Save serialization to file
	F.Intrinsic.Control.CallSub(Serialize)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtRecipe.Exists)
	F.Data.DataTable.Close("dtRecipe")
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtAllYearRecipe.Exists)
	F.Data.DataTable.Close("dtAllYearRecipe")
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtSummerWinterRecipe.Exists)
	F.Data.DataTable.Close("dtSummerWinterRecipe")
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtLiqActRecipe.Exists)
	F.Data.DataTable.Close("dtLiqActRecipe")
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtPartBlanks.Exists)
	F.Data.DataTable.Close("dtPartBlanks")
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.End
Program.Sub.F_Recipe_Sel_UnLoad.End

Program.Sub.F_Recipe_UnLoad.Start
F.Intrinsic.Control.CallSub(F_Recipe_Sel_UnLoad)
Program.Sub.F_Recipe_UnLoad.End

Program.Sub.F_Season_UnLoad.Start
V.Local.iRet.Declare
F.Intrinsic.Control.CallSub(GetSeason)
F.Intrinsic.Control.SelectCase(V.Args.SeasonID)
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.Control.If(V.Screen.F_Season!optSummer.Value.Not)
			'Summer is saved but not selected, ask if user wants to save
			F.Intrinsic.UI.Msgbox("Summer is the current season, would you like to save before exiting?","CLOSING RECIPE SELECTION",3,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				'Yes
				F.Intrinsic.Control.CallSub(SaveSeason,"Season","Summer","SeasonID",1)
			F.Intrinsic.Control.ElseIf(V.Local.iRet,=,2)
				'Cancel
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Case(3)
		F.Intrinsic.Control.If(V.Screen.F_Season!optWinter.Value.Not)
			'Summer is saved but not selected, ask if user wants to save
			F.Intrinsic.UI.Msgbox("Winter is the current season, would you like to save before exiting?","CLOSING RECIPE SELECTION",3,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				'Yes
				F.Intrinsic.Control.CallSub(SaveSeason,"Season","Winter","SeasonID",3)
			F.Intrinsic.Control.ElseIf(V.Local.iRet,=,2)
				'Cancel
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
Program.Sub.F_Season_UnLoad.End

Program.Sub.F_Recipe_Maint_UnLoad.Start
F.Intrinsic.Control.CallSub(F_Recipe_Sel_UnLoad)
Program.Sub.F_Recipe_Maint_UnLoad.End

Program.Sub.optWorkCenters_Click.Start
Gui.F_Recipe_Sel.txtKey.SetFocus
Program.Sub.optWorkCenters_Click.End

Program.Sub.cmdChg_Click.Start
'PLACEHOLDER
'Check current Recipe for any active changes

Gui.F_Security.txtUser.Text("")
Gui.F_Security.txtPW.Text("")
Gui.F_Recipe..Visible(False)
V.Global.bEndChg.Set(False)
Gui.F_Recipe_Chg.txtJob.Text(V.Global.sJob)
Gui.F_Recipe_Chg.txtSuf.Text(V.Global.sSuffix)
F.Intrinsic.Control.If(V.Global.bShowSecurity.Not)
	Gui.F_Security..Show
	V.Global.bShowSecurity.Set(True)
F.Intrinsic.Control.Else
	Gui.F_Security..Visible(True)
F.Intrinsic.Control.EndIf
Gui.F_Security.txtUser.SetFocus
Program.Sub.cmdChg_Click.End

Program.Sub.cmdAdd_Click.Start
V.Local.sTable.Declare
V.Local.sLATable.Declare
V.Local.sAddDateSQL.Declare
V.Local.sAddSQL.Declare
V.Local.sAllYearSQL.Declare
V.Local.sSeasonalSQL.Declare
V.Local.sLASQL.Declare
V.Local.sRet.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(GetSeason)
F.Intrinsic.Control.If(V.Args.SeasonID,=,-1)
	F.Intrinsic.UI.Msgbox("Season has not been selected. Please notify supervisor.","NO SEASON")
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf

'Build Summer/Winter Table
F.Intrinsic.Control.If(V.Args.SeasonID,=,1)
	'Between April and September
	V.Local.sTable.Set("GCG_6495_MPU9_SUMMER")
	V.Local.sLATable.Set("GCG_6495_MPU9_LA_SUMMER")
F.Intrinsic.Control.ElseIf(V.Args.SeasonID,=,3)
	'Between October and March
	V.Local.sTable.Set("GCG_6495_MPU9_WINTER")
	V.Local.sLATable.Set("GCG_6495_MPU9_LA_WINTER")
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("select max(UpdateDate) as UpdateDate, 'All Year' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_ALLYEAR group by Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd union select max(UpdateDate) as UpdateDate, 'Seasonal' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {0} group by Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd union select max(UpdateDate) as UpdateDate, 'Liquid Activator' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {1} group by Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd;",V.Local.sTable,V.Local.sLATable,V.Local.sSQL)
F.Intrinsic.String.Build("select max(UpdateDate) as UpdateDate, 'All Year' as RecipeType, Grade, Size from GCG_6495_MPU9_ALLYEAR group by Grade, Size union select max(UpdateDate) as UpdateDate, 'Seasonal' as RecipeType, Grade, Size from {0} group by Grade, Size union select max(UpdateDate) as UpdateDate, 'Liquid Activator' as RecipeType, Grade, Size from {1} group by Grade, Size;",V.Local.sTable,V.Local.sLATable,V.Local.sAddDateSQL)
F.Intrinsic.String.Build("select UpdateDate, 'All Year' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_ALLYEAR union select UpdateDate, 'Seasonal' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {0} union select UpdateDate, 'Liquid Activator' as RecipeType, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {1};",V.Local.sTable,V.Local.sLATable,V.Local.sAddSQL)

'pull up a list of the different recipes in a browser for the user to select
F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("dtAddDate","con",V.Local.sAddDateSQL)
F.Data.DataTable.CreateFromSQL("dtAdd","con",V.Local.sAddSQL)
F.ODBC.Connection!con.Close

F.Data.Linq.Join("LeftJoin","DataTable","dtAddDate*!*DATE","DataTable","dtAdd*!*RECIPE","DATE.UpdateDate = RECIPE.UpdateDate and DATE.Grade = RECIPE.Grade and DATE.Size = RECIPE.Size and DATE.RecipeType = RECIPE.RecipeType","*","","","","dtAddRecipeTemp",True)
F.Data.DataTable.Close("dtAddDate")
F.Data.DataTable.Close("dtAdd")

F.Data.DataTable.Merge("dtAddRecipeTemp","dtAddRecipe",True,2)
F.Data.DataTable.Close("dtAddRecipeTemp")

Gui.F_Recipe..Enabled(False)
F.Intrinsic.Control.If(V.Global.bShowAddRecipe)
	Gui.F_AddRecipe..Visible(True)
F.Intrinsic.Control.Else
	V.Global.bShowAddRecipe.Set(True)
	Gui.F_AddRecipe..Show
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdAdd_Click.End

Program.Sub.txtKey_Change.Start
V.Local.sKey.Declare
V.Local.sSQL.Declare
V.Local.sRet.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.Screen.F_Recipe_Sel.Visible,=,False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.sKey.Set(V.Screen.F_Recipe_Sel!txtKey.Text)
F.Intrinsic.UI.Sleep(1)
F.Intrinsic.Control.If(V.Local.sKey,<>,V.Screen.F_Recipe_Sel!txtKey.Text)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Replace(V.Local.sKey,V.Global.sBarcodeReplace,"",V.Local.sKey)

F.Global.Inventory.GetPartInfo(V.Local.sKey,"",V.Local.sRet)
F.Intrinsic.Control.If(V.Local.sRet,=,"***NOPARTFOUND***")
	'Not a Part, check jobs
	F.Intrinsic.String.Replace(V.Local.sKey,"-","",V.Local.sKey)
	F.Intrinsic.String.Build("select PART from JOB_HEADER where JOB + SUFFIX = '{0}'",V.Local.sKey,V.Local.sSQL)
	F.ODBC.Connection!con.OpenCompanyConnection
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	V.Global.sJob.Set(V.Local.sKey.Left6)
	V.Global.sSuffix.Set(V.Local.sKey.Right3)
	V.Local.sKey.Set(V.Local.sRet)
F.Intrinsic.Control.EndIf

'Use sKey to pass Part to Recipe Queuer
Gui.F_Recipe_Sel..Visible(False)
F.Intrinsic.Control.SelectCase(True)
	F.Intrinsic.Control.Case(V.Screen.F_Recipe_Sel!optMPU9.Value)
		F.Intrinsic.Control.CallSub(LoadRecipeMPU9,"Part",V.Local.sKey)
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.txtKey_Change.End

Program.Sub.LoadRecipeMPU9.Start
'V.Args.Part
V.Local.sSQLBlanks.Declare
V.Local.sSQLAllYear.Declare
V.Local.sSQLSummerWinter.Declare
V.Local.sSQLLiqAct.Declare
V.Local.sGrade.Declare
V.Local.sSize.Declare
V.Local.sTable.Declare
V.Local.sLATable.Declare
F.Intrinsic.Control.Try

F.Intrinsic.String.Build("select rtrim(Location), rtrim(Grade), rtrim(Size) from GCG_6495_PART_BLANKS where PART = '{0}'",V.Args.Part,V.Local.sSQLBlanks)
F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQLBlanks,V.Local.sSQLBlanks)

V.Global.sPart.Set(V.Args.Part)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF.Not)
	F.Intrinsic.String.Split(V.Local.sSQLBlanks,"#$#",V.Local.sSQLBlanks)
	F.Intrinsic.String.Split(V.Local.sSQLBlanks(0),"*!*",V.Local.sSQLBlanks)
	V.Global.sLoc.Set(V.Local.sSQLBlanks(0))
	V.Local.sGrade.Set(V.Local.sSQLBlanks(1))
	V.Local.sSize.Set(V.Local.sSQLBlanks(2))
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("select rtrim(Location) from V_INVENTORY_ALL where PART = '{0}'",V.Args.Part,V.Local.sSQLBlanks)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQLBlanks,V.Local.sSQLBlanks)
	F.Intrinsic.String.Split(V.Local.sSQLBlanks,"#$#",V.Local.sSQLBlanks)
	V.Global.sLoc.Set(V.Local.sSQLBlanks(0))
F.Intrinsic.Control.EndIf

'Build All Year Table
F.Intrinsic.String.Build("select top 1 UpdateDate, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_ALLYEAR where Grade = '{0}' and Size = '{1}' order by UpdateDate desc;",V.Local.sGrade,V.Local.sSize,V.Local.sSQLAllYear)

F.Intrinsic.Control.CallSub(GetSeason)
F.Intrinsic.Control.If(V.Args.SeasonID,=,-1)
	F.Intrinsic.UI.Msgbox("Season has not been selected. Please notify supervisor.","NO SEASON")
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndIf

'Build Summer/Winter Table
F.Intrinsic.Control.If(V.Args.SeasonID,=,1)
	'Between April and September
	V.Local.sTable.Set("GCG_6495_MPU9_SUMMER")
	V.Local.sLATable.Set("GCG_6495_MPU9_LA_SUMMER")
F.Intrinsic.Control.ElseIf(V.Args.SeasonID,=,3)
	'Between October and March
	V.Local.sTable.Set("GCG_6495_MPU9_WINTER")
	V.Local.sLATable.Set("GCG_6495_MPU9_LA_WINTER")
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("select top 1 UpdateDate, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {0} where Grade = '{1}' and Size = '{2}' order by UpdateDate desc;",V.Local.sTable,V.Local.sGrade,V.Local.sSize,V.Local.sSQLSummerWinter)
'Build Liquid Activator Table
F.Intrinsic.String.Build("select top 1 UpdateDate, Grade, Size, ActivatorPerToAdd, ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, DyeType, DyePerToAdd, AdditionalType, AdditionalPerToAdd, AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from {0} where Grade = '{1}' and Size = '{2}' order by UpdateDate desc;",V.Local.sLATable,V.Local.sGrade,V.Local.sSize,V.Local.sSQLLiqAct)

F.Data.DataTable.CreateFromSQL("dtAllYearRecipe","con",V.Local.sSQLAllYear,True)
F.Data.DataTable.CreateFromSQL("dtSummerWinterRecipe","con",V.Local.sSQLSummerWinter,True)
F.Data.DataTable.CreateFromSQL("dtLiqActRecipe","con",V.Local.sSQLLiqAct,True)
F.ODBC.Connection!con.Close

F.Intrinsic.Control.If(V.DataTable.dtAllYearRecipe.RowCount,>,0)
	V.Global.sRecipeType.Set("All Year")
F.Intrinsic.Control.ElseIf(V.DataTable.dtSummerWinterRecipe.RowCount,>,0)
	V.Global.sRecipeType.Set("Seasonal")
F.Intrinsic.Control.ElseIf(V.DataTable.dtLiqActRecipe.RowCount,>,0)
	V.Global.sRecipeType.Set("Liquid Activator")
F.Intrinsic.Control.EndIf

F.Data.DataTable.Merge("dtAllYearRecipe","dtRecipe",True,2)
F.Data.DataTable.Merge("dtSummerWinterRecipe","dtRecipe",True,2)
F.Data.DataTable.Merge("dtLiqActRecipe","dtRecipe",True,2)

F.Intrinsic.Control.If(V.DataTable.dtRecipe.RowCount,>,0)
	Gui.F_Recipe.cmdAdd.Enabled(False)
	Gui.F_Recipe.cmdChg.Enabled(True)
F.Intrinsic.Control.Else
	Gui.F_Recipe.cmdAdd.Enabled(True)
	Gui.F_Recipe.cmdChg.Enabled(False)
F.Intrinsic.Control.EndIf

'dont want windows to change fonts, so use Visible(True) instead of Show
Gui.F_Recipe..Visible(True)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadRecipeMPU9.End

Program.Sub.LoadRecipeScreen.Start
V.Local.sCaption.Declare
F.Intrinsic.Control.Try

Gui.F_Recipe.gsgcRecipe.AddGridviewFromDatatable("gvRecipe","dtRecipe")
Gui.F_Recipe_Chg.gsgcCurr.AddGridviewFromDatatable("gvCurr","dtRecipe")
Gui.F_Recipe_Chg.gsgcNew.AddGridviewFromDatatable("gvNew","dtRecipeChg")
Gui.F_AddRecipe.gsgcAddRecipe.AddGridviewFromDatatable("gvAddRecipe","dtAddRecipe")
Gui.F_Approval.gsgcRequests.AddGridviewFromDatatable("gvRequests","dtRecipeChgReqs")
V.Global.bLoadData.Set(True)

Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!ColumnAutoWidth,False)
Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!ColumnPanelRowHeight,98)
Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!RowAutoHeight,True)
Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!AllowColumnMoving,False)
Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!AllowColumnResizing,False)
Gui.F_Recipe.gsgcRecipe.SetGridviewProperty("gvRecipe",V.Enum.GridViewPropertyNames!Editable,False)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!ColumnAutoWidth,False)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!ColumnPanelRowHeight,98)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!RowAutoHeight,True)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!AllowColumnMoving,False)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!AllowColumnResizing,False)
Gui.F_Recipe_Chg.gsgcCurr.SetGridviewProperty("gvCurr",V.Enum.GridViewPropertyNames!Editable,False)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!ColumnAutoWidth,False)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!ColumnPanelRowHeight,98)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!RowAutoHeight,True)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!AllowColumnMoving,False)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!AllowColumnResizing,False)
Gui.F_Recipe_Chg.gsgcNew.SetGridviewProperty("gvNew",V.Enum.GridViewPropertyNames!MultiselectMode,V.Enum.MultiselectMode!CellSelect)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!ColumnAutoWidth,False)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!ColumnPanelRowHeight,98)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!RowAutoHeight,True)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!AllowColumnMoving,False)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!AllowColumnResizing,False)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!Editable,False)
Gui.F_AddRecipe.gsgcAddRecipe.SetGridviewProperty("gvAddRecipe",V.Enum.GridViewPropertyNames!Multiselect,False)
Gui.F_Approval.gsgcRequests.SetGridviewProperty("gvRequests",V.Enum.GridViewPropertyNames!ColumnAutoWidth,False)
Gui.F_Approval.gsgcRequests.SetGridviewProperty("gvRequests",V.Enum.GridViewPropertyNames!ColumnPanelRowHeight,56)
Gui.F_Approval.gsgcRequests.SetGridviewProperty("gvRequests",V.Enum.GridViewPropertyNames!AllowColumnMoving,False)
Gui.F_Approval.gsgcRequests.SetGridviewProperty("gvRequests",V.Enum.GridViewPropertyNames!Editable,False)
Gui.F_Approval.gsgcRequests.SetGridviewProperty("gvRequests",V.Enum.GridViewPropertyNames!MultiselectMode,V.Enum.MultiselectMode!CellSelect)

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","UpdateDate*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!Visible,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","UpdateDate*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!ShowInColumnChooser,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","UpdateDate*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!Visible,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","UpdateDate*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!ShowInColumnChooser,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","UpdateDate*!*RecipeTable*!*DyeType*!*ApproveDyeType*!*RejectDyeType*!*ActivatorType*!*ApproveActivatorType*!*RejectActivatorType*!*AdditionalPerToAdd*!*AdditionalType*!*ApproveAdditionalType*!*RejectAdditionalType*!*ApproveAdditionalPerToAdd*!*RejectAdditionalPerToAdd*!*AdditionalAdditivesType*!*ApproveAdditionalAdditivesType*!*RejectAdditionalAdditivesType*!*AdditionalAdditivesPerToAdd*!*ApproveAdditionalAdditivesPerToAdd*!*RejectAdditionalAdditivesPerToAdd*!*Reason1*!*Reason2*!*Reason3*!*Reason4*!*Reason5*!*Reason6*!*Reason7*!*Reason8*!*Reason9*!*Reason10*!*Reason11*!*Reason12*!*Reason13*!*Reason14*!*Reason15*!*Reason16*!*Reason17*!*Reason18*!*Reason19*!*Reason20*!*Reason21*!*Reason22*!*Reason23*!*Reason24*!*Reason25*!*Reason26*!*Reason27*!*Reason28*!*Reason29*!*Reason30*!*Other*!*Comments*!*Locked*!*ApproveOrRejectCheck","Prop",V.Enum.ColumnPropertyNames!Visible,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","UpdateDate*!*RecipeTable*!*DyeType*!*ApproveDyeType*!*RejectDyeType*!*ActivatorType*!*ApproveActivatorType*!*RejectActivatorType*!*AdditionalPerToAdd*!*AdditionalType*!*ApproveAdditionalType*!*RejectAdditionalType*!*ApproveAdditionalPerToAdd*!*RejectAdditionalPerToAdd*!*AdditionalAdditivesType*!*ApproveAdditionalAdditivesType*!*RejectAdditionalAdditivesType*!*AdditionalAdditivesPerToAdd*!*ApproveAdditionalAdditivesPerToAdd*!*RejectAdditionalAdditivesPerToAdd*!*Reason1*!*Reason2*!*Reason3*!*Reason4*!*Reason5*!*Reason6*!*Reason7*!*Reason8*!*Reason9*!*Reason10*!*Reason11*!*Reason12*!*Reason13*!*Reason14*!*Reason15*!*Reason16*!*Reason17*!*Reason18*!*Reason19*!*Reason20*!*Reason21*!*Reason22*!*Reason23*!*Reason24*!*Reason25*!*Reason26*!*Reason27*!*Reason28*!*Reason29*!*Reason30*!*Other*!*Comments*!*Locked*!*ApproveOrRejectCheck","Prop",V.Enum.ColumnPropertyNames!ShowInColumnChooser,"Val","False")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowFilter,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowFilter,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowFilter,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowFilter,"Val","False")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowSort,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowSort,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowSort,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!AllowSort,"Val","False")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderFontSize,"Val","16")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col",V.DataTable.dtRecipeChgReqs.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderWordWrap,"Val","Wrap")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellWordWrap,"Val","Wrap")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellWordWrap,"Val","Wrap")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderHAlignment,"Val","Center")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderHAlignment,"Val","Center")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderHAlignment,"Val","Center")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderHAlignment,"Val","Center")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col",V.DataTable.dtRecipeChgReqs.FieldNames,"Prop",V.Enum.ColumnPropertyNames!HeaderHAlignment,"Val","Center")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellFontSize,"Val","16")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!CellFontSize,"Val","16")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","128*!*73*!*85*!*107*!*96*!*121*!*79*!*85*!*80*!*106*!*116*!*120*!*116*!*120*!*163*!*96")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","128*!*73*!*85*!*107*!*96*!*121*!*79*!*85*!*80*!*106*!*116*!*120*!*116*!*120*!*163*!*96")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","128*!*73*!*85*!*107*!*96*!*121*!*79*!*85*!*80*!*106*!*116*!*120*!*116*!*120*!*163*!*96")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","128*!*128*!*73*!*85*!*107*!*96*!*121*!*79*!*85*!*80*!*106*!*116*!*120*!*116*!*120*!*163*!*96")
'F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col",V.DataTable.dtRecipeChgReqs.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","46*!*0*!*70*!*0*!*119*!*66*!*56*!*60*!*78*!*76*!*66*!*75*!*85*!*76*!*66*!*62*!*75*!*76*!*66*!*52*!*62*!*76*!*66*!*52*!*68*!*76*!*66*!*52*!*60*!*76*!*66*!*62*!*62*!*76*!*66*!*63*!*86*!*76*!*66*!*52*!*86*!*76*!*66*!*102*!*113*!*76*!*66*!*52*!*86*!*76*!*66*!*52*!*107*!*65*!*100*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*88*!*131*!*66*!*88*!*131")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col",V.DataTable.dtRecipeChgReqs.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Width,"Val","46*!*0*!*70*!*0*!*119*!*66*!*56*!*78*!*78*!*76*!*66*!*85*!*85*!*76*!*66*!*75*!*75*!*76*!*66*!*62*!*62*!*76*!*66*!*68*!*68*!*76*!*66*!*60*!*60*!*76*!*66*!*62*!*62*!*76*!*66*!*86*!*86*!*76*!*66*!*86*!*86*!*76*!*66*!*113*!*113*!*76*!*66*!*86*!*86*!*76*!*66*!*107*!*107*!*65*!*100*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*0*!*88*!*131*!*86*!*88*!*131*!*0*!*0*!*50*!*50")

F.Intrinsic.String.Build("Update{0}Date*!*Grade*!*Size*!*Activator{0}%*!*Activator{0}Type*!*Catalyst{0}%*!*Pour{0}Temp*!*Pour{0}Weight*!*Dye{0}Type*!*Dye{0}%*!*Main Tank{0}Additive 1{0}Type*!*Main Tank{0}Additive 1{0}%*!*Main Tank{0}Additive 2{0}Type*!*Main Tank{0}Additive 2{0}%*!*Balance Capro{0}%*!*Totals",V.Ambient.NewLine,V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Caption,"Val",V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col",V.DataTable.dtRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Caption,"Val",V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.DataTable.dtRecipeChg.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Caption,"Val",V.Local.sCaption)
F.Intrinsic.String.Build("Update{0}Date*!*Recipe Type*!*Grade*!*Size*!*Activator{0}%*!*Activator{0}Type*!*Catalyst{0}%*!*Pour{0}Temp*!*Pour{0}Weight*!*Dye{0}Type*!*Dye{0}%*!*Main Tank{0}Additive 1{0}Type*!*Main Tank{0}Additive 1{0}%*!*Main Tank{0}Additive 2{0}Type*!*Main Tank{0}Additive 2{0}%*!*Balance Capro{0}%*!*Totals",V.Ambient.NewLine,V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col",V.DataTable.dtAddRecipe.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Caption,"Val",V.Local.sCaption)
F.Intrinsic.String.Build("ID*!*Request{0}Date*!*Last{0}Update*!*Recipe{0}Table*!*Recipe{0}Type*!*Grade*!*Size*!*Old*!*Activator{0}%*!*Approve*!*Reject*!*Activator{0}Type*!*Activator{0}Type*!*Approve*!*Reject*!*Old*!*Catalyst{0}%*!*Approve*!*Reject*!*Old*!*Pour{0}Temp*!*Approve*!*Reject*!*Old*!*Pour{0}Weight*!*Approve*!*Reject*!*Dye{0}Type*!*Dye{0}Type*!*Approve*!*Reject*!*Old*!*Dye{0}%*!*Approve*!*Reject*!*Main Tank{0}Additive 1{0}Type*!*Main Tank{0}Additive 1{0}Type*!*Approve*!*Reject*!*Main Tank{0}Additive 1{0}%*!*Main Tank{0}Additive 1{0}%*!*Approve*!*Reject*!*Main Tank{0}Additive 2{0}Type*!*Main Tank{0}Additive 2{0}Type*!*Approve*!*Reject*!*Main Tank{0}Additive 2{0}%*!*Main Tank{0}Additive 2{0}%*!*Approve*!*Reject*!*Old*!*Balance Capro{0}%*!*Totals*!*ShowReason*!*1*!*2*!*3*!*4*!*5*!*6*!*7*!*8*!*9*!*10*!*11*!*12*!*13*!*14*!*15*!*16*!*17*!*18*!*19*!*20*!*21*!*22*!*23*!*24*!*25*!*26*!*27*!*28*!*29*!*30*!*Other*!*Comments*!*Requested{0}By*!*Requested{0}At*!*Status*!*Processed{0}By*!*Processed{0}At*!*Locked*!*Changed*!*Job*!*Suffix",V.Ambient.NewLine,V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col",V.DataTable.dtRecipeChgReqs.FieldNames,"Prop",V.Enum.ColumnPropertyNames!Caption,"Val",V.Local.sCaption)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","ShowReason","Prop",V.Enum.ColumnPropertyNames!ShowCaption,"Val","False")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col","UpdateDate","Prop",V.Enum.ColumnPropertyNames!DisplayCustomDateTime,"Val","d")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","UpdateDate","Prop",V.Enum.ColumnPropertyNames!DisplayCustomDateTime,"Val","d")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","UpdateDate","Prop",V.Enum.ColumnPropertyNames!DisplayCustomDateTime,"Val","d")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col","UpdateDate","Prop",V.Enum.ColumnPropertyNames!DisplayCustomDateTime,"Val","d")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","UpdateDate*!*LastDate","Prop",V.Enum.ColumnPropertyNames!DisplayCustomDateTime,"Val","d")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0.00 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col","AdditionalPerToAdd*!*AdditionalAdditivesPerToAdd*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col","PourTemp","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe,"GSGC",gsgcRecipe,"GV","gvRecipe","Col","PourWeight","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \l\b\s")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0.00 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","AdditionalPerToAdd*!*AdditionalAdditivesPerToAdd*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","PourTemp","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcCurr,"GV","gvCurr","Col","PourWeight","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \l\b\s")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0.00 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","AdditionalPerToAdd*!*AdditionalAdditivesPerToAdd*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","PourTemp","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","PourWeight","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \l\b\s")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0.00 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col","AdditionalPerToAdd*!*AdditionalAdditivesPerToAdd*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col","PourTemp","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_AddRecipe,"GSGC",gsgcAddRecipe,"GV","gvAddRecipe","Col","PourWeight","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \l\b\s")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","OldActivatorPerToAdd*!*ActivatorPerToAdd*!*OldCatalystPerToAdd*!*CatalystPerToAdd*!*OldDyePerToAdd*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0.00 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","OldAdditionalPerToAdd*!*AdditionalPerToAdd*!*OldAdditionalAdditivesPerToAdd*!*AdditionalAdditivesPerToAdd*!*OldBalanceCaproPerToAdd*!*BalanceCaproPerToAdd*!*Totals","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \%")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","OldPourTemp*!*PourTemp","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","OldPourWeight*!*PourWeight","Prop",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"Val","0 \l\b\s")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","Grade*!*Size*!*DyeType*!*ActivatorType*!*AdditionalType*!*AdditionalPerToAdd*!*AdditionalAdditivesType*!*AdditionalAdditivesPerToAdd","Prop",V.Enum.ColumnPropertyNames!AllowEdit,"Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*PourTemp*!*PourWeight*!*DyePerToAdd","Prop",V.Enum.ColumnPropertyNames!ReadOnly,"Val","False")
'F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Approval,"GSGC",gsgcRequests,"GV","gvRequests","Col","Grade*!*Size*!*DyeType*!*ActivatorPerToAdd*!*ActivatorType*!*AdditionalType*!*AdditionalPerToAdd*!*AdditionalAdditivesType*!*AdditionalAdditivesPerToAdd","Prop",V.Enum.ColumnPropertyNames!AllowEdit,"Val","False")

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*PourTemp*!*PourWeight*!*DyePerToAdd","Prop","CellBackColor","Val","LightYellow")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","ActivatorPerToAdd*!*CatalystPerToAdd*!*PourTemp*!*PourWeight*!*DyePerToAdd","Prop","CellForeColor","Val","Blue")

Gui.F_Recipe.gsgcRecipe.MainView("gvRecipe")
Gui.F_Recipe_Chg.gsgcCurr.MainView("gvCurr")
Gui.F_Recipe_Chg.gsgcNew.MainView("gvNew")
Gui.F_AddRecipe.gsgcAddRecipe.MainView("gvAddRecipe")
Gui.F_Approval.gsgcRequests.MainView("gvRequests")
F.Intrinsic.Control.CallSub(Deserialize)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadRecipeScreen.End

Program.Sub.Serialize.Start
V.Local.sSerialize.Declare
F.Intrinsic.Control.Try

'GridView - gvRecipe
Gui.F_Recipe.gsgcRecipe.Serialize("gvRecipe",V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"gvRecipe",6495,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)

'Gui.F_Approval.gsgcRequests.Serialize("gvRequests",V.Local.sSerialize)

'F.Intrinsic.File.String2File("C:\Users\bbaker\Desktop\Cast Nylons\6495\Serialize.txt",V.Local.sSerialize)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
V.Local.sSerialize.Declare
F.Intrinsic.Control.Try

'GridView - gvRecipe
F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"gvRecipe",6495,1000,6,"",V.Local.sSerialize)
F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.F_Recipe.gsgcRecipe.Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.cmdSave_Click.Start
F.Intrinsic.Control.Try

F.Data.DataView.Create("dtPartBlanks","dvSave",22,"[Modified] or [Added] or [Deleted]","")

F.Data.DataView.ToDataTable("dtPartBlanks","dvSave","dtSave")
F.Data.DataTable.RemoveColumn("dtSave","Descr")
F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.SaveToDB("dtSave","con","GCG_6495_PART_BLANKS","Part*!*Loc",256,"Part@!@PART*!*Loc@!@LOCATION*!*Grade@!@GRADE*!*Size@!@SIZE")
F.ODBC.Connection!con.Close

F.Data.DataTable.Close("dtSave")
F.Data.DataTable.SetValueFormat("dtPartBlanks",-1,"Grade","GradeRevert","")
F.Data.DataTable.SetValueFormat("dtPartBlanks",-1,"Size","SizeRevert","")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdSave_Click.End

Program.Sub.LoadPartBlanks.Start
F.Intrinsic.Control.Try

F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("dtPartBlanks","con","select rtrim(PART) as Part, rtrim(LOCATION) as Loc, PART + LOCATION as PartLoc, rtrim(Description) as Descr, '' as Grade, '' as GradeRevert, '' as Size, '' as SizeRevert from V_INVENTORY_ALL order by PART, LOCATION;",True)
F.Data.DataTable.CreateFromSQL("dtBlanks","con","select PART + LOCATION as PartLoc, rtrim(GRADE) as Grade, rtrim(SIZE) as Size from GCG_6495_PART_BLANKS")
F.ODBC.Connection!con.Close

F.Data.Dictionary.CreateFromDataTable("dGrade","dtBlanks","PartLoc","Grade")
F.Data.Dictionary.CreateFromDataTable("dSize","dtBlanks","PartLoc","Size")
F.Data.DataTable.Close("dtBlanks")

F.Data.Dictionary.SetDefaultReturn("dGrade","")
F.Data.Dictionary.SetDefaultReturn("dSize","")
F.Data.DataTable.FillFromDictionary("dtPartBlanks","dGrade","PartLoc","Grade")
F.Data.DataTable.FillFromDictionary("dtPartBlanks","dGrade","PartLoc","GradeRevert")
F.Data.DataTable.FillFromDictionary("dtPartBlanks","dSize","PartLoc","Size")
F.Data.DataTable.FillFromDictionary("dtPartBlanks","dSize","PartLoc","SizeRevert")
F.Data.Dictionary.Close("dGrade")
F.Data.Dictionary.Close("dSize")

F.Data.DataTable.AddExpressionColumn("dtPartBlanks","Modified","Boolean","(trim([Grade]) <> trim([GradeRevert]) or trim([Size]) <> trim([SizeRevert])) and trim([SizeRevert]) <> '' and trim([GradeRevert]) <> ''")
F.Data.DataTable.AddExpressionColumn("dtPartBlanks","Added","Boolean","(trim([Grade]) <> trim([GradeRevert]) or trim([Size]) <> trim([SizeRevert])) and trim([SizeRevert]) = '' and trim([GradeRevert]) = ''")
F.Data.DataTable.AddExpressionColumn("dtPartBlanks","Deleted","Boolean","(trim([Grade]) <> trim([GradeRevert]) or trim([Size]) <> trim([SizeRevert])) and trim([Grade]) = '' and trim([Size]) = ''")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadPartBlanks.End

Program.Sub.LoadBlanksView.Start
V.Local.sCaption.Declare
V.Local.iVisibleIndex.Declare
F.Intrinsic.Control.Try

F.Intrinsic.String.Build("Update{0}Selected",V.Ambient.NewLine,V.Local.sCaption)
Gui.F_Recipe_Maint.cmdUpdate.Caption(V.Local.sCaption)
F.Intrinsic.String.Build("Clear{0}Selected",V.Ambient.NewLine,V.Local.sCaption)
Gui.F_Recipe_Maint.cmdClear.Caption(V.Local.sCaption)
F.Intrinsic.String.Build("Edit Notif.{0}Email",V.Ambient.NewLine,V.Local.sCaption)
Gui.F_Recipe_Maint.cmdEditEmail.Caption(V.Local.sCaption)

Gui.F_Recipe_Maint.gsgcBlanks.AddGridviewFromDataTable("gvBlanks","dtPartBlanks")

Gui.F_Recipe_Maint.gsgcBlanks.SetGridviewProperty("gvBlanks","MultiSelectMode",2)
Gui.F_Recipe_Maint.gsgcBlanks.SetGridviewProperty("gvBlanks","Editable",False)
Gui.F_Recipe_Maint.gsgcBlanks.SetGridviewProperty("gvBlanks","OptionsViewColumnAutoWidth",False)

F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Maint,"GSGC",gsgcBlanks,"GV","gvBlanks","Col","PartLoc*!*GradeRevert*!*SizeRevert*!*Modified*!*Added*!*Deleted","Prop","Visible","Val","False")
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Maint,"GSGC",gsgcBlanks,"GV","gvBlanks","Col","PartLoc*!*GradeRevert*!*SizeRevert*!*Modified*!*Added*!*Deleted","Prop","AllowShowHide","Val","False")

'i have no idea why but the Part column is never where i want it unless if I increase the visible index to start at a higher number
'F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Maint,"GSGC",gsgcBlanks,"GV","gvBlanks","Col","Part*!*Loc*!*Descr*!*Grade*!*Size","Prop","VisibleIndex","Val","-1")
V.Local.iVisibleIndex.Set(3)
Gui.F_Recipe_Maint.gsgcBlanks.SetColumnProperty("gvBlanks","Part","VisibleIndex",V.Local.iVisibleIndex.++)
Gui.F_Recipe_Maint.gsgcBlanks.SetColumnProperty("gvBlanks","Loc","VisibleIndex",V.Local.iVisibleIndex.++)
Gui.F_Recipe_Maint.gsgcBlanks.SetColumnProperty("gvBlanks","Descr","VisibleIndex",V.Local.iVisibleIndex.++)
Gui.F_Recipe_Maint.gsgcBlanks.SetColumnProperty("gvBlanks","Grade","VisibleIndex",V.Local.iVisibleIndex.++)
Gui.F_Recipe_Maint.gsgcBlanks.SetColumnProperty("gvBlanks","Size","VisibleIndex",V.Local.iVisibleIndex.++)

Gui.F_Recipe_Maint.gsgcBlanks.AddStyleFormatCondition("gvBlanks","Modified","RowModified","Equal",True)
Gui.F_Recipe_Maint.gsgcBlanks.AddStyleFormatCondition("gvBlanks","Added","RowAdded","Equal",True)
Gui.F_Recipe_Maint.gsgcBlanks.AddStyleFormatCondition("gvBlanks","Deleted","RowDeleted","Equal",True)
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Modified","RowModified","BackColor","LightYellow")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Modified","RowModified","ForeColor","Black")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Modified","RowModified","ApplyToRow",True)
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Added","RowAdded","BackColor","LightGreen")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Added","RowAdded","ForeColor","Black")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Added","RowAdded","ApplyToRow",True)
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Deleted","RowDeleted","BackColor","Pink")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Deleted","RowDeleted","ForeColor","Black")
Gui.F_Recipe_Maint.gsgcBlanks.SetStyleFormatConditionProperty("gvBlanks","Deleted","RowDeleted","ApplyToRow",True)

Gui.F_Recipe_Maint.gsgcBlanks.MainView("gvBlanks")
Gui.F_Recipe_Maint.gsgcBlanks.BestFitColumns("gvBlanks")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadBlanksView.End

Program.Sub.optSeason_Click.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(GetSeason)
F.Intrinsic.Control.SelectCase(V.Args.SeasonID)
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.Control.If(V.Args.ControlName,<>,"OPTSUMMER")
			Gui.F_Season.cmdSeasonSave.FontStyle(True,True,False,False)
		F.Intrinsic.Control.Else
			Gui.F_Season.cmdSeasonSave.FontStyle(False,False,False,False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Case(3)
		F.Intrinsic.Control.If(V.Args.ControlName,<>,"OPTWINTER")
			Gui.F_Season.cmdSeasonSave.FontStyle(True,True,False,False)
		F.Intrinsic.Control.Else
			Gui.F_Season.cmdSeasonSave.FontStyle(False,False,False,False)
		F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.optSeason_Click.End

Program.Sub.GetSeason.Start
V.Local.iSeason.Declare
F.Intrinsic.Control.Try

F.Global.Registry.ReadValue(-1,V.Caller.CompanyCode,"Recipe Season",6495,1000,1,-1,V.Local.iSeason)
F.Intrinsic.Variable.AddRV("SeasonID",V.Local.iSeason)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.GetSeason.End

Program.Sub.cmdExport_Click.Start
V.Local.sFile.Declare
F.Intrinsic.Control.Try

F.Intrinsic.UI.ShowSaveFileDialog("export.csv","Comma Separated Variable Format|*.csv",V.Local.sFile)
F.Intrinsic.Control.If(V.Local.sFile.IsNotCancel)
	Gui.F_Recipe_Maint.gsgcBlanks.Export(V.Local.sFile,"csv")
	F.Intrinsic.Task.ShellExec(0,"",V.Local.sFile,"","",0)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdExport_Click.End

Program.Sub.cmdImport_Click.Start
V.Local.sFile.Declare
V.Local.sData.Declare
V.Local.sRow.Declare
V.Local.sPart.Declare
V.Local.sLoc.Declare
V.Local.sGrade.Declare
V.Local.sSize.Declare
V.Local.sFilter.Declare
V.Local.iPartIndex.Declare
V.Local.iLocIndex.Declare
V.Local.iGradeIndex.Declare
V.Local.iSizeIndex.Declare
V.Local.iRow.Declare
F.Intrinsic.Control.Try

'Read in CSV file and overwrite values
F.Intrinsic.UI.ShowOpenFileDialog("","Comma Separated Variable Format|*.csv",V.Local.sFile)
F.Intrinsic.Control.If(V.Local.sFile.IsNotCancel)
	Gui.F_Recipe_Maint..Visible(False)
	F.Intrinsic.UI.InvokeWaitDialog("Importing Data...")
	V.Local.iPartIndex.Set(-1)
	V.Local.iLocIndex.Set(-1)
	V.Local.iGradeIndex.Set(-1)
	V.Local.iSizeIndex.Set(-1)
	F.Data.DataView.Create("dtPartBlanks","dvImport")
	F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sData)
	F.Intrinsic.String.Split(V.Local.sData,V.Ambient.NewLine,V.Local.sData)
	F.Intrinsic.String.Split(V.Local.sData(0),",",V.Local.sRow)
	F.Intrinsic.Control.For(V.Local.iRow,0,V.Local.sRow.UBound,1)
		F.Intrinsic.Control.SelectCase(V.Local.sRow(V.Local.iRow).UCase)
			F.Intrinsic.Control.Case("PART")
				V.Local.iPartIndex.Set(V.Local.iRow)
			F.Intrinsic.Control.Case("LOC")
				V.Local.iLocIndex.Set(V.Local.iRow)
			F.Intrinsic.Control.Case("GRADE")
				V.Local.iGradeIndex.Set(V.Local.iRow)
			F.Intrinsic.Control.Case("SIZE")
				V.Local.iSizeIndex.Set(V.Local.iRow)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.iRow)
	F.Intrinsic.Control.For(V.Local.iRow,1,V.Local.sData.UBound,1)
		F.Intrinsic.UI.ChangeWaitStatus("Importing Data...",V.Local.iRow,0,V.Local.sData.UBound)
		V.Local.sPart.Set("")
		V.Local.sLoc.Set("")
		V.Local.sGrade.Set("")
		V.Local.sSize.Set("")
		F.Intrinsic.String.Split(V.Local.sData(V.Local.iRow),",",V.Local.sRow)
		F.Intrinsic.Control.If(V.Local.iPartIndex,!=,-1)
			V.Local.sPart.Set(V.Local.sRow(V.Local.iPartIndex))
		F.Intrinsic.Control.Else
			V.Local.sPart.Set("")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.iLocIndex,!=,-1)
			V.Local.sLoc.Set(V.Local.sRow(V.Local.iLocIndex))
		F.Intrinsic.Control.Else
			V.Local.sLoc.Set("")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.iGradeIndex,!=,-1)
			V.Local.sGrade.Set(V.Local.sRow(V.Local.iGradeIndex))
		F.Intrinsic.Control.Else
			V.Local.sGrade.Set("***SKIP***")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.iSizeIndex,!=,-1)
			V.Local.sSize.Set(V.Local.sRow(V.Local.iSizeIndex))
		F.Intrinsic.Control.Else
			V.Local.sSize.Set("***SKIP***")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("[Part] = '{0}' and [Loc] = '{1}'",V.Local.sPart.PSQLFriendly,V.Local.sLoc.PSQLFriendly,V.Local.sFilter)
		F.Data.DataView.SetFilter("dtPartBlanks","dvImport",V.Local.sFilter)
		F.Intrinsic.Control.If(V.Local.sGrade,!=,"***SKIP***")
			F.Data.DataView.SetValue("dtPartBlanks","dvImport",-1,"Grade",V.Local.sGrade)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.sSize,!=,"***SKIP***")
			F.Data.DataView.SetValue("dtPartBlanks","dvImport",-1,"Size",V.Local.sSize)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iRow)
	F.Data.DataView.Close("dtPartBlanks","dvImport")
	F.Intrinsic.UI.CloseWaitDialog
	Gui.F_Recipe_Maint..Visible(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdImport_Click.End

Program.Sub.MaintenanceLoadGradeAndSize.Start
F.Intrinsic.Control.Try

F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("dtAllYearKeys","con","select distinct Grade, Size from GCG_6495_MPU9_ALLYEAR;",True)
F.Data.DataTable.CreateFromSQL("dtSummerKeys","con","select distinct Grade, Size from GCG_6495_MPU9_SUMMER;",True)
F.Data.DataTable.CreateFromSQL("dtWinterKeys","con","select distinct Grade, Size from GCG_6495_MPU9_WINTER;",True)
F.Data.DataTable.CreateFromSQL("dtLASummerKeys","con","select distinct Grade, Size from GCG_6495_MPU9_LA_SUMMER;",True)
F.Data.DataTable.CreateFromSQL("dtLAWinterKeys","con","select distinct Grade, Size from GCG_6495_MPU9_LA_WINTER;",True)
F.ODBC.Connection!con.Close

F.Data.DataTable.Merge("dtSummerKeys","dtAllYearKeys",True,2)
F.Data.DataTable.Merge("dtWinterKeys","dtAllYearKeys",True,2)
F.Data.DataTable.Merge("dtLASummerKeys","dtAllYearKeys",True,2)
F.Data.DataTable.Merge("dtLAWinterKeys","dtAllYearKeys",True,2)

F.Data.DataView.Create("dtAllYearKeys","dvDistinct")
F.Data.DataView.ToDataTableDistinct("dtAllYearKeys","dvDistinct","dtGrades","Grade")
F.Data.DataView.ToDataTableDistinct("dtAllYearKeys","dvDistinct","dtSizes","Size")

F.Data.DataTable.Close("dtAllYearKeys")
F.Data.DataTable.Close("dtSummerKeys")
F.Data.DataTable.Close("dtWinterKeys")
F.Data.DataTable.Close("dtLASummerKeys")
F.Data.DataTable.Close("dtLAWinterKeys")

Gui.F_Recipe_Maint.ddlGrade.AddItems("DataTable","dtGrades","Grade","Grade")
Gui.F_Recipe_Maint.ddlSize.AddItems("DataTable","dtSizes","Size","Size")

F.Data.DataTable.Close("dtGrades")
F.Data.DataTable.Close("dtSizes")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.MaintenanceLoadGradeAndSize.End

Program.Sub.cmdSelect_Click.Start
V.Local.sSelect.Declare
F.Intrinsic.Control.Try

Gui.F_AddRecipe.gsgcAddRecipe.GetSelectedRows("gvAddRecipe",V.Local.sSelect)

F.Intrinsic.Control.If(V.Local.sSelect,<>,"")
	Gui.F_AddRecipe..Visible(False)
	'merge information into recipe table and update the DB
	F.Data.DataTable.AddRow("dtRecipe","UpdateDate",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).UpdateDate!FieldVal,"Grade",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).Grade!FieldVal,"Size",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).Size!FieldVal,"ActivatorPerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).ActivatorPerToAdd!FieldVal,"ActivatorType",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).ActivatorType!FieldVal,"CatalystPerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).CatalystPerToAdd!FieldVal,"PourTemp",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).PourTemp!FieldVal,"PourWeight",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).PourWeight!FieldVal,"DyeType",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).DyeType!FieldVal,"DyePerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).DyePerToAdd!FieldVal,"AdditionalType",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).AdditionalType!FieldVal,"AdditionalPerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).AdditionalPerToAdd!FieldVal,"AdditionalAdditivesType",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).AdditionalAdditivesType!FieldVal,"AdditionalAdditivesPerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).AdditionalAdditivesPerToAdd!FieldVal,"BalanceCaproPerToAdd",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).BalanceCaproPerToAdd!FieldVal)
	V.Global.sRecipeType.Set(V.DataTable.dtAddRecipe(V.Local.sSelect.Long).RecipeType!FieldVal)
	F.Data.DataTable.Create("dtSave",False)
	F.Data.DataTable.AddColumn("dtSave","Part","String")
	F.Data.DataTable.AddColumn("dtSave","Location","String")
	F.Data.DataTable.AddColumn("dtSave","Grade","String")
	F.Data.DataTable.AddColumn("dtSave","Size","String")
	F.Data.DataTable.AddRow("dtSave","Part",V.Global.sPart,"Location",V.Global.sLoc,"Grade",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).Grade!FieldVal,"Size",V.DataTable.dtAddRecipe(V.Local.sSelect.Long).Size!FieldVal)
	F.ODBC.Connection!con.OpenCompanyConnection
	F.Data.DataTable.SaveToDB("dtSave","con","GCG_6495_PART_BLANKS","Part*!*Location",256)
	F.ODBC.Connection!con.Close
	F.Data.DataTable.Close("dtSave")
	Gui.F_Recipe.cmdAdd.Enabled(False)
	Gui.F_Recipe.cmdChg.Enabled(True)
	F.Data.DataTable.DeleteRow("dtAddRecipe")
	F.Data.DataTable.AcceptChanges("dtAddRecipe")
	Gui.F_Recipe..Enabled(True)
	Gui.F_Recipe..SetFocus
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdSelect_Click.End

Program.Sub.cmdCancel_Click.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.SelectCase(V.Args.Screen.UCase)
	F.Intrinsic.Control.Case("F_ADDRECIPE")
		Gui.F_AddRecipe..Visible(False)
		F.Data.DataTable.DeleteRow("dtAddRecipe")
		F.Data.DataTable.AcceptChanges("dtAddRecipe")
		Gui.F_Recipe..Enabled(True)
		Gui.F_Recipe..SetFocus
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdCancel_Click.End

Program.Sub.cmdUpdate_Click.Start
V.Local.sSelect.Declare
V.Local.iCnt.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.Screen.F_Recipe_Maint!ddlGrade.Text,=,"")
	Gui.F_Recipe_Maint.ddlGrade.SetFocus
F.Intrinsic.Control.ElseIf(V.Screen.F_Recipe_Maint!ddlSize.Text,=,"")
	Gui.F_Recipe_Maint.ddlSize.SetFocus
F.Intrinsic.Control.Else
	Gui.F_Recipe_Maint.gsgcBlanks.GetSelectedRows("gvBlanks",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			F.Data.DataTable.SetValue("dtPartBlanks",V.Local.sSelect(V.Local.iCnt).Long,"Grade",V.Screen.F_Recipe_Maint!ddlGrade.Text,"Size",V.Screen.F_Recipe_Maint!ddlSize.Text)
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdUpdate_Click.End

Program.Sub.cmdClear_Click.Start
V.Local.sSelect.Declare
V.Local.iCnt.Declare
F.Intrinsic.Control.Try

Gui.F_Recipe_Maint.gsgcBlanks.GetSelectedRows("gvBlanks",V.Local.sSelect)
F.Intrinsic.Control.If(V.Local.sSelect,<>,"")
	F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
		F.Data.DataTable.SetValue("dtPartBlanks",V.Local.sSelect(V.Local.iCnt).Long,"Grade","","Size","")
	F.Intrinsic.Control.Next(V.Local.iCnt)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdClear_Click.End

Program.Sub.F_Recipe_Chg_UnLoad.Start
V.Local.iRet.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.Global.bEndChg.Not)
F.Intrinsic.Control.AndIf(V.DataTable.dtRecipe(0).ActivatorPerToAdd!FieldVal,<>,V.DataTable.dtRecipeChg(0).ActivatorPerToAdd!FieldVal,or,V.DataTable.dtRecipe(0).ActivatorType!FieldVal,<>,V.DataTable.dtRecipeChg(0).ActivatorType!FieldVal,V.DataTable.dtRecipe(0).CatalystPerToAdd!FieldVal,<>,V.DataTable.dtRecipeChg(0).CatalystPerToAdd!FieldVal,V.DataTable.dtRecipe(0).PourTemp!FieldVal,<>,V.DataTable.dtRecipeChg(0).PourTemp!FieldVal,V.DataTable.dtRecipe(0).PourWeight!FieldVal,<>,V.DataTable.dtRecipeChg(0).PourWeight!FieldVal,V.DataTable.dtRecipe(0).DyeType!FieldValTrim,<>,V.DataTable.dtRecipeChg(0).DyeType!FieldValTrim,V.DataTable.dtRecipe(0).DyePerToAdd!FieldVal,<>,V.DataTable.dtRecipeChg(0).DyePerToAdd!FieldVal,V.DataTable.dtRecipe(0).AdditionalType!FieldValTrim,<>,V.DataTable.dtRecipeChg(0).AdditionalType!FieldValTrim,V.DataTable.dtRecipe(0).AdditionalPerToAdd!FieldVal,<>,V.DataTable.dtRecipeChg(0).AdditionalPerToAdd!FieldVal,V.DataTable.dtRecipe(0).AdditionalAdditivesType!FieldValTrim,<>,V.DataTable.dtRecipeChg(0).AdditionalAdditivesType!FieldVal,V.DataTable.dtRecipe(0).AdditionalAdditivesPerToAdd!FieldVal,<>,V.DataTable.dtRecipeChg(0).AdditionalAdditivesPerToAdd!FieldVal)
	F.Intrinsic.UI.Msgbox("Any unrequested changes will be lost. Do you want to continue?","EXITING RECIPE CHANGE REQUEST",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,7)
		'No
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.F_Recipe_Chg..Visible(False)
Gui.F_Recipe..Visible(True)
Gui.F_Recipe..SetFocus

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.F_Recipe_Chg_UnLoad.End

Program.Sub.cmdCommit_Click.Start
F.Intrinsic.Control.Try

'Check for changes
F.Intrinsic.Control.If(V.DataTable.dtRecipe(0).ActivatorPerToAdd!FieldVal,=,V.DataTable.dtRecipeChg(0).ActivatorPerToAdd!FieldVal,and,V.DataTable.dtRecipe(0).ActivatorType!FieldVal,=,V.DataTable.dtRecipeChg(0).ActivatorType!FieldVal,V.DataTable.dtRecipe(0).CatalystPerToAdd!FieldVal,=,V.DataTable.dtRecipeChg(0).CatalystPerToAdd!FieldVal,V.DataTable.dtRecipe(0).PourTemp!FieldVal,=,V.DataTable.dtRecipeChg(0).PourTemp!FieldVal,V.DataTable.dtRecipe(0).PourWeight!FieldVal,=,V.DataTable.dtRecipeChg(0).PourWeight!FieldVal,V.DataTable.dtRecipe(0).DyeType!FieldValTrim,=,V.DataTable.dtRecipeChg(0).DyeType!FieldValTrim,V.DataTable.dtRecipe(0).DyePerToAdd!FieldVal,=,V.DataTable.dtRecipeChg(0).DyePerToAdd!FieldVal,V.DataTable.dtRecipe(0).AdditionalType!FieldValTrim,=,V.DataTable.dtRecipeChg(0).AdditionalType!FieldValTrim,V.DataTable.dtRecipe(0).AdditionalPerToAdd!FieldVal,=,V.DataTable.dtRecipeChg(0).AdditionalPerToAdd!FieldVal,V.DataTable.dtRecipe(0).AdditionalAdditivesType!FieldValTrim,=,V.DataTable.dtRecipeChg(0).AdditionalAdditivesType!FieldVal,V.DataTable.dtRecipe(0).AdditionalAdditivesPerToAdd!FieldVal,=,V.DataTable.dtRecipeChg(0).AdditionalAdditivesPerToAdd!FieldVal)
	'No changes found, let user know and exit
	F.Intrinsic.UI.Msgbox("No changes to recipe detected.","CANCELLING REQUEST")
	Gui.F_Recipe_Chg.gsgcNew.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'Check reasons
F.Intrinsic.Control.If(V.Screen.F_Recipe_Chg!chkReason1.CheckedAsBoolean,=,False,and,V.Screen.F_Recipe_Chg!chkReason2.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason3.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason4.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason4.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason5.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason6.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason7.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason8.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason9.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason10.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason11.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason12.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason13.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason14.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason15.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason16.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason17.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason18.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason19.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason20.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason21.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason22.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason23.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason24.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason25.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason26.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason27.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason28.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason29.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkReason30.CheckedAsBoolean,=,False,V.Screen.F_Recipe_Chg!chkOther.CheckedAsBoolean,=,False)
	'No reason selected, let user know and exit
	F.Intrinsic.UI.Msgbox("No reason selected. At least one reason must be selected to request a change. If 'Other' is checked, something must be entered into the 'Comments'.","CANCELLING REQUEST")
	Gui.F_Recipe_Chg.txtComments.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'Check 'Other'
F.Intrinsic.Control.If(V.Screen.F_Recipe_Chg!chkOther.CheckedAsBoolean,=,True,and,V.Screen.F_Recipe_Chg!txtComments.Text.Trim,=,"")
	'Comments are blank and 'Other' is selected
	F.Intrinsic.UI.Msgbox("If 'Other' is checked, something must be entered into the 'Comments'.","CANCELLING REQUEST")
	Gui.F_Recipe_Chg.txtComments.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'We are now ready to save and email!
F.Data.DataTable.Create("dtSave",False)
F.Data.DataTable.AddColumn("dtSave","Grade","String")
F.Data.DataTable.AddColumn("dtSave","Size","String")
F.Data.DataTable.AddColumn("dtSave","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("dtSave","ActivatorType","String")
F.Data.DataTable.AddColumn("dtSave","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("dtSave","PourTemp","Long")
F.Data.DataTable.AddColumn("dtSave","PourWeight","Long")
F.Data.DataTable.AddColumn("dtSave","DyeType","String")
F.Data.DataTable.AddColumn("dtSave","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("dtSave","AdditionalType","String")
F.Data.DataTable.AddColumn("dtSave","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("dtSave","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("dtSave","AdditionalAdditivesPerToAdd","Float")

F.Data.DataTable.Merge("dtRecipeChg","dtSave",True,2)
F.Data.DataTable.AddColumn("dtSave","UpdateDate","Date",V.Ambient.Date)
F.Data.DataTable.AddColumn("dtSave","Reason1","Boolean",V.Screen.F_Recipe_Chg!chkReason1.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason2","Boolean",V.Screen.F_Recipe_Chg!chkReason2.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason3","Boolean",V.Screen.F_Recipe_Chg!chkReason3.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason4","Boolean",V.Screen.F_Recipe_Chg!chkReason4.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason5","Boolean",V.Screen.F_Recipe_Chg!chkReason5.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason6","Boolean",V.Screen.F_Recipe_Chg!chkReason6.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason7","Boolean",V.Screen.F_Recipe_Chg!chkReason7.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason8","Boolean",V.Screen.F_Recipe_Chg!chkReason8.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason9","Boolean",V.Screen.F_Recipe_Chg!chkReason9.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason10","Boolean",V.Screen.F_Recipe_Chg!chkReason10.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason11","Boolean",V.Screen.F_Recipe_Chg!chkReason11.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason12","Boolean",V.Screen.F_Recipe_Chg!chkReason12.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason13","Boolean",V.Screen.F_Recipe_Chg!chkReason13.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason14","Boolean",V.Screen.F_Recipe_Chg!chkReason14.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason15","Boolean",V.Screen.F_Recipe_Chg!chkReason15.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason16","Boolean",V.Screen.F_Recipe_Chg!chkReason16.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason17","Boolean",V.Screen.F_Recipe_Chg!chkReason17.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason18","Boolean",V.Screen.F_Recipe_Chg!chkReason18.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason19","Boolean",V.Screen.F_Recipe_Chg!chkReason19.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason20","Boolean",V.Screen.F_Recipe_Chg!chkReason20.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason21","Boolean",V.Screen.F_Recipe_Chg!chkReason21.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason22","Boolean",V.Screen.F_Recipe_Chg!chkReason22.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason23","Boolean",V.Screen.F_Recipe_Chg!chkReason23.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason24","Boolean",V.Screen.F_Recipe_Chg!chkReason24.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason25","Boolean",V.Screen.F_Recipe_Chg!chkReason25.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason26","Boolean",V.Screen.F_Recipe_Chg!chkReason26.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason27","Boolean",V.Screen.F_Recipe_Chg!chkReason27.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason28","Boolean",V.Screen.F_Recipe_Chg!chkReason28.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason29","Boolean",V.Screen.F_Recipe_Chg!chkReason29.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Reason30","Boolean",V.Screen.F_Recipe_Chg!chkReason30.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Other","Boolean",V.Screen.F_Recipe_Chg!chkOther.CheckedAsBoolean)
F.Data.DataTable.AddColumn("dtSave","Comments","String",V.Screen.F_Recipe_Chg!txtComments.Text.Trim)
F.Data.DataTable.AddColumn("dtSave","RequestedBy","String",V.Screen.F_Security!txtUser.Text.UCase)
F.Data.DataTable.AddColumn("dtSave","ProcessedBy","String")
F.Data.DataTable.AddColumn("dtSave","RequestedTimeStamp","DateTime",V.Ambient.Now)
F.Data.DataTable.AddColumn("dtSave","ProcessedTimeStamp","DateTime")
F.Data.DataTable.AddColumn("dtSave","Job","String",V.Screen.F_Recipe_Chg!txtJob.Text)
F.Data.DataTable.AddColumn("dtSave","Suffix","String",V.Screen.F_Recipe_Chg!txtSuf.Text)
F.Data.DataTable.AddExpressionColumn("dtSave","BalanceCaproPerToAdd","Float","100 - [ActivatorPerToAdd] - [CatalystPerToAdd] - [DyePerToAdd] - [AdditionalPerToAdd] - [AdditionalAdditivesPerToAdd]")
F.Data.DataTable.AddColumn("dtSave","Status","String","In Process")

F.Intrinsic.Control.If(V.Global.sRecipeType,=,"All Year")
	F.Data.DataTable.AddColumn("dtSave","RecipeTable","String","GCG_6495_MPU9_ALLYEAR")
F.Intrinsic.Control.ElseIf(V.Global.sRecipeType,=,"Seasonal",or,V.Global.sRecipeType,=,"Liquid Activator")
	F.Intrinsic.Control.CallSub(GetSeason)
	F.Intrinsic.Control.SelectCase(V.Args.SeasonID)
		F.Intrinsic.Control.Case(1)
			'Summer table
			F.Intrinsic.Control.If(V.Global.sRecipeType,=,"Seasonal")
				F.Data.DataTable.AddColumn("dtSave","RecipeTable","String","GCG_6495_MPU9_SUMMER")
			F.Intrinsic.Control.ElseIf(V.Global.sRecipeType,=,"Liquid Activator")
				F.Data.DataTable.AddColumn("dtSave","RecipeTable","String","GCG_6495_MPU9_LA_SUMMER")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Case(3)
			'Winter table
			F.Intrinsic.Control.If(V.Global.sRecipeType,=,"Seasonal")
				F.Data.DataTable.AddColumn("dtSave","RecipeTable","String","GCG_6495_MPU9_WINTER")
			F.Intrinsic.Control.ElseIf(V.Global.sRecipeType,=,"Liquid Activator")
				F.Data.DataTable.AddColumn("dtSave","RecipeTable","String","GCG_6495_MPU9_LA_WINTER")
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.EndIf

F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.SaveToDB("dtSave","con","GCG_6495_RECIPE_CHG","",128)
F.ODBC.Connection!con.Close

F.Data.DataTable.Close("dtSave")

'Send email
F.Intrinsic.Control.CallSub(SendEmail)

F.Intrinsic.Control.SelectCase(V.Args.Status)
	F.Intrinsic.Control.Case(0)
		F.Intrinsic.UI.Msgbox("Changes submitted successfully.","STATUS")
	F.Intrinsic.Control.Case(1)
		F.Intrinsic.UI.Msgbox("Changes submitted successfully, but notification could not be sent due to improper formatting of template. Please notify your database administrator.","STATUS")
	F.Intrinsic.Control.Case(2)
		F.Intrinsic.UI.Msgbox("Changes submitted successfully, but notification could not be sent due to invalid notification email address. Please notify your database administrator.","STATUS")
F.Intrinsic.Control.EndSelect

V.Global.bEndChg.Set(True)
F.Intrinsic.Control.CallSub(F_Recipe_Chg_UnLoad)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdCommit_Click.End

Program.Sub.SetColumnProperty.Start
'V.Args.Form, V.Args.GSGC, V.Args.GV, V.Args.Col, V.Args.Prop, V.Args.Val
V.Local.sCol.Declare
V.Local.sVal.Declare
V.Local.iCnt.Declare
V.Local.iVisibleIndex.Declare
F.Intrinsic.Control.Try

F.Intrinsic.String.Split(V.Args.Col,"*!*",V.Local.sCol)
F.Intrinsic.String.Split(V.Args.Val,"*!*",V.Local.sVal)
V.Local.iVisibleIndex.Set(-1)
F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sCol.UBound,1)
	F.Intrinsic.Control.If(V.Local.sCol.UBound,=,V.Local.sVal.UBound)
		Gui.[V.Args.Form].[V.Args.GSGC].SetColumnProperty(V.Args.GV,V.Local.sCol(V.Local.iCnt),V.Args.Prop,V.Local.sVal(V.Local.iCnt))
	F.Intrinsic.Control.ElseIf(V.Args.Prop.UCase,=,"VISIBLEINDEX")
		Gui.[V.Args.Form].[V.Args.GSGC].SetColumnProperty(V.Args.GV,V.Local.sCol(V.Local.iCnt),V.Args.Prop,V.Local.iVisibleIndex.++)
	F.Intrinsic.Control.Else
		Gui.[V.Args.Form].[V.Args.GSGC].SetColumnProperty(V.Args.GV,V.Local.sCol(V.Local.iCnt),V.Args.Prop,V.Local.sVal)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCnt)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.SetColumnProperty.End

Program.Sub.gsgcNew_CellValueChanged.Start
V.Local.fValue.Declare
V.Local.fTotal.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.Args.Value.String,=,"")
	'Null, need to fix this or a crash is gonna happen
	V.Local.fValue.Set(0)
F.Intrinsic.Control.ElseIf(V.Args.Value.IsNumeric)
	V.Local.fValue.Set(V.Args.Value)
F.Intrinsic.Control.EndIf

'Lots of checks and balances based on column, i tried grouping them up by number type, but for calculations, I need to know which field was read in so I don't accidentally round a field incorrectly
F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.CaseAny("ACTIVATORPERTOADD","CATALYSTPERTOADD","DYEPERTOADD","ADDITIONALPERTOADD","ADDITIONALADDITIVESPERTOADD")
		'For these, Min:0, Max:999.99 but they all have to add up to Max:100, if the total is under 100, no action will be taken
		F.Intrinsic.Control.If(V.Local.fValue,<,0)
			V.Local.fValue.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Format(V.Local.fValue,"0.00",V.Local.fValue)
		F.Intrinsic.Control.If(V.Local.fValue,>=,1000)
			V.Local.fValue.Set(999.99)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Local.fValue)
		F.Intrinsic.Math.Add(V.DataTable.dtRecipeChg(V.Args.RowIndex).ActivatorPerToAdd!FieldVal,V.DataTable.dtRecipeChg(V.Args.RowIndex).CatalystPerToAdd!FieldVal,V.DataTable.dtRecipeChg(V.Args.RowIndex).DyePerToAdd!FieldVal,V.DataTable.dtRecipeChg(V.Args.RowIndex).AdditionalPerToAdd!FieldVal,V.DataTable.dtRecipeChg(V.Args.RowIndex).AdditionalAdditivesPerToAdd!FieldVal,V.Local.fTotal)
		F.Intrinsic.Control.If(V.Local.fTotal,>,100)
			F.Intrinsic.Math.Sub(V.Local.fTotal,100,V.Local.fTotal)
			F.Intrinsic.Math.Sub(V.Local.fValue,V.Local.fTotal,V.Local.fTotal)
			F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Local.fTotal)
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Local.fValue)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Case("POURTEMP")
		'Min:-999, Max:999
		F.Intrinsic.String.Format(V.Local.fValue,"0",V.Local.fValue)
		F.Intrinsic.Control.If(V.Local.fValue,>=,1000)
			V.Local.fValue.Set(999)
		F.Intrinsic.Control.ElseIf(V.Local.fValue,<=,-1000)
			V.Local.fValue.Set(-999)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Local.fValue.Long)
	F.Intrinsic.Control.Case("POURWEIGHT")
		'Min:0, Max:999
		F.Intrinsic.Control.If(V.Local.fValue,<,0)
			V.Local.fValue.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Format(V.Local.fValue,"0",V.Local.fValue)
		F.Intrinsic.Control.If(V.Local.fValue,>=,1000)
			V.Local.fValue.Set(999)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Local.fValue.Long)
	F.Intrinsic.Control.CaseElse
		'These are string fields, so just write them to the DataTable for the check below
		'I know it sounds weird since the grid control is writing to the DataTable itself, but from my experience, the actual write doesn't happen until the CellValueChanged event ends and it doesn't update the RowState depending on the GS/OCTSRS Version - Bix
		F.Data.DataTable.SetValue("dtRecipeChg",V.Args.RowIndex,V.Args.Column,V.Args.Value)
F.Intrinsic.Control.EndSelect

'Compare value to 'Current' value
F.Intrinsic.Control.If(V.DataTable.dtRecipeChg(V.Args.RowIndex).[V.Args.Column]!FieldVal,<>,V.DataTable.dtRecipe(0).[V.Args.Column]!FieldVal)
	'Not equal
	F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.Args.Column,"Prop","CellForeColor","Val","Red")
F.Intrinsic.Control.Else
	'Equal
	F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col",V.Args.Column,"Prop","CellForeColor","Val","Blue")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcNew_CellValueChanged.End

Program.Sub.cmdLogIn_Click.Start
V.Local.sCaption.Declare
V.Local.bCheck.Declare
F.Intrinsic.Control.Try

'Verify security passed
F.Intrinsic.Control.If(V.Screen.F_Security!txtUser.Text.Trim,=,"")
	Gui.F_Security.txtUser.Text("")
	Gui.F_Security.txtUser.SetFocus
	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.ElseIf
'	Gui.F_Security.txtPW.Text("")
'	Gui.F_Security.txtPW.SetFocus
'	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Global.Security.ValidateUser(V.Caller.CompanyCode,V.Screen.F_Security!txtUser.Text.Trim,V.Screen.F_Security!txtPW.Text,V.Local.bCheck)
F.Intrinsic.Control.If(V.Local.bCheck.Not)
	'Invalid Username or password
	F.Intrinsic.UI.Msgbox("Invalid username or password.","LOG IN FAILED")
	Gui.F_Security.txtPW.SetFocus
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Recipe Change Request - User: {0}",V.Screen.F_Security!txtUser.Text.Trim,V.Local.sCaption)
Gui.F_Recipe_Chg..Caption(V.Local.sCaption)

F.Intrinsic.Control.If(V.Screen.F_Recipe_Sel!optMPU9.Value)
	Gui.F_Recipe_Chg.chkReason1.Caption("Deep center funnel")
	Gui.F_Recipe_Chg.chkReason1.Value(False)
	Gui.F_Recipe_Chg.chkReason2.Caption("Deep left funnel")
	Gui.F_Recipe_Chg.chkReason2.Value(False)
	Gui.F_Recipe_Chg.chkReason3.Caption("Deep right funnel")
	Gui.F_Recipe_Chg.chkReason3.Value(False)
	Gui.F_Recipe_Chg.chkReason4.Caption("Deep funnels on sides of plate")
	Gui.F_Recipe_Chg.chkReason4.Value(False)
	Gui.F_Recipe_Chg.chkReason5.Caption("Deformed sides of plate")
	Gui.F_Recipe_Chg.chkReason5.Value(False)
	Gui.F_Recipe_Chg.chkReason6.Caption("Wet or soft funnel")
	Gui.F_Recipe_Chg.chkReason6.Value(False)
	Gui.F_Recipe_Chg.chkReason7.Caption("Residual run down from funnel")
	Gui.F_Recipe_Chg.chkReason7.Value(False)
	Gui.F_Recipe_Chg.chkReason8.Caption("Fissures/cracks in funnel")
	Gui.F_Recipe_Chg.chkReason8.Value(False)
	Gui.F_Recipe_Chg.chkReason9.Caption("Soft, bending plate")
	Gui.F_Recipe_Chg.chkReason9.Value(False)
	Gui.F_Recipe_Chg.chkReason10.Caption("Suction cup marks")
	Gui.F_Recipe_Chg.chkReason10.Value(False)
	Gui.F_Recipe_Chg.chkReason11.Caption("Plates sticking to platens")
	Gui.F_Recipe_Chg.chkReason11.Value(False)
	Gui.F_Recipe_Chg.chkReason12.Caption("Deformed spots on surface of plate")
	Gui.F_Recipe_Chg.chkReason13.Value(False)
	Gui.F_Recipe_Chg.chkReason13.Caption("Cold spots")
	Gui.F_Recipe_Chg.chkReason14.Value(False)
	Gui.F_Recipe_Chg.chkReason14.Caption("Catalyst under-delivery")
	Gui.F_Recipe_Chg.chkReason15.Value(False)
	Gui.F_Recipe_Chg.chkReason15.Caption("Activator under-delivery")
	Gui.F_Recipe_Chg.chkReason16.Value(False)
	Gui.F_Recipe_Chg.chkReason16.Caption("Short plate/low pour weight")
	Gui.F_Recipe_Chg.chkReason17.Value(False)
	Gui.F_Recipe_Chg.chkReason17.Caption("Pour burp")
	Gui.F_Recipe_Chg.chkReason18.Value(False)
	Gui.F_Recipe_Chg.chkReason18.Caption("Pour overflow")
	Gui.F_Recipe_Chg.chkReason1.Value(False)
	F.Intrinsic.String.Build("Plate too tall for planer (>55{0})",V.Ambient.DblQuote,V.Local.sCaption)
	Gui.F_Recipe_Chg.chkReason19.Caption(V.Local.sCaption)
	Gui.F_Recipe_Chg.chkReason19.Value(False)
	Gui.F_Recipe_Chg.chkReason20.Visible(False)
	Gui.F_Recipe_Chg.chkReason21.Caption("Pinholes")
	Gui.F_Recipe_Chg.chkReason21.Value(False)
	Gui.F_Recipe_Chg.chkReason22.Caption("Dry funnel")
	Gui.F_Recipe_Chg.chkReason22.Value(False)
	Gui.F_Recipe_Chg.chkReason23.Caption("Catalyst over-delivery")
	Gui.F_Recipe_Chg.chkReason23.Value(False)
	Gui.F_Recipe_Chg.chkReason24.Caption("Activator over-delivery")
	Gui.F_Recipe_Chg.chkReason24.Value(False)
	Gui.F_Recipe_Chg.chkReason25.Caption("Color variation from standard")
	Gui.F_Recipe_Chg.chkReason25.Value(False)
	Gui.F_Recipe_Chg.chkReason26.Caption("Color swirls")
	Gui.F_Recipe_Chg.chkReason26.Value(False)
	Gui.F_Recipe_Chg.chkReason27.Caption("Dye under-delivery")
	Gui.F_Recipe_Chg.chkReason27.Value(False)
	Gui.F_Recipe_Chg.chkReason28.Caption("Dye over-delivery")
	Gui.F_Recipe_Chg.chkReason28.Value(False)
	Gui.F_Recipe_Chg.chkReason29.Visible(False)
	Gui.F_Recipe_Chg.chkReason30.Visible(False)
F.Intrinsic.Control.EndIf
F.Data.DataTable.DeleteRow("dtRecipeChg")
F.Data.DataTable.AcceptChanges("dtRecipeChg")
F.Data.DataTable.Merge("dtRecipe","dtRecipeChg",True,2)
'Gui.F_Recipe_Chg..ClearGroup(1)
F.Intrinsic.Control.CallSub(SetColumnProperty,"Form",F_Recipe_Chg,"GSGC",gsgcNew,"GV","gvNew","Col","CatalystPerToAdd*!*PourTemp*!*PourWeight*!*DyePerToAdd","Prop","CellForeColor","Val","Blue")
Gui.F_Security..Visible(False)
F.Intrinsic.Control.If(V.Global.bShowChgRecipe.Not)
	Gui.F_Recipe_Chg..Show
	V.Global.bShowChgRecipe.Set(True)
F.Intrinsic.Control.Else
	Gui.F_Recipe_Chg..Visible(True)
	Gui.F_Recipe_Chg..SetFocus
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdLogIn_Click.End

Program.Sub.cmdLogInCancel_Click.Start
Gui.F_Security..Visible(False)
Gui.F_Recipe..Visible(True)
Gui.F_Recipe..SetFocus
Program.Sub.cmdLogInCancel_Click.End

Program.Sub.cmdSeasonSave_Click.Start
V.Local.iRet.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.CallSub(GetSeason)

F.Intrinsic.Control.If(V.Screen.F_Season!optSummer.Value,=,True,and,V.Args.SeasonID,<>,1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to change the Season to Summer?","SAVING SEASON",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		'Yes
		F.Intrinsic.Control.CallSub(SaveSeason,"Season","Summer","SeasonID",1)
		Gui.F_Season.cmdSeasonSave.FontStyle(False,False,False,False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Screen.F_Season!optWinter.Value,=,True,and,V.Args.SeasonID,<>,3)
	F.Intrinsic.UI.Msgbox("Are you sure you want to change the Season to Winter?","SAVING SEASON",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		'Yes
		F.Intrinsic.Control.CallSub(SaveSeason,"Season","Winter","SeasonID",3)
		Gui.F_Season.cmdSeasonSave.FontStyle(False,False,False,False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdSeasonSave_Click.End

Program.Sub.SaveSeason.Start
F.Global.Registry.AddValue(-1,V.Caller.CompanyCode,"Recipe Season",6495,1000,False,V.Args.Season,False,V.Args.SeasonID,0,V.Ambient.Date,V.Ambient.Time,"")
Program.Sub.SaveSeason.End

Program.Sub.SendEmail.Start
V.Local.sFile.Declare
V.Local.sSubject.Declare
V.Local.sBody.Declare
V.Local.sSender.Declare
V.Local.sRecipients.Declare
V.Local.iUserID.Declare
F.Intrinsic.Control.Try

'Get subject and body from template file
F.Intrinsic.String.Build("{0}\{1}",V.Ambient.ScriptPath,"GCG_6495_Email_Template.txt",V.Local.sFile)
F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sFile)
F.Intrinsic.String.Split(V.Local.sFile,"*!*",V.Local.sFile)
F.Intrinsic.Control.If(V.Local.sFile.UBound,!=,1)
	'File is not formatted correctly
	F.Intrinsic.Variable.AddRV("Status",1)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Replace(V.Local.sFile(0).Trim,V.Ambient.NewLine,"",V.Local.sSubject)
V.Local.sBody.Set(V.Local.sFile(1).Trim)
'Get sender email
F.Global.Registry.ReadValue(-1,V.Caller.CompanyCode,"Recipe Notif Email",6495,1000,6,"***NO EMAIL***",V.Local.sSender)
F.Intrinsic.Control.If(V.Local.sSender,=,"***NO EMAIL***")
	'Sender email is not entered
	F.Intrinsic.Variable.AddRV("Status",2)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
'F.Global.Security.GetUserEmail(V.Screen.F_Security!txtUser.Text,V.Local.sSender)
F.Intrinsic.String.Build("{0}*!*",V.Local.sSender,V.Local.sSender)
'Get emails from group
F.Global.Security.GetGroupEmails("RCPEADMN",V.Local.sRecipients)
F.Intrinsic.String.Replace(V.Local.sRecipients,"*!*","@!@*!*",V.Local.sRecipients)
F.Intrinsic.String.Build("*!*{0}",V.Local.sRecipients,V.Local.sRecipients)
'Get user ID
F.Global.Security.GetUserID(V.Screen.F_Security!txtUser.Text,V.Caller.CompanyCode,V.Local.iUserID)
'send email
F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,V.Local.iUserID,"Recipe Change Request",V.Local.sSubject,V.Local.sSender,V.Local.sRecipients,V.Local.sBody)
'Email was queued successfully
F.Intrinsic.Variable.AddRV("Status",0)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.SendEmail.End

Program.Sub.SendEmailApprv.Start
'V.Args.User, V.Args.RequestID
F.Intrinsic.Control.Try

'Now we Queue the email in GCG_6495_EMAILS
F.Data.DataTable.Create("dtEmailQ")
F.Data.DataTable.AddColumn("dtEmailQ","UserRecipient","String")
F.Data.DataTable.AddColumn("dtEmailQ","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtEmailQ","RequestID","Integer")
F.Data.DataTable.AddRow("dtEmailQ","UserRecipient",V.Args.User,"UpdateDate",V.Ambient.Date,"RequestID",V.Args.RequestID)
F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.SaveToDB("dtEmailQ","con","GCG_6495_EMAILS","",128)
F.ODBC.Connection!con.Close
F.Data.DataTable.Close("dtEmailQ")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.SendEmailApprv.End

Program.Sub.cmdEditEmail_Click.Start
V.Local.sEmail.Declare
V.Local.bEmail.Declare
F.Intrinsic.Control.Try

F.Global.Registry.ReadValue(-1,V.Caller.CompanyCode,"Recipe Notif Email",6495,1000,6,"",V.Local.sEmail)
F.Intrinsic.UI.Inputbox("Enter Sender Email Address for notification emails.","NOTIFICATION EMAIL",V.Local.sEmail,V.Local.sEmail)
F.Global.Messaging.IsAddressValid(V.Local.sEmail,V.Local.bEmail)
F.Intrinsic.Control.If(V.Local.bEmail)
	F.Global.Registry.AddValue(-1,V.Caller.CompanyCode,"Recipe Notif Email",6495,1000,False,"Sender Email",False,0,0,V.Ambient.Date,V.Ambient.Time,V.Local.sEmail)
F.Intrinsic.Control.ElseIf(V.Local.sEmail.IsNotCancel)
	F.Intrinsic.UI.Msgbox("ERR: Email could not be validated. Changes were not saved. Please enter a valid email address.","RETURNING TO MAINT SCREEN")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdEditEmail_Click.End

Program.Sub.F_Approval_UnLoad.Start
F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
Program.Sub.F_Approval_UnLoad.End

Program.Sub.cmdChgProcess_Click.Start
V.Local.sMsg.Declare
V.Local.sLockedFilter.Declare
V.Local.sFilter.Declare
V.Local.sRequestLog.Declare
V.Local.sHistLog.Declare
V.Local.sRet.Declare
V.Local.sSQL.Declare
V.Local.sSQLDel.Declare
V.Local.sSQLMstrDel.Declare
V.Local.sDataTable.Declare
V.Local.iRet.Declare
V.Local.iCnt.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.BlockEvents
'First, check if we are locked
F.Intrinsic.Control.If(V.Global.bLockReq)
	'Check if there are changes to locked records
	F.Data.DataView.SetFilter("dtRecipeChgReqs","dvCheck","[Locked] and [ApproveOrRejectCheck]")
	F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck.RowCount,>,0)
		'There are changes to locked records, ask user if they want to include them
		F.Intrinsic.String.Build("There are {0} locked records that have approvals or rejections select. Would you like to include them in the Processing?",V.DataView.dtRecipeChgReqs!dvCheck.RowCount,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"PROCESS",V.Enum.MsgBoxStyle!YesNo,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,V.Enum.MsgBoxResult!Yes)
			V.Local.sLockedFilter.Set("")
		F.Intrinsic.Control.Else
			V.Local.sLockedFilter.Set(" and not([Locked])")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		V.Local.sLockedFilter.Set("")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	V.Local.sLockedFilter.Set("")
F.Intrinsic.Control.EndIf

'Second, check all the records selected to see if they have all their changes processed
F.Intrinsic.String.Build("[ApproveOrRejectCheck]{0}",V.Local.sLockedFilter,V.Local.sFilter)
F.Data.DataView.SetFilter("dtRecipeChgReqs","dvCheck",V.Local.sFilter)
F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck.RowCount,=,0)
	F.Intrinsic.UI.Msgbox("No requests detected to process.","CANCELLING PROCESS")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'Third, we will need to loop through and verify each record and add them to the Save DataTables
F.Data.DataTable.Create("GCG_6495_MPU9_ALLYEAR",True)
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","Grade","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","Size","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","ActivatorType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","PourTemp","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","PourWeight","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","DyeType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","AdditionalType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_ALLYEAR","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("GCG_6495_MPU9_ALLYEAR","BalanceCaproPerToAdd","Float","100 - ActivatorPerToAdd - CatalystPerToAdd - DyePerToAdd - AdditionalPerToAdd - AdditionalAdditivesPerToAdd")
F.Data.DataTable.Create("GCG_6495_MPU9_SUMMER",True)
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","Grade","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","Size","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","ActivatorType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","PourTemp","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","PourWeight","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","DyeType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","AdditionalType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_SUMMER","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("GCG_6495_MPU9_SUMMER","BalanceCaproPerToAdd","Float","100 - ActivatorPerToAdd - CatalystPerToAdd - DyePerToAdd - AdditionalPerToAdd - AdditionalAdditivesPerToAdd")
F.Data.DataTable.Create("GCG_6495_MPU9_WINTER",True)
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","Grade","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","Size","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","ActivatorType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","PourTemp","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","PourWeight","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","DyeType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","AdditionalType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_WINTER","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("GCG_6495_MPU9_WINTER","BalanceCaproPerToAdd","Float","100 - ActivatorPerToAdd - CatalystPerToAdd - DyePerToAdd - AdditionalPerToAdd - AdditionalAdditivesPerToAdd")
F.Data.DataTable.Create("GCG_6495_MPU9_LA_SUMMER",True)
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","Grade","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","Size","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","ActivatorType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","PourTemp","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","PourWeight","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","DyeType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","AdditionalType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_SUMMER","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("GCG_6495_MPU9_LA_SUMMER","BalanceCaproPerToAdd","Float","100 - ActivatorPerToAdd - CatalystPerToAdd - DyePerToAdd - AdditionalPerToAdd - AdditionalAdditivesPerToAdd")
F.Data.DataTable.Create("GCG_6495_MPU9_LA_WINTER",True)
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","Grade","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","Size","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","ActivatorPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","ActivatorType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","CatalystPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","PourTemp","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","PourWeight","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","DyeType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","DyePerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","AdditionalType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","AdditionalPerToAdd","Float")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","AdditionalAdditivesType","String")
F.Data.DataTable.AddColumn("GCG_6495_MPU9_LA_WINTER","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.AddExpressionColumn("GCG_6495_MPU9_LA_WINTER","BalanceCaproPerToAdd","Float","100 - ActivatorPerToAdd - CatalystPerToAdd - DyePerToAdd - AdditionalPerToAdd - AdditionalAdditivesPerToAdd")
F.Data.DataTable.Create("dtSaveHead",True)
F.Data.DataTable.AddColumn("dtSaveHead","RequestBatchID","Long")
F.Data.DataTable.AddColumn("dtSaveHead","RequestID","Long")
F.Data.DataTable.AddColumn("dtSaveHead","UpdateDate","DateTime")
F.Data.DataTable.AddColumn("dtSaveHead","RecipeTable","String")
F.Data.DataTable.AddColumn("dtSaveHead","Grade","String")
F.Data.DataTable.AddColumn("dtSaveHead","Size","String")
F.Data.DataTable.AddColumn("dtSaveHead","Reason1","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason2","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason3","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason4","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason5","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason6","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason7","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason8","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason9","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason10","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason11","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason12","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason13","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason14","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason15","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason16","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason17","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason18","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason19","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason20","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason21","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason22","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason23","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason24","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason25","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason26","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason27","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason28","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason29","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Reason30","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Other","Boolean")
F.Data.DataTable.AddColumn("dtSaveHead","Comments","String")
F.Data.DataTable.AddColumn("dtSaveHead","RequestedBy","String")
F.Data.DataTable.AddColumn("dtSaveHead","RequestedTimeStamp","DateTime")
F.Data.DataTable.AddColumn("dtSaveHead","ProcessedBy","String")
F.Data.DataTable.AddColumn("dtSaveHead","ProcessedTimeStamp","DateTime")
F.Data.DataTable.Create("dtSaveDetail",True)
F.Data.DataTable.AddColumn("dtSaveDetail","RequestID","Long")
F.Data.DataTable.AddColumn("dtSaveDetail","Approved","Boolean")
F.Data.DataTable.AddColumn("dtSaveDetail","Rejected","Boolean")
F.Data.DataTable.AddColumn("dtSaveDetail","FieldName","String")
F.Data.DataTable.AddColumn("dtSaveDetail","PrevVal","String")
F.Data.DataTable.AddColumn("dtSaveDetail","ReqVal","String")

'Merge records into SaveHead
F.Data.DataView.ToDataTable("dtRecipeChgReqs","dvCheck","dtTemp",True)
F.Data.DataTable.Merge("dtTemp","dtSaveHead",True,2)
F.Data.DataTable.Close("dtTemp")

'loop through queued records
V.Local.sSQLDel.Redim(0,V.DataView.dtRecipeChgReqs!dvCheck.RowCount--)
V.Local.sSQLMstrDel.Redim(0,V.DataView.dtRecipeChgReqs!dvCheck.RowCount--)
F.ODBC.Connection!con.OpenCompanyConnection
F.Intrinsic.Control.For(V.Local.iCnt,V.DataView.dtRecipeChgReqs!dvCheck.RowCount--)
	'Check that this record isn't in the history tables
	F.Intrinsic.String.Build("select 1 from GCG_6495_HIST_HEAD where RequestID = {0};",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sSQL)
	F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
	F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF.Not)
		'Record exists, log it
		F.Intrinsic.Control.If(V.Local.sHistLog,<>,"")
			F.Intrinsic.String.Build("{0}, ",V.Local.sHistLog,V.Local.sHistLog)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("{0}{1}",V.Local.sHistLog,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sHistLog)
	F.Intrinsic.Control.Else
		V.Local.sDataTable.Set(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RecipeTable!FieldVal)
		F.Data.DataTable.AddRow(V.Local.sDataTable,"UpdateDate",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).UpdateDate!FieldVal,"Grade",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).Grade!FieldVal,"Size",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).Size!FieldVal,"ActivatorPerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ActivatorPerToAdd!FieldVal,"ActivatorType",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ActivatorType!FieldVal,"CatalystPerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).CatalystPerToAdd!FieldVal,"PourTemp",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourTemp!FieldVal,"PourWeight",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourWeight!FieldVal,"DyeType",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).DyeType!FieldVal,"DyePerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).DyePerToAdd!FieldVal,"AdditionalType",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).AdditionalType!FieldVal,"AdditionalPerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).AdditionalPerToAdd!FieldVal,"AdditionalAdditivesType",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).AdditionalAdditivesType!FieldVal,"AdditionalAdditivesPerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).AdditionalAdditivesPerToAdd!FieldVal)
		'CatalystPerToAdd
		F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldCatalystPerToAdd!FieldVal,<>,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).CatalystPerToAdd!FieldVal)
			'Change detected, get user input
			F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApproveCatalystPerToAdd!FieldVal,=,True,or,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectCatalystPerToAdd!FieldVal,=,True)
				'Something is selected, add it to the Detail
				F.Data.DataTable.AddRow("dtSaveDetail","RequestID",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldVal,"Approved",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApproveCatalystPerToAdd!FieldVal,"Rejected",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectCatalystPerToAdd!FieldVal,"FieldName","CatalystPerToAdd","PrevVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldCatalystPerToAdd!FieldValString,"ReqVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).CatalystPerToAdd!FieldValString)
				F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectCatalystPerToAdd!FieldVal)
					'Value has been rejected so we need to reset the value
					F.Data.DataTable.SetValue(V.Local.sDataTable,V.DataTable.[V.Local.sDataTable].RowCount--,"CatalystPerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldCatalystPerToAdd!FieldVal)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				'Nothing is selected, log it for display
				F.Intrinsic.Control.If(V.Local.sRequestLog,<>,"")
					F.Intrinsic.String.Build("{0}, ",V.Local.sRequestLog,V.Local.sRequestLog)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRequestLog,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sRequestLog)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		'PourTemp
		F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourTemp!FieldVal,<>,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourTemp!FieldVal)
			'Change detected, get user input
			F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApprovePourTemp!FieldVal,=,True,or,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourTemp!FieldVal,=,True)
				'Something is selected, add it to the Detail
				F.Data.DataTable.AddRow("dtSaveDetail","RequestID",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldVal,"Approved",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApprovePourTemp!FieldVal,"Rejected",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourTemp!FieldVal,"FieldName","PourTemp","PrevVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourTemp!FieldValString,"ReqVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourTemp!FieldValString)
				F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourTemp!FieldVal)
					'Value has been rejected so we need to reset the value
					F.Data.DataTable.SetValue(V.Local.sDataTable,V.DataTable.[V.Local.sDataTable].RowCount--,"PourTemp",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourTemp!FieldVal)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				'Nothing is selected, log it for display
				F.Intrinsic.Control.If(V.Local.sRequestLog,<>,"")
					F.Intrinsic.String.Build("{0}, ",V.Local.sRequestLog,V.Local.sRequestLog)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRequestLog,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sRequestLog)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		'PourWeight
		F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourWeight!FieldVal,<>,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourWeight!FieldVal)
			'Change detected, get user input
			F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApprovePourWeight!FieldVal,=,True,or,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourWeight!FieldVal,=,True)
				'Something is selected, add it to the Detail
				F.Data.DataTable.AddRow("dtSaveDetail","RequestID",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldVal,"Approved",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApprovePourWeight!FieldVal,"Rejected",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourWeight!FieldVal,"FieldName","PourWeight","PrevVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourWeight!FieldValString,"ReqVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).PourWeight!FieldValString)
				F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectPourWeight!FieldVal)
					'Value has been rejected so we need to reset the value
					F.Data.DataTable.SetValue(V.Local.sDataTable,V.DataTable.[V.Local.sDataTable].RowCount--,"PourWeight",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldPourWeight!FieldVal)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				'Nothing is selected, log it for display
				F.Intrinsic.Control.If(V.Local.sRequestLog,<>,"")
					F.Intrinsic.String.Build("{0}, ",V.Local.sRequestLog,V.Local.sRequestLog)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRequestLog,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sRequestLog)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		'DyePerToAdd
		F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldDyePerToAdd!FieldVal,<>,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).DyePerToAdd!FieldVal)
			'Change detected, get user input
			F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApproveDyePerToAdd!FieldVal,=,True,or,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectDyePerToAdd!FieldVal,=,True)
				'Something is selected, add it to the Detail
				F.Data.DataTable.AddRow("dtSaveDetail","RequestID",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldVal,"Approved",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).ApproveDyePerToAdd!FieldVal,"Rejected",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectDyePerToAdd!FieldVal,"FieldName","DyePerToAdd","PrevVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldDyePerToAdd!FieldValString,"ReqVal",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).DyePerToAdd!FieldValString)
				F.Intrinsic.Control.If(V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RejectDyePerToAdd!FieldVal)
					'Value has been rejected so we need to reset the value
					F.Data.DataTable.SetValue(V.Local.sDataTable,V.DataTable.[V.Local.sDataTable].RowCount--,"DyePerToAdd",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).OldDyePerToAdd!FieldVal)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				'Nothing is selected, log it for display
				F.Intrinsic.Control.If(V.Local.sRequestLog,<>,"")
					F.Intrinsic.String.Build("{0}, ",V.Local.sRequestLog,V.Local.sRequestLog)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRequestLog,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sRequestLog)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("delete from GCG_6495_RECIPE_CHG where RequestID = {0};",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldValString,V.Local.sSQLDel(V.Local.iCnt))
	F.Intrinsic.String.Build("delete from {0} where UpdateDate = '{1}' and Grade = '{2}' and Size = '{3}';",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RecipeTable!FieldVal,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).UpdateDate!FieldValPervasiveDate,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).Grade!FieldVal,V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).Size!FieldVal,V.Local.sSQLMstrDel(V.Local.iCnt))
	F.Intrinsic.Control.CallSub(SendEmailApprv,"User",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestedBy!FieldVal,"RequestID",V.DataView.dtRecipeChgReqs!dvCheck(V.Local.iCnt).RequestID!FieldVal)
F.Intrinsic.Control.Next(V.Local.iCnt)

F.Intrinsic.Control.If(V.Local.sRequestLog,<>,"",and,V.Local.sHistLog,<>,"")
	'bad info and records already processed
	F.Intrinsic.String.Build("The following Request ID's need to have all or none of their changes Approved/Rejected:{2}{2}{0}{2}{2}The following Request ID's have already been processed:{2}{2}{1}{2}{2}No changes committed.",V.Local.sRequestLog,V.Local.sHistLog,V.Ambient.NewLine,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"CANCELLING PROCESS")
	F.Data.DataTable.Close("GCG_6495_MPU9_ALLYEAR")
	F.Data.DataTable.Close("GCG_6495_MPU9_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_WINTER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_WINTER")
	F.Data.DataTable.Close("dtSaveHead")
	F.Data.DataTable.Close("dtSaveDetail")
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.ElseIf(V.Local.sRequestLog,<>,"")
	'User has some bad info selected, notify them and cancel the save
	F.Intrinsic.String.Build("The following Request ID's need to have all or none of their changes Approved/Rejected:{1}{1}{0}{1}{1}No changes committed.",V.Local.sRequestLog,V.Ambient.NewLine,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"CANCELLING PROCESS")
	F.Data.DataTable.Close("GCG_6495_MPU9_ALLYEAR")
	F.Data.DataTable.Close("GCG_6495_MPU9_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_WINTER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_WINTER")
	F.Data.DataTable.Close("dtSaveHead")
	F.Data.DataTable.Close("dtSaveDetail")
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.ElseIf(V.Local.sHistLog,<>,"")
	'records already processed
	F.Intrinsic.String.Build("The following Request ID's have already been processed:{1}{1}{0}{1}{1}No changes committed.",V.Local.sHistLog,V.Ambient.NewLine,V.Local.sMsg)
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"CANCELLING PROCESS")
	F.Data.DataTable.Close("GCG_6495_MPU9_ALLYEAR")
	F.Data.DataTable.Close("GCG_6495_MPU9_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_WINTER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_SUMMER")
	F.Data.DataTable.Close("GCG_6495_MPU9_LA_WINTER")
	F.Data.DataTable.Close("dtSaveHead")
	F.Data.DataTable.Close("dtSaveDetail")
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'Delete record in Req Queue and delete any existing key records in main tables
F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSQLDel.UBound)
	F.ODBC.Connection!con.Execute(V.Local.sSQLDel)
	F.ODBC.Connection!con.Execute(V.Local.sSQLMstrDel)
F.Intrinsic.Control.Next(V.Local.iCnt)
'update master tables
F.Intrinsic.Control.If(V.DataTable.GCG_6495_MPU9_ALLYEAR.RowCount,>,0)
	F.Data.DataTable.SaveToDB("GCG_6495_MPU9_ALLYEAR","con","GCG_6495_MPU9_ALLYEAR","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.GCG_6495_MPU9_SUMMER.RowCount,>,0)
	F.Data.DataTable.SaveToDB("GCG_6495_MPU9_SUMMER","con","GCG_6495_MPU9_SUMMER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.GCG_6495_MPU9_WINTER.RowCount,>,0)
	F.Data.DataTable.SaveToDB("GCG_6495_MPU9_WINTER","con","GCG_6495_MPU9_WINTER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.GCG_6495_MPU9_LA_SUMMER.RowCount,>,0)
	F.Data.DataTable.SaveToDB("GCG_6495_MPU9_LA_SUMMER","con","GCG_6495_MPU9_LA_SUMMER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.GCG_6495_MPU9_LA_WINTER.RowCount,>,0)
	F.Data.DataTable.SaveToDB("GCG_6495_MPU9_LA_WINTER","con","GCG_6495_MPU9_LA_WINTER","",128)
F.Intrinsic.Control.EndIf
F.ODBC.Connection!con.ExecuteAndReturn("select max(RequestBatchID) from GCG_6495_HIST_HEAD;",V.Local.sRet)
F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
	V.Local.iRet.Set(1)
F.Intrinsic.Control.Else
	F.Intrinsic.Math.Add(V.Local.sRet.Long,1,V.Local.iRet)
F.Intrinsic.Control.EndIf
'Now, we need to fill in RequestBatchID, ProcessedBy and ProcessedAt
F.Data.DataTable.SetValue("dtSaveHead",-1,"RequestBatchID",V.Local.iRet,"ProcessedBy",V.Caller.User,"ProcessedTimeStamp",V.Ambient.Now)
F.Data.DataTable.SaveToDB("dtSaveHead","con","GCG_6495_HIST_HEAD","",128)
F.Data.DataTable.SaveToDB("dtSaveDetail","con","GCG_6495_HIST_DETAIL","",128)
F.ODBC.Connection!con.Close

F.Data.DataTable.Close("GCG_6495_MPU9_ALLYEAR")
F.Data.DataTable.Close("GCG_6495_MPU9_SUMMER")
F.Data.DataTable.Close("GCG_6495_MPU9_WINTER")
F.Data.DataTable.Close("GCG_6495_MPU9_LA_SUMMER")
F.Data.DataTable.Close("GCG_6495_MPU9_LA_WINTER")
F.Data.DataTable.Close("dtSaveHead")
F.Data.DataTable.Close("dtSaveDetail")

'Close screen, refresh queue
Gui.F_Approval..Visible(False)

F.Data.DataTable.DeleteRow("dtRecipeChgReqs")
F.Data.DataTable.AcceptChanges("dtRecipeChgReqs")

F.Intrinsic.Control.CallSub(LoadRecipeChgList)

F.Intrinsic.Control.CallSub(LoadReasonApproveList)

Gui.F_Approval..Visible(True)
F.Intrinsic.Control.UnBlockEvents
Gui.F_Approval..SetFocus

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdChgProcess_Click.End

Program.Sub.gsgcRequests_RowCellClick.Start
V.Local.sColumn.Declare
V.Local.sNotColumn.Declare
V.Local.sValColumn.Declare
V.Local.sOldValColumn.Declare
V.Local.sFilter.Declare
V.Local.iOption.Declare
V.Local.iLength.Declare
F.Intrinsic.Control.Try

V.Local.sColumn.Set(V.Args.Column.UCase)

F.Intrinsic.Control.If(V.Local.sColumn.Left7,=,"APPROVE")
	V.Local.iOption.Set(0)
	F.Intrinsic.Math.Sub(v.Local.sColumn.Length,7,V.Local.iLength)
	F.Intrinsic.String.Right(V.Local.sColumn,V.Local.iLength,V.Local.sColumn)
	V.Local.sValColumn.Set(V.Local.sColumn)
	F.Intrinsic.String.Build("Old{0}",V.Local.sColumn,V.Local.sOldValColumn)
	F.Intrinsic.String.Build("Reject{0}",V.Local.sColumn,V.Local.sNotColumn)
	F.Intrinsic.String.Build("Approve{0}",V.Local.sColumn,V.Local.sColumn)
F.Intrinsic.Control.ElseIf(V.Local.sColumn.Left6,=,"REJECT")
	V.Local.iOption.Set(1)
	F.Intrinsic.Math.Sub(v.Local.sColumn.Length,6,V.Local.iLength)
	F.Intrinsic.String.Right(V.Local.sColumn,V.Local.iLength,V.Local.sColumn)
	V.Local.sValColumn.Set(V.Local.sColumn)
	F.Intrinsic.String.Build("Old{0}",V.Local.sColumn,V.Local.sOldValColumn)
	F.Intrinsic.String.Build("Approve{0}",V.Local.sColumn,V.Local.sNotColumn)
	F.Intrinsic.String.Build("Reject{0}",V.Local.sColumn,V.Local.sColumn)
F.Intrinsic.Control.Else
	V.Local.iOption.Set(-1)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.iOption,<>,-1,and,V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Status!FieldValTrim,=,"In Process",V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Locked!FieldVal,=,False)
	'Check old value against new value
	F.Intrinsic.Control.If(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).[V.Local.sOldValColumn]!FieldVal,<>,V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).[V.Local.sValColumn]!FieldVal)
		'Values are different so we can Approve/Reject
		F.Data.DataTable.SetValue("dtRecipeChgReqs",V.Args.RowIndex,V.Local.sColumn,V.Args.CellValue.Not,V.Local.sNotColumn,False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

'Line has been selected so we need to populate the Reasons and Comments
F.Intrinsic.Control.If(V.Global.bLockReq.Not)
	F.Intrinsic.Control.BlockEvents
	Gui.F_Approval.txtChgID.Text(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).RequestID!FieldValString)
	Gui.F_Approval.chkReason1.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason1!FieldVal)
	Gui.F_Approval.chkReason2.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason2!FieldVal)
	Gui.F_Approval.chkReason3.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason3!FieldVal)
	Gui.F_Approval.chkReason4.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason4!FieldVal)
	Gui.F_Approval.chkReason5.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason5!FieldVal)
	Gui.F_Approval.chkReason6.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason6!FieldVal)
	Gui.F_Approval.chkReason7.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason7!FieldVal)
	Gui.F_Approval.chkReason8.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason8!FieldVal)
	Gui.F_Approval.chkReason9.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason9!FieldVal)
	Gui.F_Approval.chkReason10.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason10!FieldVal)
	Gui.F_Approval.chkReason11.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason11!FieldVal)
	Gui.F_Approval.chkReason12.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason12!FieldVal)
	Gui.F_Approval.chkReason13.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason13!FieldVal)
	Gui.F_Approval.chkReason14.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason14!FieldVal)
	Gui.F_Approval.chkReason15.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason15!FieldVal)
	Gui.F_Approval.chkReason16.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason16!FieldVal)
	Gui.F_Approval.chkReason17.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason17!FieldVal)
	Gui.F_Approval.chkReason18.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason18!FieldVal)
	Gui.F_Approval.chkReason19.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason19!FieldVal)
	Gui.F_Approval.chkReason20.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason20!FieldVal)
	Gui.F_Approval.chkReason21.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason21!FieldVal)
	Gui.F_Approval.chkReason22.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason22!FieldVal)
	Gui.F_Approval.chkReason23.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason23!FieldVal)
	Gui.F_Approval.chkReason24.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason24!FieldVal)
	Gui.F_Approval.chkReason25.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason25!FieldVal)
	Gui.F_Approval.chkReason26.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason26!FieldVal)
	Gui.F_Approval.chkReason27.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason27!FieldVal)
	Gui.F_Approval.chkReason28.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason28!FieldVal)
	Gui.F_Approval.chkReason29.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason29!FieldVal)
	Gui.F_Approval.chkReason30.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Reason30!FieldVal)
	Gui.F_Approval.chkOther.Value(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Other!FieldVal)
	Gui.F_Approval.txtComments.Text(V.DataTable.dtRecipeChgReqs(V.Args.RowIndex).Comments!FieldVal)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.String.Build("[RequestID] = {0}",V.Screen.F_Approval!txtChgID.Text,V.Local.sFilter)
	F.Data.DataView.SetFilter("dtRecipeChgReqs","dvCurrReq",V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.gsgcRequests_RowCellClick.End

Program.Sub.LoadRecipeChgList.Start
F.Intrinsic.Control.Try

F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("dtChgs","con","select RequestID, UpdateDate, rtrim(RecipeTable) as RecipeTable, rtrim(Grade) as Grade, rtrim(Size) as Size, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd, Reason1, Reason2, Reason3, Reason4, Reason5, Reason6, Reason7, Reason8, Reason9, Reason10, Reason11, Reason12, Reason13, Reason14, Reason15, Reason16, Reason17, Reason18, Reason19, Reason20, Reason21, Reason22, Reason23, Reason24, Reason25, Reason26, Reason27, Reason28, Reason29, Reason30, Other, Comments, rtrim(RequestedBy) as RequestedBy, RequestedTimeStamp, rtrim(Status) as Status, rtrim(ProcessedBy) as ProcessedBy, ProcessedTimeStamp, rtrim(Job) as Job, rtrim(Suffix) as Suffix from GCG_6495_RECIPE_CHG where Status = 'In Process' order by RequestID asc;",True)
F.Data.DataTable.CreateFromSQL("dtRecipeDate","con","select max(UpdateDate) as RecentDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_ALLYEAR' as RecipeTable from GCG_6495_MPU9_ALLYEAR group by Grade, Size;",True)
F.Data.DataTable.CreateFromSQL("dtRecipes","con","select UpdateDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_ALLYEAR' as RecipeTable, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_ALLYEAR;",True)
F.Data.DataTable.CreateFromSQL("dtSummerRecipeDate","con","select max(UpdateDate) as RecentDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_SUMMER' as RecipeTable from GCG_6495_MPU9_SUMMER group by Grade, Size;",True)
F.Data.DataTable.CreateFromSQL("dtSummerRecipes","con","select UpdateDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_SUMMER' as RecipeTable, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_SUMMER;",True)
F.Data.DataTable.CreateFromSQL("dtWinterRecipeDate","con","select max(UpdateDate) as RecentDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_WINTER' as RecipeTable from GCG_6495_MPU9_WINTER group by Grade, Size;",True)
F.Data.DataTable.CreateFromSQL("dtWinterRecipes","con","select UpdateDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_WINTER' as RecipeTable, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_WINTER;",True)
F.Data.DataTable.CreateFromSQL("dtLASummerRecipeDate","con","select max(UpdateDate) as RecentDate, Grade, Size, 'GCG_6495_MPU9_LA_SUMMER' as RecipeTable from GCG_6495_MPU9_LA_SUMMER group by Grade, Size;",True)
F.Data.DataTable.CreateFromSQL("dtLASummerRecipes","con","select UpdateDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_LA_SUMMER' as RecipeTable, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_LA_SUMMER;",True)
F.Data.DataTable.CreateFromSQL("dtLAWinterRecipeDate","con","select max(UpdateDate) as RecentDate, Grade, Size, 'GCG_6495_MPU9_LA_WINTER' as RecipeTable from GCG_6495_MPU9_LA_WINTER group by Grade, Size;",True)
F.Data.DataTable.CreateFromSQL("dtLAWinterRecipes","con","select UpdateDate, rtrim(Grade) as Grade, rtrim(Size) as Size, 'GCG_6495_MPU9_LA_WINTER' as RecipeTable, ActivatorPerToAdd, rtrim(ActivatorType) as ActivatorType, CatalystPerToAdd, PourTemp, PourWeight, rtrim(DyeType) as DyeType, DyePerToAdd, rtrim(AdditionalType) as AdditionalType, AdditionalPerToAdd, rtrim(AdditionalAdditivesType) as AdditionalAdditivesType, AdditionalAdditivesPerToAdd, BalanceCaproPerToAdd from GCG_6495_MPU9_LA_WINTER;",True)
F.ODBC.Connection!con.Close

F.Data.DataTable.Merge("dtSummerRecipeDate","dtRecipeDate",True,2)
F.Data.DataTable.Merge("dtWinterRecipeDate","dtRecipeDate",True,2)
F.Data.DataTable.Merge("dtLASummerRecipeDate","dtRecipeDate",True,2)
F.Data.DataTable.Merge("dtLAWinterRecipeDate","dtRecipeDate",True,2)
F.Data.DataTable.Close("dtSummerRecipeDate")
F.Data.DataTable.Close("dtWinterRecipeDate")
F.Data.DataTable.Close("dtLASummerRecipeDate")
F.Data.DataTable.Close("dtLAWinterRecipeDate")

F.Data.DataTable.Merge("dtSummerRecipes","dtRecipes",True,2)
F.Data.DataTable.Merge("dtWinterRecipes","dtRecipes",True,2)
F.Data.DataTable.Merge("dtLASummerRecipes","dtRecipes",True,2)
F.Data.DataTable.Merge("dtLAWinterRecipes","dtRecipes",True,2)
F.Data.DataTable.Close("dtSummerRecipes")
F.Data.DataTable.Close("dtWinterRecipes")
F.Data.DataTable.Close("dtLASummerRecipes")
F.Data.DataTable.Close("dtLAWinterRecipes")

F.Data.Linq.Join("LeftJoin","DataTable","dtRecipeDate*!*DATE","DataTable","dtRecipes*!*RECIPE","DATE.RecipeTable = RECIPE.RecipeTable and DATE.RecentDate = RECIPE.UpdateDate and DATE.Grade = RECIPE.Grade and DATE.Size = RECIPE.Size","*","","","","dtRecentRecipe",True)
F.Data.DataTable.Close("dtRecipeDate")
F.Data.DataTable.Close("dtRecipes")

F.Data.Linq.Join("LeftJoin","DataTable","dtChgs*!*CHG","DataTable","dtRecentRecipe*!*RECIPE","CHG.RecipeTable = RECIPE.RecipeTable and CHG.Grade = RECIPE.Grade and CHG.Size = RECIPE.Size","CHG.RequestID*!*CHG.UpdateDate*!*RECIPE.UpdateDate as LastDate*!*CHG.RecipeTable*!*CHG.Grade*!*CHG.Size*!*RECIPE.ActivatorPerToAdd as OldActivatorPerToAdd*!*CHG.ActivatorPerToAdd*!*RECIPE.ActivatorType as OldActivatorType*!*CHG.ActivatorType*!*RECIPE.CatalystPerToAdd as OldCatalystPerToAdd*!*CHG.CatalystPerToAdd*!*RECIPE.PourTemp as OldPourTemp*!*CHG.PourTemp*!*RECIPE.PourWeight as OldPourWeight*!*CHG.PourWeight*!*RECIPE.DyeType as OldDyeType*!*CHG.DyeType*!*RECIPE.DyePerToAdd as OldDyePerToAdd*!*CHG.DyePerToAdd*!*RECIPE.AdditionalType as OldAdditionalType*!*CHG.AdditionalType*!*RECIPE.AdditionalPerToAdd as OldAdditionalPerToAdd*!*CHG.AdditionalPerToAdd*!*RECIPE.AdditionalAdditivesType as OldAdditionalAdditivesType*!*CHG.AdditionalAdditivesType*!*RECIPE.AdditionalAdditivesPerToAdd as OldAdditionalAdditivesPerToAdd*!*CHG.AdditionalAdditivesPerToAdd*!*RECIPE.BalanceCaproPerToAdd as OldBalanceCaproPerToAdd*!*CHG.BalanceCaproPerToAdd*!*CHG.Reason1*!*CHG.Reason2*!*CHG.Reason3*!*CHG.Reason4*!*CHG.Reason5*!*CHG.Reason6*!*CHG.Reason7*!*CHG.Reason8*!*CHG.Reason9*!*CHG.Reason10*!*CHG.Reason11*!*CHG.Reason12*!*CHG.Reason13*!*CHG.Reason14*!*CHG.Reason15*!*CHG.Reason16*!*CHG.Reason17*!*CHG.Reason18*!*CHG.Reason19*!*CHG.Reason20*!*CHG.Reason21*!*CHG.Reason22*!*CHG.Reason23*!*CHG.Reason24*!*CHG.Reason25*!*CHG.Reason26*!*CHG.Reason27*!*CHG.Reason28*!*CHG.Reason29*!*CHG.Reason30*!*CHG.Other*!*CHG.Comments*!*CHG.RequestedBy*!*CHG.RequestedTimeStamp*!*CHG.Status*!*CHG.ProcessedBy*!*CHG.ProcessedTimeStamp*!*CHG.Job*!*CHG.Suffix","","","","dtChgList",True)
F.Data.DataTable.Close("dtChgs")
F.Data.DataTable.Close("dtRecentRecipe")

F.Data.DataTable.Merge("dtChgList","dtRecipeChgReqs",True,2)
F.Data.DataTable.Close("dtChgList")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadRecipeChgList.End

Program.Sub.LoadRecipeColorCoding.Start
F.Intrinsic.Control.Try

Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ActivatorPerToAdd","ActivatorPerToAddChange","Expression","[OldActivatorPerToAdd] <> [ActivatorPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ApproveActivatorPerToAdd","ApproveActivatorPerToAddChange","Expression","[OldActivatorPerToAdd] <> [ActivatorPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","RejectActivatorPerToAdd","RejectActivatorPerToAddChange","Expression","[OldActivatorPerToAdd] <> [ActivatorPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ActivatorPerToAdd","ActivatorPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ApproveActivatorPerToAdd","ApproveActivatorPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","RejectActivatorPerToAdd","RejectActivatorPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","CatalystPerToAdd","CatalystPerToAddChange","Expression","[OldCatalystPerToAdd] <> [CatalystPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ApproveCatalystPerToAdd","ApproveCatalystPerToAddChange","Expression","[OldCatalystPerToAdd] <> [CatalystPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","RejectCatalystPerToAdd","RejectCatalystPerToAddChange","Expression","[OldCatalystPerToAdd] <> [CatalystPerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","CatalystPerToAdd","CatalystPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ApproveCatalystPerToAdd","ApproveCatalystPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","RejectCatalystPerToAdd","RejectCatalystPerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","PourTemp","PourTempChange","Expression","[OldPourTemp] <> [PourTemp] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ApprovePourTemp","ApprovePourTempChange","Expression","[OldPourTemp] <> [PourTemp] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","RejectPourTemp","RejectPourTempChange","Expression","[OldPourTemp] <> [PourTemp] and not([Locked])")
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","PourTemp","PourTempChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ApprovePourTemp","ApprovePourTempChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","RejectPourTemp","RejectPourTempChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","PourWeight","PourWeightChange","Expression","[OldPourWeight] <> [PourWeight] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ApprovePourWeight","ApprovePourWeightChange","Expression","[OldPourWeight] <> [PourWeight] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","RejectPourWeight","RejectPourWeightChange","Expression","[OldPourWeight] <> [PourWeight] and not([Locked])")
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","PourWeight","PourWeightChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ApprovePourWeight","ApprovePourWeightChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","RejectPourWeight","RejectPourWeightChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","DyePerToAdd","DyePerToAddChange","Expression","[OldDyePerToAdd] <> [DyePerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","ApproveDyePerToAdd","ApproveDyePerToAddChange","Expression","[OldDyePerToAdd] <> [DyePerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","RejectDyePerToAdd","RejectDyePerToAddChange","Expression","[OldDyePerToAdd] <> [DyePerToAdd] and not([Locked])")
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","DyePerToAdd","DyePerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","ApproveDyePerToAdd","ApproveDyePerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","RejectDyePerToAdd","RejectDyePerToAddChange",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
Gui.F_Approval.gsgcRequests.AddStyleFormatCondition("gvRequests","Locked","ReqLocked","Equal",True)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","Locked","ReqLocked",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGray.Highlight)
Gui.F_Approval.gsgcRequests.SetStyleFormatConditionProperty("gvRequests","Locked","ReqLocked",V.Enum.ConditionalPropertyNames!ApplyToRow,True)

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadRecipeColorCoding.End

Program.Sub.LoadReasonApproveList.Start
V.Local.sCaption.Declare
V.Local.sFilter.Declare
F.Intrinsic.Control.Try

Gui.F_Approval.chkReason1.Caption("Deep center funnel")
Gui.F_Approval.chkReason1.Value(False)
Gui.F_Approval.chkReason2.Caption("Deep left funnel")
Gui.F_Approval.chkReason2.Value(False)
Gui.F_Approval.chkReason3.Caption("Deep right funnel")
Gui.F_Approval.chkReason3.Value(False)
Gui.F_Approval.chkReason4.Caption("Deep funnels on sides of plate")
Gui.F_Approval.chkReason4.Value(False)
Gui.F_Approval.chkReason5.Caption("Deformed sides of plate")
Gui.F_Approval.chkReason5.Value(False)
Gui.F_Approval.chkReason6.Caption("Wet or soft funnel")
Gui.F_Approval.chkReason6.Value(False)
Gui.F_Approval.chkReason7.Caption("Residual run down from funnel")
Gui.F_Approval.chkReason7.Value(False)
Gui.F_Approval.chkReason8.Caption("Fissures/cracks in funnel")
Gui.F_Approval.chkReason8.Value(False)
Gui.F_Approval.chkReason9.Caption("Soft, bending plate")
Gui.F_Approval.chkReason9.Value(False)
Gui.F_Approval.chkReason10.Caption("Suction cup marks")
Gui.F_Approval.chkReason10.Value(False)
Gui.F_Approval.chkReason11.Caption("Plates sticking to platens")
Gui.F_Approval.chkReason11.Value(False)
Gui.F_Approval.chkReason12.Caption("Deformed spots on surface of plate")
Gui.F_Approval.chkReason13.Value(False)
Gui.F_Approval.chkReason13.Caption("Cold spots")
Gui.F_Approval.chkReason14.Value(False)
Gui.F_Approval.chkReason14.Caption("Catalyst under-delivery")
Gui.F_Approval.chkReason15.Value(False)
Gui.F_Approval.chkReason15.Caption("Activator under-delivery")
Gui.F_Approval.chkReason16.Value(False)
Gui.F_Approval.chkReason16.Caption("Short plate/low pour weight")
Gui.F_Approval.chkReason17.Value(False)
Gui.F_Approval.chkReason17.Caption("Pour burp")
Gui.F_Approval.chkReason18.Value(False)
Gui.F_Approval.chkReason18.Caption("Pour overflow")
Gui.F_Approval.chkReason1.Value(False)
F.Intrinsic.String.Build("Plate too tall for planer (>55{0})",V.Ambient.DblQuote,V.Local.sCaption)
Gui.F_Approval.chkReason19.Caption(V.Local.sCaption)
Gui.F_Approval.chkReason19.Value(False)
Gui.F_Approval.chkReason20.Visible(False)
Gui.F_Approval.chkReason21.Caption("Pinholes")
Gui.F_Approval.chkReason21.Value(False)
Gui.F_Approval.chkReason22.Caption("Dry funnel")
Gui.F_Approval.chkReason22.Value(False)
Gui.F_Approval.chkReason23.Caption("Catalyst over-delivery")
Gui.F_Approval.chkReason23.Value(False)
Gui.F_Approval.chkReason24.Caption("Activator over-delivery")
Gui.F_Approval.chkReason24.Value(False)
Gui.F_Approval.chkReason25.Caption("Color variation from standard")
Gui.F_Approval.chkReason25.Value(False)
Gui.F_Approval.chkReason26.Caption("Color swirls")
Gui.F_Approval.chkReason26.Value(False)
Gui.F_Approval.chkReason27.Caption("Dye under-delivery")
Gui.F_Approval.chkReason27.Value(False)
Gui.F_Approval.chkReason28.Caption("Dye over-delivery")
Gui.F_Approval.chkReason28.Value(False)
Gui.F_Approval.chkReason29.Visible(False)
Gui.F_Approval.chkReason30.Visible(False)

F.Intrinsic.Control.If(V.DataTable.dtRecipeChgReqs.RowCount,>,0)
	F.Intrinsic.Control.BlockEvents
	Gui.F_Approval.txtChgID.Text(V.DataTable.dtRecipeChgReqs(0).RequestID!FieldValString)
	Gui.F_Approval.chkReason1.Value(V.DataTable.dtRecipeChgReqs(0).Reason1!FieldVal)
	Gui.F_Approval.chkReason2.Value(V.DataTable.dtRecipeChgReqs(0).Reason2!FieldVal)
	Gui.F_Approval.chkReason3.Value(V.DataTable.dtRecipeChgReqs(0).Reason3!FieldVal)
	Gui.F_Approval.chkReason4.Value(V.DataTable.dtRecipeChgReqs(0).Reason4!FieldVal)
	Gui.F_Approval.chkReason5.Value(V.DataTable.dtRecipeChgReqs(0).Reason5!FieldVal)
	Gui.F_Approval.chkReason6.Value(V.DataTable.dtRecipeChgReqs(0).Reason6!FieldVal)
	Gui.F_Approval.chkReason7.Value(V.DataTable.dtRecipeChgReqs(0).Reason7!FieldVal)
	Gui.F_Approval.chkReason8.Value(V.DataTable.dtRecipeChgReqs(0).Reason8!FieldVal)
	Gui.F_Approval.chkReason9.Value(V.DataTable.dtRecipeChgReqs(0).Reason9!FieldVal)
	Gui.F_Approval.chkReason10.Value(V.DataTable.dtRecipeChgReqs(0).Reason10!FieldVal)
	Gui.F_Approval.chkReason11.Value(V.DataTable.dtRecipeChgReqs(0).Reason11!FieldVal)
	Gui.F_Approval.chkReason12.Value(V.DataTable.dtRecipeChgReqs(0).Reason12!FieldVal)
	Gui.F_Approval.chkReason13.Value(V.DataTable.dtRecipeChgReqs(0).Reason13!FieldVal)
	Gui.F_Approval.chkReason14.Value(V.DataTable.dtRecipeChgReqs(0).Reason14!FieldVal)
	Gui.F_Approval.chkReason15.Value(V.DataTable.dtRecipeChgReqs(0).Reason15!FieldVal)
	Gui.F_Approval.chkReason16.Value(V.DataTable.dtRecipeChgReqs(0).Reason16!FieldVal)
	Gui.F_Approval.chkReason17.Value(V.DataTable.dtRecipeChgReqs(0).Reason17!FieldVal)
	Gui.F_Approval.chkReason18.Value(V.DataTable.dtRecipeChgReqs(0).Reason18!FieldVal)
	Gui.F_Approval.chkReason19.Value(V.DataTable.dtRecipeChgReqs(0).Reason19!FieldVal)
	Gui.F_Approval.chkReason20.Value(V.DataTable.dtRecipeChgReqs(0).Reason20!FieldVal)
	Gui.F_Approval.chkReason21.Value(V.DataTable.dtRecipeChgReqs(0).Reason21!FieldVal)
	Gui.F_Approval.chkReason22.Value(V.DataTable.dtRecipeChgReqs(0).Reason22!FieldVal)
	Gui.F_Approval.chkReason23.Value(V.DataTable.dtRecipeChgReqs(0).Reason23!FieldVal)
	Gui.F_Approval.chkReason24.Value(V.DataTable.dtRecipeChgReqs(0).Reason24!FieldVal)
	Gui.F_Approval.chkReason25.Value(V.DataTable.dtRecipeChgReqs(0).Reason25!FieldVal)
	Gui.F_Approval.chkReason26.Value(V.DataTable.dtRecipeChgReqs(0).Reason26!FieldVal)
	Gui.F_Approval.chkReason27.Value(V.DataTable.dtRecipeChgReqs(0).Reason27!FieldVal)
	Gui.F_Approval.chkReason28.Value(V.DataTable.dtRecipeChgReqs(0).Reason28!FieldVal)
	Gui.F_Approval.chkReason29.Value(V.DataTable.dtRecipeChgReqs(0).Reason29!FieldVal)
	Gui.F_Approval.chkReason30.Value(V.DataTable.dtRecipeChgReqs(0).Reason30!FieldVal)
	Gui.F_Approval.chkOther.Value(V.DataTable.dtRecipeChgReqs(0).Other!FieldVal)
	Gui.F_Approval.txtComments.Text(V.DataTable.dtRecipeChgReqs(0).Comments!FieldVal)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.String.Build("[RequestID] = {0}",V.Screen.F_Approval!txtChgID.Text,V.Local.sFilter)
	F.Data.DataView.SetFilter("dtRecipeChgReqs","dvCurrReq",V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.LoadReasonApproveList.End

Program.Sub.chkApprovalReason_Click.Start
V.Local.bNot.Declare
F.Intrinsic.Control.Try

V.Local.bNot.Set(V.Screen.F_Approval![V.Args.ControlName].CheckedAsBoolean)
F.Intrinsic.Control.BlockEvents
Gui.F_Approval.[V.Args.ControlName].Value(V.Local.bNot.Not)
F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.chkApprovalReason_Click.End

Program.Sub.cmdLockReq_Click.Start
V.Local.sFilter.Declare
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.DataTable.dtRecipeChgReqs.RowCount,>,0)
	F.Intrinsic.Control.If(V.Global.bLockReq.Not)
		'Request not locked
		F.Intrinsic.String.Build("[RequestID] <> {0}",V.Screen.F_Approval!txtChgID.Text,V.Local.sFilter)
		F.Data.DataView.SetFilter("dtRecipeChgReqs","dvLocked",V.Local.sFilter)
		F.Data.DataView.SetValue("dtRecipeChgReqs","dvLocked",-1,"Locked",True)
		Gui.F_Approval.cmdLockReq.SvgPicture(V.Enum.Image!KEY_COLOR)
		V.Global.bLockReq.Set(True)
	F.Intrinsic.Control.Else
		'Request locked
		F.Data.DataView.SetValue("dtRecipeChgReqs","dvLocked",-1,"Locked",False)
		F.Data.DataView.SetFilter("dtRecipeChgReqs","dvLocked","")
		Gui.F_Approval.cmdLockReq.SvgPicture(V.Enum.Image!KEY_BLACK)
		V.Global.bLockReq.Set(False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.cmdLockReq_Click.End

Program.Sub.txtComments_LostFocus.Start
F.Intrinsic.Control.Try

F.Intrinsic.Control.If(V.DataTable.dtRecipeChgReqs.RowCount,>,0)
	F.Data.DataView.SetValue("dtRecipeChgReqs","dvCurrReq",-1,"Comments",V.Screen.F_Approval!txtComments.Text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.txtComments_LostFocus.End

Program.Sub.UploadRecipes.Start
V.Local.sNotUploadedFile.Declare
V.Local.iFileName.Declare
F.Intrinsic.Control.Try

F.Data.DataTable.CreateFromCSV("dtRecipeUpload",V.Args.File,"String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String*!*String",False)

'UpdateDate
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","UpdateDateFORMAT","DateTime","convert([UpdateDate], System.DateTime)")
F.Data.DataTable.AddColumn("dtRecipeUpload","UpdateDateFORMAT2","DateTime")
F.Data.DataTable.CopyColumn("dtRecipeUpload","UpdateDateFORMAT","UpdateDateFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","UpdateDateFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","UpdateDate")
F.Data.DataTable.AddColumn("dtRecipeUpload","UpdateDate","DateTime")
F.Data.DataTable.CopyColumn("dtRecipeUpload","UpdateDateFORMAT2","UpdateDate")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","UpdateDateFORMAT2")

'ActivatorPerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","ActivatorPerToAddFORMAT","Float","[ActivatorPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","ActivatorPerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","ActivatorPerToAddFORMAT","ActivatorPerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","ActivatorPerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","ActivatorPerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","ActivatorPerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","ActivatorPerToAddFORMAT2","ActivatorPerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","ActivatorPerToAddFORMAT2")

'CatalystPerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","CatalystPerToAddFORMAT","Float","[CatalystPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","CatalystPerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","CatalystPerToAddFORMAT","CatalystPerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","CatalystPerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","CatalystPerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","CatalystPerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","CatalystPerToAddFORMAT2","CatalystPerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","CatalystPerToAddFORMAT2")

'PourTemp
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","PourTempFORMAT","Integer","[PourTemp]")
F.Data.DataTable.AddColumn("dtRecipeUpload","PourTempFORMAT2","Integer")
F.Data.DataTable.CopyColumn("dtRecipeUpload","PourTempFORMAT","PourTempFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourTempFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourTemp")
F.Data.DataTable.AddColumn("dtRecipeUpload","PourTemp","Integer")
F.Data.DataTable.CopyColumn("dtRecipeUpload","PourTempFORMAT2","PourTemp")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourTempFORMAT2")

'PourWeight
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","PourWeightFORMAT","Integer","[PourWeight]")
F.Data.DataTable.AddColumn("dtRecipeUpload","PourWeightFORMAT2","Integer")
F.Data.DataTable.CopyColumn("dtRecipeUpload","PourWeightFORMAT","PourWeightFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourWeightFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourWeight")
F.Data.DataTable.AddColumn("dtRecipeUpload","PourWeight","Integer")
F.Data.DataTable.CopyColumn("dtRecipeUpload","PourWeightFORMAT2","PourWeight")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","PourWeightFORMAT2")

'DyePerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","DyePerToAddFORMAT","Float","[DyePerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","DyePerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","DyePerToAddFORMAT","DyePerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","DyePerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","DyePerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","DyePerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","DyePerToAddFORMAT2","DyePerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","DyePerToAddFORMAT2")

'AdditionalPerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","AdditionalPerToAddFORMAT","Float","[AdditionalPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","AdditionalPerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","AdditionalPerToAddFORMAT","AdditionalPerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalPerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalPerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","AdditionalPerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","AdditionalPerToAddFORMAT2","AdditionalPerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalPerToAddFORMAT2")

'AdditionalAdditivesPerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT","Float","[AdditionalAdditivesPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT","AdditionalAdditivesPerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalAdditivesPerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","AdditionalAdditivesPerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT2","AdditionalAdditivesPerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","AdditionalAdditivesPerToAddFORMAT2")

'BalanceCaproPerToAdd
F.Data.DataTable.AddExpressionColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT","Float","[BalanceCaproPerToAdd]")
F.Data.DataTable.AddColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT2","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT","BalanceCaproPerToAddFORMAT2")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","BalanceCaproPerToAdd")
F.Data.DataTable.AddColumn("dtRecipeUpload","BalanceCaproPerToAdd","Float")
F.Data.DataTable.CopyColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT2","BalanceCaproPerToAdd")
F.Data.DataTable.RemoveColumn("dtRecipeUpload","BalanceCaproPerToAddFORMAT2")

F.Data.DataView.Create("dtRecipeUpload","dvSave",22,"[Table] = 'All Year'","")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtAllYear")
F.Data.DataTable.RemoveColumn("dtAllYear","Table")
F.Data.DataView.SetFilter("dtRecipeUpload","dvSave","[Table] = 'Summer'")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtSummer")
F.Data.DataTable.RemoveColumn("dtSummer","Table")
F.Data.DataView.SetFilter("dtRecipeUpload","dvSave","[Table] = 'Winter'")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtWinter")
F.Data.DataTable.RemoveColumn("dtWinter","Table")
F.Data.DataView.SetFilter("dtRecipeUpload","dvSave","[Table] = 'Liquid Activator Summer'")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtLASummer")
F.Data.DataTable.RemoveColumn("dtLASummer","Table")
F.Data.DataView.SetFilter("dtRecipeUpload","dvSave","[Table] = 'Liquid Activator Winter'")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtLAWinter")
F.Data.DataTable.RemoveColumn("dtLAWinter","Table")
F.Data.DataView.SetFilter("dtRecipeUpload","dvSave","[Table] <> 'Liquid Activator Winter' and [Table] <> 'Liquid Activator Summer' and [Table] <> 'Winter' and [Table] <> 'Summer' and [Table] <> 'All Year'")
F.Data.DataView.ToDataTable("dtRecipeUpload","dvSave","dtNotUploaded")
F.Data.DataTable.Close("dtRecipeUpload")

F.ODBC.Connection!con.OpenCompanyConnection
F.Intrinsic.Control.If(V.DataTable.dtAllYear.RowCount,>,0)
	F.Data.DataTable.SaveToDB("dtAllYear","con","GCG_6495_MPU9_ALLYEAR","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtSummer.RowCount,>,0)
	F.Data.DataTable.SaveToDB("dtSummer","con","GCG_6495_MPU9_SUMMER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtWinter.RowCount,>,0)
	F.Data.DataTable.SaveToDB("dtWinter","con","GCG_6495_MPU9_WINTER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtLASummer.RowCount,>,0)
	F.Data.DataTable.SaveToDB("dtLASummer","con","GCG_6495_MPU9_LA_SUMMER","",128)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(V.DataTable.dtLAWinter.RowCount,>,0)
	F.Data.DataTable.SaveToDB("dtLAWinter","con","GCG_6495_MPU9_LA_WINTER","",128)
F.Intrinsic.Control.EndIf
F.ODBC.Connection!con.Close
F.Data.DataTable.Close("dtAllYear")
F.Data.DataTable.Close("dtSummer")
F.Data.DataTable.Close("dtWinter")
F.Data.DataTable.Close("dtLASummer")
F.Data.DataTable.Close("dtLAWinter")

F.Intrinsic.Control.If(V.DataTable.dtNotUploaded.RowCount,>,0)
	F.Intrinsic.String.Split(V.Args.File,".",V.Local.sNotUploadedFile)
	F.Intrinsic.Math.Sub(V.Local.sNotUploadedFile.UBound,1,V.Local.iFileName)
	F.Intrinsic.String.Build("{0}_Not_Uploaded",V.Local.sNotUploadedFile(V.Local.iFileName),V.Local.sNotUploadedFile(V.Local.iFileName))
	F.Intrinsic.String.Join(V.Local.sNotUploadedFile,".",V.Local.sNotUploadedFile)
	V.Local.sNotUploadedFile.RedimPreserve(0,0)
	F.Data.DataTable.SaveToCSV("dtNotUploaded",V.Local.sNotUploadedFile,True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.If(V.Ambient.ErrorNumber,=,21049)
			F.Intrinsic.UI.Msgbox("Upload file should have 16 columns (A to P in Excel). Please close this box, correct the file to the correct column count, and run this program again.")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.UploadRecipes.End

Program.Sub.SendEmailQueue.Start
'This sub pulls in email queue and collates emails to send over courier
V.Local.sSQL.Declare
V.Local.sRequests.Declare
V.Local.sFilter.Declare
V.Local.sBodyTable.Declare
V.Local.sBody.Declare
V.Local.sSubject.Declare
V.Local.sSender.Declare
V.Local.sRecipient.Declare
V.Local.iUser.Declare
V.Local.iUserID.Declare
V.Local.bAdmin.Declare
F.Intrinsic.Control.Try

'Load in email queue
F.Intrinsic.String.Build("select UserRecipient, UpdateDate, RequestID from GCG_6495_EMAILS where UpdateDate <= '{0}';",V.Ambient.Date.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("dtEmailQ","con",V.Local.sSQL)
F.Data.DataTable.ColumnToString("dtEmailQ","RequestID",V.Local.sRequests)
F.Intrinsic.String.Replace(V.Local.sRequests,"*!*",",",V.Local.sRequests)
F.Intrinsic.String.Build("select RequestBatchID, RequestID, UpdateDate, rtrim(RecipeTable) as RecipeTable, rtrim(Grade) as Grade, rtrim(Size) as Size, Comments, rtrim(RequestedBy) as RequestedBy, RequestedTimeStamp, rtrim(ProcessedBy) as ProcessedBy, ProcessedTimeStamp from GCG_6495_HIST_HEAD where RequestID in ({0});",V.Local.sRequests,V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtReqHeadHist","con",V.Local.sSQL)
F.Intrinsic.String.Build("select RequestID, Approved, Rejected, rtrim(FieldName) as FieldName, rtrim(PrevVal) as PrevVal, rtrim(ReqVal) as ReqVal from GCG_6495_HIST_DETAIL where RequestID in ({0});",V.Local.sRequests,V.Local.sSQL)
F.Data.DataTable.CreateFromSQL("dtReqDetailHist","con",V.Local.sSQL)
F.ODBC.Connection!con.Close

'Sender
F.Global.Registry.ReadValue(-1,V.Caller.CompanyCode,"Recipe Notif Email",6495,1000,6,"***NO EMAIL***",V.Local.sSender)
F.Intrinsic.Control.If(V.Local.sSender,=,"***NO EMAIL***")
	'Sender email is not entered
	F.Data.DataTable.Close("dtEmailQ")
	F.Data.DataTable.Close("dtReqHeadHist")
	F.Data.DataTable.Close("dtReqDetailHist")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("{0}*!*",V.Local.sSender,V.Local.sSender)
'Subject
F.Intrinsic.String.Build("Recipe Change Approval Summary - {0}",V.Ambient.Date,V.Local.sSubject)

F.Intrinsic.String.Build("delete from GCG_6495_EMAILS where UpdateDate <= '{0}';",V.Ambient.Date.PervasiveDate,V.Local.sSQL)
F.ODBC.Connection!conDELETE.OpenCompanyConnection
F.ODBC.Connection!conDELETE.Execute(V.Local.sSQL)
F.ODBC.Connection!conDELETE.Close

F.Intrinsic.Control.If(V.DataTable.dtEmailQ.RowCount,>,0)
	'There are emails to collate and queue
	F.Data.DataView.Create("dtEmailQ","dvUser")
	F.Data.DataView.Create("dtReqHeadHist","dvReq")
	F.Data.DataView.Create("dtReqDetailHist","dvReq")
	F.Data.DataTable.AddExpressionColumn("dtReqDetailHist","Status","String","iif([Approved], 'Approved', 'Rejected')")
	F.Data.DataView.ToDataTableDistinct("dtEmailQ","dvUser","dtUsers","UserRecipient")
	F.Intrinsic.Control.For(V.Local.iUser,0,V.DataTable.dtUsers.RowCount--,1)
		'Collate records for each user
		F.Global.Security.IsInGroup(V.DataTable.dtUsers(V.Local.iUser).UserRecipient!FieldVal,"RCPEADMN",V.Local.bAdmin)
		F.Intrinsic.String.Build("[UserRecipient] = '{0}'",V.DataTable.dtUsers(V.Local.iUser).UserRecipient!FieldVal,V.Local.sFilter)
		F.Data.DataView.SetFilter("dtEmailQ","dvUser",V.Local.sFilter)
		F.Data.DataView.ToString("dtEmailQ","dvUser","RequestID","",",",V.Local.sRequests)
		F.Intrinsic.String.Build("[RequestID] in ({0})",V.Local.sRequests,V.Local.sFilter)
		F.Data.DataView.SetFilter("dtReqHeadHist","dvReq",V.Local.sFilter)
		F.Intrinsic.String.Build("[RequestID] in ({0})",V.Local.sRequests,V.Local.sFilter)
		F.Data.DataView.SetFilter("dtReqDetailHist","dvReq",V.Local.sFilter)
		F.Intrinsic.Control.If(V.Local.bAdmin.Not)
			'User ID
			F.Global.Security.GetUserID(V.DataTable.dtUsers(V.Local.iUser).UserRecipient!FieldVal,V.Caller.CompanyCode,V.Local.iUserID)
			'Now the fun part, build the body
			F.Data.Linq.Join(V.Enum.LinqJoinType!InnerJoin,V.Enum.LinqSourceType!DataView,"dtReqHeadHist","dvReq*!*HEAD",V.Enum.LinqSourceType!DataView,"dtReqDetailHist","dvReq*!*DETAIL","HEAD.RequestID = DETAIL.RequestID","HEAD.Grade*!*HEAD.Size*!*HEAD.RequestBatchID*!*HEAD.RequestID*!*HEAD.UpdateDate*!*HEAD.Comments*!*HEAD.RequestedBy*!*HEAD.RequestedTimeStamp*!*HEAD.ProcessedBy*!*HEAD.ProcessedTimeStamp*!*DETAIL.Status*!*DETAIL.FieldName*!*DETAIL.PrevVal*!*DETAIL.ReqVal","","","HEAD.RequestBatchID*!*HEAD.RequestID*!*DETAIL.FieldName","dtEmailData",False)
			F.Data.DataView.Create("dtEmailData","dvToString")
			F.Data.DataView.ToString("dtEmailData","dvToString","Grade*!*Size*!*RequestBatchID*!*RequestID*!*UpdateDate*!*Comments*!*ProcessedBy*!*ProcessedTimeStamp*!*Status*!*FieldName*!*PrevVal*!*ReqVal",",",V.Ambient.NewLine,V.Local.sBodyTable)
			F.Intrinsic.String.Build("See list of approved and rejected Recipe Changes below:{0}{0}Grade,Size,Batch,Request ID,Date,Comments,Processed By,Time Stamp,Status,Field,Old Value,New Value{0}{1}",V.Ambient.NewLine,V.Local.sBodyTable,V.Local.sBody)
			F.Data.DataTable.Close("dtEmailData")
			'Recipient
			F.Global.Security.GetUserEmail(V.DataTable.dtUsers(V.Local.iUser).UserRecipient!FieldVal,V.Caller.CompanyCode,V.Local.sRecipient)
			F.Intrinsic.String.Build("*!*{0}",V.Local.sRecipient,V.Local.sRecipient)
			'Send the email
			F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,V.Local.iUserID,"Recipe Change Approval",V.Local.sSubject,V.Local.sSender,V.Local.sRecipients,V.Local.sBody)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iUser)
	F.Data.DataTable.Close("dtUsers")
	'Now do admins
	F.Data.Linq.Join(V.Enum.LinqJoinType!InnerJoin,V.Enum.LinqSourceType!DataTable,"dtReqHeadHist*!*HEAD",V.Enum.LinqSourceType!DataTable,"dtReqDetailHist*!*DETAIL","HEAD.RequestID = DETAIL.RequestID","HEAD.Grade*!*HEAD.Size*!*HEAD.RequestBatchID*!*HEAD.RequestID*!*HEAD.UpdateDate*!*HEAD.Comments*!*HEAD.RequestedBy*!*HEAD.RequestedTimeStamp*!*HEAD.ProcessedBy*!*HEAD.ProcessedTimeStamp*!*DETAIL.Status*!*DETAIL.FieldName*!*DETAIL.PrevVal*!*DETAIL.ReqVal","","","HEAD.RequestBatchID*!*HEAD.RequestID*!*DETAIL.FieldName","dtEmailData",False)
	F.Data.DataView.Create("dtEmailData","dvToString")
	F.Data.DataView.ToString("dtEmailData","dvToString","Grade*!*Size*!*RequestBatchID*!*RequestID*!*UpdateDate*!*Comments*!*RequestedBy*!*RequestedTimeStamp*!*ProcessedBy*!*ProcessedTimeStamp*!*Status*!*FieldName*!*PrevVal*!*ReqVal",",",V.Ambient.NewLine,V.Local.sBodyTable)
	F.Intrinsic.String.Build("See list of approved and rejected Recipe Changes below:{0}{0}Grade,Size,Batch,Request ID,Date,Comments,Req. By,Req. Time Stamp,Processed By,Time Stamp,Status,Field,Old Value,New Value{0}{1}",V.Ambient.NewLine,V.Local.sBodyTable,V.Local.sBody)
	F.Data.DataTable.Close("dtEmailData")
	'Recipient
	F.Global.Security.GetGroupEmails("RCPEADMN",V.Local.sRecipients)
	F.Intrinsic.String.Replace(V.Local.sRecipients,"*!*","@!@*!*",V.Local.sRecipients)
	F.Intrinsic.String.Build("*!*{0}",V.Local.sRecipients,V.Local.sRecipients)
	'Send the email
	F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,V.Local.iUserID,"Recipe Change Approval",V.Local.sSubject,V.Local.sSender,V.Local.sRecipients,V.Local.sBody)
F.Intrinsic.Control.EndIf

F.Data.DataTable.Close("dtEmailQ")
F.Data.DataTable.Close("dtReqHeadHist")
F.Data.DataTable.Close("dtReqDetailHist")

F.Intrinsic.Control.Catch
	F.Intrinsic.Control.If(V.Ambient.IsInTaskScheduler.Not)
		F.Intrinsic.Control.CallSub(ErrorMessage,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(ErrorLog,"ScriptFile",V.Caller.ScriptFile,"CurrentSubroutine",V.Ambient.CurrentSubroutine,"FolderName","6495")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(F_Recipe_Sel_Unload)
F.Intrinsic.Control.EndTry
Program.Sub.SendEmailQueue.End

Program.Sub.Comments.Start
${$5$}$3.0.0.0$}$1
${$6$}$bbaker$}$20220222143511138$}$pM7xsHplA2E9VCTenDTJ47gi1rF/t66Wz7Rb8633aF0VLKjDs93XtDCClFkoMWQ6SzbjGkPnywM=
Program.Sub.Comments.End